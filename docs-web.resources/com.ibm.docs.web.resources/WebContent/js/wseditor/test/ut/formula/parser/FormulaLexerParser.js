dojo.provide("parser.FormulaLexerParser");var JsFormulaParserLexer=function(e,t){t||(t=new org.antlr.runtime.RecognizerSharedState),function(){this.emitErrorMessage=function(e){throw console&&console.warn(e),"#ERROR!"}}.call(this),this.dfa23=new JsFormulaParserLexer.DFA23(this),this.dfa31=new JsFormulaParserLexer.DFA31(this),JsFormulaParserLexer.superclass.constructor.call(this,e,t)};org.antlr.lang.augmentObject(JsFormulaParserLexer,{ODF_TABLE:53,NAME1:39,LT:46,NAME:36,SPACE1:44,DIGIT:42,ARRAY_FORMULAR_END:31,NOTEQUAL2:24,EQUAL:18,DOUBLEQUOT_STRING:38,NUMSEP:45,LESS:19,PLUS:8,LESSEQUAL:20,MULTEEQUAL:13,MODE:28,P_CLOSE:17,KEYCHARACTER:48,MULT:12,ARG_SEP:33,AND:7,CONCATENATION:5,POW:27,PLUSEQUAL:9,COLON:4,SINGLEQUOT_STRING:34,NOTEQUAL:23,DIVEQUAL:15,ODF_COLUMN:49,MINUSEQUAL:11,FUNC:40,LOCALE_NUMBER:35,INT:43,ODF_COL_RANGE:50,MINUS:10,T__56:56,AMPERSAND:25,ARRAY_FORMULAR_START:30,P_OPEN:16,GREATER:21,EOF:-1,INTERSECT_ODS:6,ODF_PREWORD:51,OR:26,SPACE:55,COMMAOrSPACE:47,DIV:14,MODEQUAL:29,NONZERO_NUMBER:41,ERRORNAME:37,ODF_PRELIST:52,GREATEREQUAL:22,WHITESPACE:54,INTERSECT:32}),function(){var e=org.antlr.runtime.Token.HIDDEN_CHANNEL,t=org.antlr.runtime.Token.EOF;org.antlr.lang.extend(JsFormulaParserLexer,org.antlr.runtime.Lexer,{ODF_TABLE:53,NAME1:39,LT:46,NAME:36,SPACE1:44,DIGIT:42,ARRAY_FORMULAR_END:31,NOTEQUAL2:24,EQUAL:18,DOUBLEQUOT_STRING:38,NUMSEP:45,LESS:19,PLUS:8,LESSEQUAL:20,MULTEEQUAL:13,MODE:28,P_CLOSE:17,KEYCHARACTER:48,MULT:12,ARG_SEP:33,AND:7,CONCATENATION:5,POW:27,PLUSEQUAL:9,COLON:4,SINGLEQUOT_STRING:34,NOTEQUAL:23,DIVEQUAL:15,ODF_COLUMN:49,MINUSEQUAL:11,FUNC:40,LOCALE_NUMBER:35,INT:43,ODF_COL_RANGE:50,MINUS:10,T__56:56,AMPERSAND:25,ARRAY_FORMULAR_START:30,P_OPEN:16,GREATER:21,EOF:-1,INTERSECT_ODS:6,ODF_PREWORD:51,OR:26,SPACE:55,COMMAOrSPACE:47,DIV:14,MODEQUAL:29,NONZERO_NUMBER:41,ERRORNAME:37,ODF_PRELIST:52,GREATEREQUAL:22,WHITESPACE:54,INTERSECT:32,getGrammarFileName:function(){return"C:\\IBMDoc\\DocsSoruceCode\\com.ibm.docs.web.resources\\WebContent\\js\\parser\\JsFormulaParser.g"}}),org.antlr.lang.augmentObject(JsFormulaParserLexer.prototype,{mCOLON:function(){try{var e=this.COLON,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(":"),this.state.type=e,this.state.channel=t}finally{}},mCONCATENATION:function(){try{var e=this.CONCATENATION,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("~"),this.state.type=e,this.state.channel=t}finally{}},mINTERSECT_ODS:function(){try{var e=this.INTERSECT_ODS,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("!"),this.state.type=e,this.state.channel=t}finally{}},mAND:function(){try{var e=this.AND,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("&"),this.state.type=e,this.state.channel=t}finally{}},mPLUS:function(){try{var e=this.PLUS,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("+"),this.state.type=e,this.state.channel=t}finally{}},mPLUSEQUAL:function(){try{var e=this.PLUSEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("+="),this.state.type=e,this.state.channel=t}finally{}},mMINUS:function(){try{var e=this.MINUS,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("-"),this.state.type=e,this.state.channel=t}finally{}},mMINUSEQUAL:function(){try{var e=this.MINUSEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("-="),this.state.type=e,this.state.channel=t}finally{}},mMULT:function(){try{var e=this.MULT,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("*"),this.state.type=e,this.state.channel=t}finally{}},mMULTEEQUAL:function(){try{var e=this.MULTEEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("*="),this.state.type=e,this.state.channel=t}finally{}},mDIV:function(){try{var e=this.DIV,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("/"),this.state.type=e,this.state.channel=t}finally{}},mDIVEQUAL:function(){try{var e=this.DIVEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("/="),this.state.type=e,this.state.channel=t}finally{}},mP_OPEN:function(){try{var e=this.P_OPEN,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("("),this.state.type=e,this.state.channel=t}finally{}},mP_CLOSE:function(){try{var e=this.P_CLOSE,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(")"),this.state.type=e,this.state.channel=t}finally{}},mEQUAL:function(){try{var e=this.EQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("="),this.state.type=e,this.state.channel=t}finally{}},mLESS:function(){try{var e=this.LESS,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("<"),this.state.type=e,this.state.channel=t}finally{}},mLESSEQUAL:function(){try{var e=this.LESSEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("<="),this.state.type=e,this.state.channel=t}finally{}},mGREATER:function(){try{var e=this.GREATER,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(">"),this.state.type=e,this.state.channel=t}finally{}},mGREATEREQUAL:function(){try{var e=this.GREATEREQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(">="),this.state.type=e,this.state.channel=t}finally{}},mNOTEQUAL:function(){try{var e=this.NOTEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("<>"),this.state.type=e,this.state.channel=t}finally{}},mNOTEQUAL2:function(){try{var e=this.NOTEQUAL2,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("!="),this.state.type=e,this.state.channel=t}finally{}},mAMPERSAND:function(){try{var e=this.AMPERSAND,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("&&"),this.state.type=e,this.state.channel=t}finally{}},mOR:function(){try{var e=this.OR,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("||"),this.state.type=e,this.state.channel=t}finally{}},mPOW:function(){try{var e=this.POW,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("^"),this.state.type=e,this.state.channel=t}finally{}},mMODE:function(){try{var e=this.MODE,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("%"),this.state.type=e,this.state.channel=t}finally{}},mMODEQUAL:function(){try{var e=this.MODEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("%="),this.state.type=e,this.state.channel=t}finally{}},mARRAY_FORMULAR_START:function(){try{var e=this.ARRAY_FORMULAR_START,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("{"),this.state.type=e,this.state.channel=t}finally{}},mARRAY_FORMULAR_END:function(){try{var e=this.ARRAY_FORMULAR_END,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("}"),this.state.type=e,this.state.channel=t}finally{}},mT__56:function(){try{var e=this.T__56,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("."),this.state.type=e,this.state.channel=t}finally{}},mNONZERO_NUMBER:function(){try{var e=0;e:do{var t=2,n=this.input.LA(1);n>="1"&&n<="9"&&(t=1);switch(t){case 1:this.matchRange("1","9");break;default:if(e>=1)break e;var r=new org.antlr.runtime.EarlyExitException(1,this.input);throw r}e++}while(!0)}finally{}},mINT:function(){try{var e=0;e:do{var t=2,n=this.input.LA(1);n>="0"&&n<="9"&&(t=1);switch(t){case 1:this.mDIGIT();break;default:if(e>=1)break e;var r=new org.antlr.runtime.EarlyExitException(2,this.input);throw r}e++}while(!0)}finally{}},mSPACE1:function(){try{if(this.input.LA(1)!=" "&&this.input.LA(1)!="\u00a0"&&this.input.LA(1)!="\u3000"){var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(e),e}this.input.consume()}finally{}},mNUMSEP:function(){try{e:do{var e=2,t=this.input.LA(1);if(t==","||t==".")e=1;switch(e){case 1:if(this.input.LA(1)!=","&&this.input.LA(1)!="."){var n=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(n),n}this.input.consume();break;default:break e}}while(!0)}finally{}},mLOCALE_NUMBER:function(){try{var e=this.LOCALE_NUMBER,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);if(i==","||i=="."||i>="0"&&i<="9")r=1;switch(r){case 1:this.mNUMSEP(),this.mINT();t:do{var s=2,o=this.input.LA(1);if(o=="'"||o==","||o==".")s=1;switch(s){case 1:if(this.input.LA(1)!="'"&&this.input.LA(1)!=","&&this.input.LA(1)!="."){var u=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(u),u}this.input.consume();break;default:break t}}while(!0);break;default:if(n>=1)break e;var a=new org.antlr.runtime.EarlyExitException(5,this.input);throw a}n++}while(!0);var f=2,l=this.input.LA(1);l=="E"&&(f=1);switch(f){case 1:this.match("E");var c=2,h=this.input.LA(1);if(h=="+"||h=="-")c=1;switch(c){case 1:if(this.input.LA(1)!="+"&&this.input.LA(1)!="-"){var u=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(u),u}this.input.consume()}this.mINT()}this.state.type=e,this.state.channel=t}finally{}},mSINGLEQUOT_STRING:function(){try{var e=this.SINGLEQUOT_STRING,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=2,r=this.input.LA(1);r=="$"&&(n=1);switch(n){case 1:this.match("$")}var i=0;e:do{var s=2,o=this.input.LA(1);o=="'"&&(s=1);switch(s){case 1:this.match("'");t:do{var u=2,a=this.input.LA(1);if(a>="\0"&&a<="\f"||a>=""&&a<="&"||a>="("&&a<="\u2027"||a>="\u202a"&&a<="\uffff")u=1;switch(u){case 1:if(!(this.input.LA(1)>="\0"&&this.input.LA(1)<="\f"||this.input.LA(1)>=""&&this.input.LA(1)<="&"||this.input.LA(1)>="("&&this.input.LA(1)<="\u2027"||this.input.LA(1)>="\u202a"&&this.input.LA(1)<="\uffff")){var f=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(f),f}this.input.consume();break;default:break t}}while(!0);this.match("'");break;default:if(i>=1)break e;var l=new org.antlr.runtime.EarlyExitException(10,this.input);throw l}i++}while(!0);this.state.type=e,this.state.channel=t}finally{}},mDOUBLEQUOT_STRING:function(){try{var e=this.DOUBLEQUOT_STRING,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);i=='"'&&(r=1);switch(r){case 1:this.match('"');t:do{var s=2,o=this.input.LA(1);if(o>="\0"&&o<="\f"||o>=""&&o<="!"||o>="#"&&o<="\u2027"||o>="\u202a"&&o<="\uffff")s=1;switch(s){case 1:if(!(this.input.LA(1)>="\0"&&this.input.LA(1)<="\f"||this.input.LA(1)>=""&&this.input.LA(1)<="!"||this.input.LA(1)>="#"&&this.input.LA(1)<="\u2027"||this.input.LA(1)>="\u202a"&&this.input.LA(1)<="\uffff")){var u=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(u),u}this.input.consume();break;default:break t}}while(!0);this.match('"');break;default:if(n>=1)break e;var a=new org.antlr.runtime.EarlyExitException(12,this.input);throw a}n++}while(!0);this.state.type=e,this.state.channel=t}finally{}},mARG_SEP:function(){try{var e=this.ARG_SEP,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;if(this.input.LA(1)!=","&&this.input.LA(1)!=";"){var n=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(n),n}this.input.consume(),this.state.type=e,this.state.channel=t}finally{}},mFUNC:function(){try{var e=this.FUNC,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);if(i>="0"&&i<="9"||i>="A"&&i<="Z"||i=="_")r=1;switch(r){case 1:if(!(this.input.LA(1)>="0"&&this.input.LA(1)<="9"||this.input.LA(1)>="A"&&this.input.LA(1)<="Z"||this.input.LA(1)=="_")){var s=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(s),s}this.input.consume();break;default:if(n>=1)break e;var o=new org.antlr.runtime.EarlyExitException(13,this.input);throw o}n++}while(!0);this.match("("),this.state.type=e,this.state.channel=t}finally{}},mNAME:function(){try{var e=this.NAME,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);if(i=="$"||i=="'"||i=="."||i>="0"&&i<="9"||i=="?"||i>="A"&&i<="Z"||i=="\\"||i=="_"||i>="a"&&i<="z")r=1;switch(r){case 1:if(!(this.input.LA(1)=="$"||this.input.LA(1)=="'"||this.input.LA(1)=="."||this.input.LA(1)>="0"&&this.input.LA(1)<="9"||this.input.LA(1)=="?"||this.input.LA(1)>="A"&&this.input.LA(1)<="Z"||this.input.LA(1)=="\\"||this.input.LA(1)=="_"||this.input.LA(1)>="a"&&this.input.LA(1)<="z")){var s=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(s),s}this.input.consume();break;default:if(n>=1)break e;var o=new org.antlr.runtime.EarlyExitException(14,this.input);throw o}n++}while(!0);var u=2,a=this.input.LA(1);a=="#"&&(u=1);switch(u){case 1:this.match("#REF!")}this.state.type=e,this.state.channel=t}finally{}},mERRORNAME:function(){try{var e=this.ERRORNAME,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("#");var n=3,r=this.input.LA(1);if(r=="D"||r=="R"||r=="V")n=1;else{if(r!="N"){var i=new org.antlr.runtime.NoViableAltException("",17,0,this.input);throw i}switch(this.input.LA(2)){case"U":n=1;break;case"/":n=2;break;case"A":n=3;break;default:var i=new org.antlr.runtime.NoViableAltException("",17,2,this.input);throw i}}switch(n){case 1:var s=5;switch(this.input.LA(1)){case"V":s=1;break;case"N":var o=this.input.LA(2);if(o!="U"){var i=new org.antlr.runtime.NoViableAltException("",16,2,this.input);throw i}var u=this.input.LA(3);if(u=="M")s=2;else{if(u!="L"){var i=new org.antlr.runtime.NoViableAltException("",16,5,this.input);throw i}s=5}break;case"R":s=3;break;case"D":s=4;break;default:var i=new org.antlr.runtime.NoViableAltException("",16,0,this.input);throw i}switch(s){case 1:this.match("VALUE");break;case 2:this.match("NUM");break;case 3:this.match("REF");break;case 4:this.match("DIV/0");break;case 5:this.match("NULL")}this.match("!");break;case 2:this.match("N/A");break;case 3:this.match("NAME?")}this.state.type=e,this.state.channel=t}finally{}},mNAME1:function(){try{var e=this.NAME1,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);if(i>="\0"&&i<="\b"||i==""||i>=""&&i<=""||i>="0"&&i<="9"||i>="A"&&i<="Z"||i=="_"||i>="a"&&i<="z"||i>=""&&i<="\uffff")r=1;switch(r){case 1:if(!(this.input.LA(1)>="\0"&&this.input.LA(1)<="\b"||this.input.LA(1)==""||this.input.LA(1)>=""&&this.input.LA(1)<=""||this.input.LA(1)>="0"&&this.input.LA(1)<="9"||this.input.LA(1)>="A"&&this.input.LA(1)<="Z"||this.input.LA(1)=="_"||this.input.LA(1)>="a"&&this.input.LA(1)<="z"||this.input.LA(1)>=""&&this.input.LA(1)<="\uffff")){var s=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(s),s}this.input.consume();break;default:if(n>=1)break e;var o=new org.antlr.runtime.EarlyExitException(18,this.input);throw o}n++}while(!0);websheet.parse.parseHelper._cellHasUnicode=!0,this.state.type=e,this.state.channel=t}finally{}},mCOMMAOrSPACE:function(){try{this.match(",");var e=2,t=this.input.LA(1);t==" "&&(e=1);switch(e){case 1:this.match(" ")}}finally{}},mKEYCHARACTER:function(){try{if(this.input.LA(1)!="#"&&this.input.LA(1)!="'"&&this.input.LA(1)!="@"&&this.input.LA(1)!="["&&this.input.LA(1)!="]"){var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(e),e}this.input.consume()}finally{}},mODF_COLUMN:function(){try{this.match("[");var e=0;e:do{var t=3,n=this.input.LA(1);n>="\0"&&n<='"'||n>="$"&&n<="&"||n>="("&&n<="?"||n>="A"&&n<="Z"||n=="\\"||n>="^"&&n<="\uffff"?t=1:n=="'"&&(t=2);switch(t){case 1:if(!(this.input.LA(1)>="\0"&&this.input.LA(1)<='"'||this.input.LA(1)>="$"&&this.input.LA(1)<="&"||this.input.LA(1)>="("&&this.input.LA(1)<="?"||this.input.LA(1)>="A"&&this.input.LA(1)<="Z"||this.input.LA(1)=="\\"||this.input.LA(1)>="^"&&this.input.LA(1)<="\uffff")){var r=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(r),r}this.input.consume();break;case 2:this.match("'"),this.mKEYCHARACTER();break;default:if(e>=1)break e;var i=new org.antlr.runtime.EarlyExitException(20,this.input);throw i}e++}while(!0);this.match("]")}finally{}},mODF_COL_RANGE:function(){try{this.mODF_COLUMN();var e=2,t=this.input.LA(1);t==":"&&(e=1);switch(e){case 1:this.match(":"),this.mODF_COLUMN()}}finally{}},mODF_PREWORD:function(){try{this.match("[");var e=5,t=this.input.LA(1);if(t!="#"){var r=new org.antlr.runtime.NoViableAltException("",22,0,this.input);throw r}switch(this.input.LA(2)){case"T":var n=this.input.LA(3);if(n=="H")e=1;else{if(n!="O"){var r=new org.antlr.runtime.NoViableAltException("",22,2,this.input);throw r}e=4}break;case"A":e=2;break;case"H":e=3;break;case"D":e=5;break;default:var r=new org.antlr.runtime.NoViableAltException("",22,1,this.input);throw r}switch(e){case 1:this.match("#THIS ROW");break;case 2:this.match("#ALL");break;case 3:this.match("#HEADERS");break;case 4:this.match("#TOTALS");break;case 5:this.match("#DATA")}this.match("]")}finally{}},mODF_PRELIST:function(){try{var e=3;e=this.dfa23.predict(this.input);switch(e){case 1:this.match("[#HEADERS]"),this.mCOMMAOrSPACE(),this.match("[#DATA]");break;case 2:this.match("[#DATA]"),this.mCOMMAOrSPACE(),this.match("[#TOTALS]");break;case 3:this.mODF_PREWORD()}}finally{}},mODF_TABLE:function(){try{var e=this.ODF_TABLE,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=3,r=this.input.LA(1);if(r!="["){var o=new org.antlr.runtime.NoViableAltException("",28,0,this.input);throw o}var i=this.input.LA(2);if(i=="#")n=2;else if(i==" "){var s=this.input.LA(3);if(s>="\0"&&s<='"'||s>="$"&&s<="?"||s>="A"&&s<="Z"||s>="\\"&&s<="\uffff")n=3;else{if(s!="["){var o=new org.antlr.runtime.NoViableAltException("",28,3,this.input);throw o}n=1}}else if(i=="[")n=1;else{if(!(i>="\0"&&i<=""||i>="!"&&i<='"'||i>="$"&&i<="?"||i>="A"&&i<="Z"||i=="\\"||i>="^"&&i<="\uffff")){var o=new org.antlr.runtime.NoViableAltException("",28,1,this.input);throw o}n=3}switch(n){case 1:this.match("[");var u=2,a=this.input.LA(1);a==" "&&(u=1);switch(u){case 1:this.match(" ")}var f=2,l=this.input.LA(1);if(l!="["){var o=new org.antlr.runtime.NoViableAltException("",26,0,this.input);throw o}var c=this.input.LA(2);if(c=="#")f=1;else{if(!(c>="\0"&&c<='"'||c>="$"&&c<="?"||c>="A"&&c<="Z"||c=="\\"||c>="^"&&c<="\uffff")){var o=new org.antlr.runtime.NoViableAltException("",26,1,this.input);throw o}f=2}switch(f){case 1:this.mODF_PRELIST();var h=2,p=this.input.LA(1);p==","&&(h=1);switch(h){case 1:this.mCOMMAOrSPACE(),this.mODF_COL_RANGE()}break;case 2:this.mODF_COL_RANGE()}var d=2,v=this.input.LA(1);v==" "&&(d=1);switch(d){case 1:this.match(" ")}this.match("]");break;case 2:this.mODF_PREWORD();break;case 3:this.mODF_COLUMN()}websheet.parse.parseHelper._cellHasUnicode=!0,this.state.type=e,this.state.channel=t}finally{}},mINTERSECT:function(){try{var e=this.INTERSECT,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);if(i==" "||i=="\u00a0"||i=="\u3000")r=1;switch(r){case 1:this.mSPACE1();break;default:if(n>=1)break e;var s=new org.antlr.runtime.EarlyExitException(29,this.input);throw s}n++}while(!0);this.state.type=e,this.state.channel=t}finally{}},mWHITESPACE:function(){try{var t=this.WHITESPACE,n=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,r=0;e:do{var i=2,s=this.input.LA(1);if(s>="	"&&s<="\n"||s>="\f"&&s<="\r"||s==" ")i=1;switch(i){case 1:if(!(this.input.LA(1)>="	"&&this.input.LA(1)<="\n"||this.input.LA(1)>="\f"&&this.input.LA(1)<="\r"||this.input.LA(1)==" ")){var o=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(o),o}this.input.consume();break;default:if(r>=1)break e;var u=new org.antlr.runtime.EarlyExitException(30,this.input);throw u}r++}while(!0);n=e,this.state.type=t,this.state.channel=n}finally{}},mSPACE:function(){try{if(!(this.input.LA(1)>="	"&&this.input.LA(1)<="\n"||this.input.LA(1)>="\f"&&this.input.LA(1)<="\r"||this.input.LA(1)==" ")){var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(e),e}this.input.consume()}finally{}},mLT:function(){try{if(!(this.input.LA(1)=="\r"||this.input.LA(1)>="\u2028"&&this.input.LA(1)<="\u2029")){var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(e),e}this.input.consume()}finally{}},mDIGIT:function(){try{this.matchRange("0","9")}finally{}},mTokens:function(){var e=40;e=this.dfa31.predict(this.input);switch(e){case 1:this.mCOLON();break;case 2:this.mCONCATENATION();break;case 3:this.mINTERSECT_ODS();break;case 4:this.mAND();break;case 5:this.mPLUS();break;case 6:this.mPLUSEQUAL();break;case 7:this.mMINUS();break;case 8:this.mMINUSEQUAL();break;case 9:this.mMULT();break;case 10:this.mMULTEEQUAL();break;case 11:this.mDIV();break;case 12:this.mDIVEQUAL();break;case 13:this.mP_OPEN();break;case 14:this.mP_CLOSE();break;case 15:this.mEQUAL();break;case 16:this.mLESS();break;case 17:this.mLESSEQUAL();break;case 18:this.mGREATER();break;case 19:this.mGREATEREQUAL();break;case 20:this.mNOTEQUAL();break;case 21:this.mNOTEQUAL2();break;case 22:this.mAMPERSAND();break;case 23:this.mOR();break;case 24:this.mPOW();break;case 25:this.mMODE();break;case 26:this.mMODEQUAL();break;case 27:this.mARRAY_FORMULAR_START();break;case 28:this.mARRAY_FORMULAR_END();break;case 29:this.mT__56();break;case 30:this.mLOCALE_NUMBER();break;case 31:this.mSINGLEQUOT_STRING();break;case 32:this.mDOUBLEQUOT_STRING();break;case 33:this.mARG_SEP();break;case 34:this.mFUNC();break;case 35:this.mNAME();break;case 36:this.mERRORNAME();break;case 37:this.mNAME1();break;case 38:this.mODF_TABLE();break;case 39:this.mINTERSECT();break;case 40:this.mWHITESPACE()}}},!0),org.antlr.lang.augmentObject(JsFormulaParserLexer,{DFA23_eotS:"\r\uffff\uffff\uffff",DFA23_eofS:"\uffff",DFA23_minS:"[#AEA\uffffATDAE]R,S\uffff],\uffff",DFA23_maxS:"[#TEA\uffffATDAE]R,S\uffff],\uffff",DFA23_acceptS:"\uffff	\uffff\uffff",DFA23_specialS:"\uffff}>",DFA23_transitionS:["","","\uffff\uffff\uffff","","","","\b","	","\n","","\f","\r","","","","","","",""]}),org.antlr.lang.augmentObject(JsFormulaParserLexer,{DFA23_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserLexer.DFA23_eotS),DFA23_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserLexer.DFA23_eofS),DFA23_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserLexer.DFA23_minS),DFA23_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserLexer.DFA23_maxS),DFA23_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserLexer.DFA23_acceptS),DFA23_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserLexer.DFA23_specialS),DFA23_transition:function(){var e=[],t,n=JsFormulaParserLexer.DFA23_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserLexer.DFA23_transitionS[t]));return e}()}),JsFormulaParserLexer.DFA23=function(e){this.recognizer=e,this.decisionNumber=23,this.eot=JsFormulaParserLexer.DFA23_eot,this.eof=JsFormulaParserLexer.DFA23_eof,this.min=JsFormulaParserLexer.DFA23_min,this.max=JsFormulaParserLexer.DFA23_max,this.accept=JsFormulaParserLexer.DFA23_accept,this.special=JsFormulaParserLexer.DFA23_special,this.transition=JsFormulaParserLexer.DFA23_transition},org.antlr.lang.extend(JsFormulaParserLexer.DFA23,org.antlr.runtime.DFA,{getDescription:function(){return"830:10: fragment ODF_PRELIST : ( ( '[#HEADERS]' COMMAOrSPACE '[#DATA]' ) | ( '[#DATA]' COMMAOrSPACE '[#TOTALS]' ) | ODF_PREWORD );"},dummy:null}),org.antlr.lang.augmentObject(JsFormulaParserLexer,{DFA31_eotS:"\uffff$&(*,.\uffff13\uffff5\uffff69\uffff\uffff \uffffB\uffff9\uffff9\uffffA\uffff9\uffff9\uffff",DFA31_eofS:"J\uffff",DFA31_minS:"\0\uffff=&=\uffff=\uffff=\uffff#,\0'\0\uffff\0\uffff \uffff	\uffff#,\uffff\0#\uffff\0#\0\uffff+\0#\0",DFA31_maxS:"\uffff\uffff=&=\uffff>=\uffff=\uffffz9\uffff'\uffff\uffff\uffff\uffff\u3000\uffff \uffffz9\uffff\uffffz\uffff\uffffz\uffff\uffff9\uffffz\uffff",DFA31_acceptS:"\uffff\uffff\r\uffff\uffff\uffff !\uffff$#\uffff&%\uffff(\b\n	\f\uffff\uffff\"\uffff'\uffff",DFA31_specialS:"\uffff\f\uffff\uffff\uffff\0\uffff\b\uffff\uffff	\uffff\n}>",DFA31_transitionS:['	 " " !	\n\b\n\f\r\uffff\uffff\uffff! \u2f5f \ucfff ',"","","#","%","'",")","+","-","","","","/0","2","","","4","","","\uffff\uffff9\uffff8\uffff\n7\uffff\uffff\uffff\uffff\uffff","9\uffff9\uffff\n9","	 \uffff \uffff \uffff\uffff<=\uffff;\uffff\n\uffff\uffff:\uffff\uffff\uffff\uffff\uff81 ","","\rA\uffffA>@A?A@A\n@A@A@A@A@A@\u1fadA\uffff\udfd6A","","","	 \uffff \uffff \b\uffff=\uffff\n\uffff\uffff\uffff\uffff\uff81 ","	 \uffff \uffff \uffff\n\uffff\uffff\uffff\uffff\uff81 ","","","B\uffff\u2f5f\uffff","","",'"\uffff"\uffff!',"","","","","","","","","","","","","","","","","","","","","","\uffff<\uffff;\uffff\n7\uffff\uffffC\uffff\uffff\uffff","9\uffff8\uffff\n7","","	 \uffff \uffff \b\uffff=\uffff9\uffff9\uffff\nD\uffff\uffff\uffff\uffff\uff81 ","\uffff<\uffff;\uffff\n7\uffff\uffffC\uffff\uffff\uffff","\uffff<\uffff;\uffff\n7\uffff\uffffC\uffff\uffff\uffff","","\rA\uffffDAE\u1fd5A\uffff\udfd6A","\uffff\uffff\uffff\n\uffff\uffff\uffff\uffff\uffff","\rA\uffffA>@A?A@A\n@A@A@A@A@A@\u1fadA\uffff\udfd6A","","","9\uffff9\uffff\nF","	 \uffff \uffff \uffff\uffff=\uffff\uffff\nD\uffff\uffff\uffff\uffff\uffff\uffff\uff81 ","\rA\uffff7AG\u1fe2A\uffff\udfd6A","\uffff\uffff\uffff\nF\uffff\uffff\uffff\uffff\uffff","\rA\uffff8AH\u1fe1A\uffff\udfd6A","\rA\uffffAI\u2006A\uffff\udfd6A","\rA\uffff\u201aA\uffff\udfd6A"]}),org.antlr.lang.augmentObject(JsFormulaParserLexer,{DFA31_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserLexer.DFA31_eotS),DFA31_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserLexer.DFA31_eofS),DFA31_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserLexer.DFA31_minS),DFA31_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserLexer.DFA31_maxS),DFA31_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserLexer.DFA31_acceptS),DFA31_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserLexer.DFA31_specialS),DFA31_transition:function(){var e=[],t,n=JsFormulaParserLexer.DFA31_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserLexer.DFA31_transitionS[t]));return e}()}),JsFormulaParserLexer.DFA31=function(e){this.recognizer=e,this.decisionNumber=31,this.eot=JsFormulaParserLexer.DFA31_eot,this.eof=JsFormulaParserLexer.DFA31_eof,this.min=JsFormulaParserLexer.DFA31_min,this.max=JsFormulaParserLexer.DFA31_max,this.accept=JsFormulaParserLexer.DFA31_accept,this.special=JsFormulaParserLexer.DFA31_special,this.transition=JsFormulaParserLexer.DFA31_transition},org.antlr.lang.extend(JsFormulaParserLexer.DFA31,org.antlr.runtime.DFA,{getDescription:function(){return"1:1: Tokens : ( COLON | CONCATENATION | INTERSECT_ODS | AND | PLUS | PLUSEQUAL | MINUS | MINUSEQUAL | MULT | MULTEEQUAL | DIV | DIVEQUAL | P_OPEN | P_CLOSE | EQUAL | LESS | LESSEQUAL | GREATER | GREATEREQUAL | NOTEQUAL | NOTEQUAL2 | AMPERSAND | OR | POW | MODE | MODEQUAL | ARRAY_FORMULAR_START | ARRAY_FORMULAR_END | T__56 | LOCALE_NUMBER | SINGLEQUOT_STRING | DOUBLEQUOT_STRING | ARG_SEP | FUNC | NAME | ERRORNAME | NAME1 | ODF_TABLE | INTERSECT | WHITESPACE );"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1);e=-1,n>="0"&&n<="9"?e=68:n>="\0"&&n<="\b"||n==""||n>=""&&n<=""||n>=""&&n<="\uffff"?e=32:n=="+"||n=="-"?e=57:n>="A"&&n<="Z"||n=="_"?e=26:n=="("?e=61:n>="a"&&n<="z"?e=27:e=29;if(e>=0)return e;break;case 1:var r=t.LA(1);e=-1,r>="0"&&r<="9"||r>="A"&&r<="Z"||r=="_"||r>="a"&&r<="z"?e=27:r>="\0"&&r<="\b"||r==""||r>=""&&r<=""||r>=""&&r<="\uffff"?e=32:e=29;if(e>=0)return e;break;case 2:var i=t.LA(1);e=-1,i=="#"?e=62:i=="'"?e=63:i=="$"||i=="."||i>="0"&&i<="9"||i=="?"||i>="A"&&i<="Z"||i=="\\"||i=="_"||i>="a"&&i<="z"?e=64:i>="\0"&&i<="\f"||i>=""&&i<='"'||i>="%"&&i<="&"||i>="("&&i<="-"||i=="/"||i>=":"&&i<=">"||i=="@"||i=="["||i>="]"&&i<="^"||i=="`"||i>="{"&&i<="\u2027"||i>="\u202a"&&i<="\uffff"?e=65:e=29;if(e>=0)return e;break;case 3:var s=t.LA(1);e=-1,s>="\0"&&s<="\f"||s>=""&&s<="\u2027"||s>="\u202a"&&s<="\uffff"?e=65:e=29;if(e>=0)return e;break;case 4:var o=t.LA(1);e=-1,o>="0"&&o<="9"||o>="A"&&o<="Z"||o=="_"?e=26:o>="\0"&&o<="\b"||o==""||o>=""&&o<=""||o>=""&&o<="\uffff"?e=32:o=="("?e=61:o>="a"&&o<="z"?e=27:e=29;if(e>=0)return e;break;case 5:var u=t.LA(1);e=-1,u=="'"?e=63:u=="#"?e=62:u=="$"||u=="."||u>="0"&&u<="9"||u=="?"||u>="A"&&u<="Z"||u=="\\"||u=="_"||u>="a"&&u<="z"?e=64:u>="\0"&&u<="\f"||u>=""&&u<='"'||u>="%"&&u<="&"||u>="("&&u<="-"||u=="/"||u>=":"&&u<=">"||u=="@"||u=="["||u>="]"&&u<="^"||u=="`"||u>="{"&&u<="\u2027"||u>="\u202a"&&u<="\uffff"?e=65:e=29;if(e>=0)return e;break;case 6:var a=t.LA(1);e=-1;if(a==":")e=1;else if(a=="~")e=2;else if(a=="!")e=3;else if(a=="&")e=4;else if(a=="+")e=5;else if(a=="-")e=6;else if(a=="*")e=7;else if(a=="/")e=8;else if(a=="(")e=9;else if(a==")")e=10;else if(a=="=")e=11;else if(a=="<")e=12;else if(a==">")e=13;else if(a=="|")e=14;else if(a=="^")e=15;else if(a=="%")e=16;else if(a=="{")e=17;else if(a=="}")e=18;else if(a==".")e=19;else if(a==",")e=20;else if(a>="0"&&a<="9")e=21;else if(a=="$")e=22;else if(a=="'")e=23;else if(a=='"')e=24;else if(a==";")e=25;else if(a>="A"&&a<="Z"||a=="_")e=26;else if(a>="a"&&a<="z")e=27;else if(a=="#")e=28;else if(a=="?"||a=="\\")e=29;else if(a=="\u00a0"||a=="\u3000")e=30;else if(a=="[")e=31;else if(a>="\0"&&a<="\b"||a==""||a>=""&&a<=""||a>=""&&a<="\u009f"||a>="\u00a1"&&a<="\u2fff"||a>="\u3001"&&a<="\uffff")e=32;else if(a==" ")e=33;else if(a>="	"&&a<="\n"||a>="\f"&&a<="\r")e=34;if(e>=0)return e;break;case 7:var f=t.LA(1);e=-1,f>="0"&&f<="9"?e=68:f>="A"&&f<="Z"||f=="_"?e=26:f>="#"&&f<="$"||f=="'"||f=="."||f=="?"||f=="\\"?e=29:f>="\0"&&f<="\b"||f==""||f>=""&&f<=""||f>=""&&f<="\uffff"?e=32:f=="("?e=61:f>="a"&&f<="z"?e=27:e=57;if(e>=0)return e;break;case 8:var l=t.LA(1);e=-1;if(l=="R")e=69;else if(l>="\0"&&l<="\f"||l>=""&&l<="Q"||l>="S"&&l<="\u2027"||l>="\u202a"&&l<="\uffff")e=65;if(e>=0)return e;break;case 9:var c=t.LA(1);e=-1;if(c=="E")e=71;else if(c>="\0"&&c<="\f"||c>=""&&c<="D"||c>="F"&&c<="\u2027"||c>="\u202a"&&c<="\uffff")e=65;if(e>=0)return e;break;case 10:var h=t.LA(1);e=-1;if(h=="F")e=72;else if(h>="\0"&&h<="\f"||h>=""&&h<="E"||h>="G"&&h<="\u2027"||h>="\u202a"&&h<="\uffff")e=65;if(e>=0)return e;break;case 11:var p=t.LA(1);e=-1;if(p=="!")e=73;else if(p>="\0"&&p<="\f"||p>=""&&p<=" "||p>='"'&&p<="\u2027"||p>="\u202a"&&p<="\uffff")e=65;if(e>=0)return e;break;case 12:var d=t.LA(1);e=-1,d=="E"?e=58:d=="."?e=59:d>="0"&&d<="9"?e=21:d=="'"?e=60:d>="A"&&d<="D"||d>="F"&&d<="Z"||d=="_"?e=26:d>="#"&&d<="$"||d=="?"||d=="\\"?e=29:d>="\0"&&d<="\b"||d==""||d>=""&&d<=""||d>=""&&d<="\uffff"?e=32:d=="("?e=61:d>="a"&&d<="z"?e=27:e=57;if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),31,n,t);throw this.error(i),i},dummy:null})}();var JsFormulaParserParser=function(e,t){t||(t=new org.antlr.runtime.RecognizerSharedState),function(){this.tokenList=[],this.intersectionStack=[],this.emitErrorMessage=function(e){throw console&&console.warn(e),"#ERROR!"}}.call(this),JsFormulaParserParser.superclass.constructor.call(this,e,t),this.dfa9=new JsFormulaParserParser.DFA9(this),this.dfa8=new JsFormulaParserParser.DFA8(this),this.dfa37=new JsFormulaParserParser.DFA37(this),this.dfa20=new JsFormulaParserParser.DFA20(this),this.dfa36=new JsFormulaParserParser.DFA36(this),this.dfa43=new JsFormulaParserParser.DFA43(this),this.dfa50=new JsFormulaParserParser.DFA50(this),this.dfa55=new JsFormulaParserParser.DFA55(this),this.state.ruleMemo={},this.adaptor=new org.antlr.runtime.tree.CommonTreeAdaptor};org.antlr.lang.augmentObject(JsFormulaParserParser,{ODF_TABLE:53,NAME1:39,LT:46,SPACE1:44,NAME:36,DIGIT:42,ARRAY_FORMULAR_END:31,NOTEQUAL2:24,EQUAL:18,DOUBLEQUOT_STRING:38,NUMSEP:45,LESS:19,PLUS:8,LESSEQUAL:20,MULTEEQUAL:13,MODE:28,P_CLOSE:17,KEYCHARACTER:48,MULT:12,ARG_SEP:33,AND:7,CONCATENATION:5,POW:27,PLUSEQUAL:9,COLON:4,SINGLEQUOT_STRING:34,NOTEQUAL:23,DIVEQUAL:15,ODF_COLUMN:49,MINUSEQUAL:11,FUNC:40,LOCALE_NUMBER:35,INT:43,ODF_COL_RANGE:50,MINUS:10,T__56:56,AMPERSAND:25,ARRAY_FORMULAR_START:30,P_OPEN:16,GREATER:21,EOF:-1
,INTERSECT_ODS:6,ODF_PREWORD:51,OR:26,SPACE:55,COMMAOrSPACE:47,DIV:14,MODEQUAL:29,ODF_PRELIST:52,ERRORNAME:37,NONZERO_NUMBER:41,GREATEREQUAL:22,WHITESPACE:54,INTERSECT:32}),function(){var e=53,t=39,n=46,r=44,i=36,s=42,o=31,u=24,l=18,c=38,h=45,p=19,d=8,v=20,g=13,y=28,w=17,E=48,S=12,T=33,N=7,C=5,k=27,L=9,A=4,O=34,M=23,_=15,D=49,P=11,H=40,B=35,j=43,F=50,I=10,q=56,R=25,U=30,z=16,W=21,X=-1,V=6,$=51,J=26,K=55,Q=47,G=14,Y=29,Z=52,et=37,tt=41,nt=22,rt=54,it=32;org.antlr.lang.extend(JsFormulaParserParser,org.antlr.runtime.Parser,{setTreeAdaptor:function(e){this.adaptor=e},getTreeAdaptor:function(){return this.adaptor},getTokenNames:function(){return JsFormulaParserParser.tokenNames},getGrammarFileName:function(){return"C:\\IBMDoc\\DocsSoruceCode\\com.ibm.docs.web.resources\\WebContent\\js\\parser\\JsFormulaParser.g"}}),org.antlr.lang.augmentObject(JsFormulaParserParser.prototype,{prog_return:function(){JsFormulaParserParser.prog_return=function(){},org.antlr.lang.extend(JsFormulaParserParser.prog_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),prog:function(){var e=new JsFormulaParserParser.prog_return;e.start=this.input.LT(1);var t=this.input.index(),n=null,r=null,i=null,s=null,u=null,a=null,f=null,c=null,h=null,p=null,v=null,m=null,g=null,y=null,b=null,w=null,E=null;this.inConstArray=0;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,1))return e;var S=2,x=this.input.LA(1);if(x==l)S=1;else{if(x!=U){if(this.state.backtracking>0)return this.state.failed=!0,e;var T=new org.antlr.runtime.NoViableAltException("",4,0,this.input);throw T}S=2}switch(S){case 1:n=this.adaptor.nil(),r=this.match(this.input,l,JsFormulaParserParser.FOLLOW_EQUAL_in_prog347);if(this.state.failed)return e;this.state.backtracking===0&&(v=this.adaptor.create(r),this.adaptor.addChild(n,v));var N=2,C=this.input.LA(1);C==it&&(N=1);switch(N){case 1:i=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_prog349);if(this.state.failed)return e;this.state.backtracking===0&&(m=this.adaptor.create(i),this.adaptor.addChild(n,m))}var k=0;e:do{var L=2,A=this.input.LA(1);if(A==d||A==I||A==z||A==U||A>=O&&A<=H)L=1;switch(L){case 1:this.pushFollow(JsFormulaParserParser.FOLLOW_expr_in_prog352),h=this.expr(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,h.getTree());break;default:if(k>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,e;var M=new org.antlr.runtime.EarlyExitException(2,this.input);throw M}k++}while(!0);this.state.backtracking===0,s=this.match(this.input,X,JsFormulaParserParser.FOLLOW_EOF_in_prog357);if(this.state.failed)return e;this.state.backtracking===0&&(g=this.adaptor.create(s),this.adaptor.addChild(n,g));break;case 2:n=this.adaptor.nil(),u=this.match(this.input,U,JsFormulaParserParser.FOLLOW_ARRAY_FORMULAR_START_in_prog363);if(this.state.failed)return e;this.state.backtracking===0&&(y=this.adaptor.create(u),this.adaptor.addChild(n,y)),a=this.match(this.input,l,JsFormulaParserParser.FOLLOW_EQUAL_in_prog365);if(this.state.failed)return e;this.state.backtracking===0&&(b=this.adaptor.create(a),this.adaptor.addChild(n,b)),this.state.backtracking===0;var _=0;t:do{var D=2,P=this.input.LA(1);if(P==d||P==I||P==z||P==U||P>=O&&P<=H)D=1;switch(D){case 1:this.pushFollow(JsFormulaParserParser.FOLLOW_expr_in_prog377),p=this.expr(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,p.getTree());break;default:if(_>=1)break t;if(this.state.backtracking>0)return this.state.failed=!0,e;var M=new org.antlr.runtime.EarlyExitException(3,this.input);throw M}_++}while(!0);this.state.backtracking===0,f=this.match(this.input,o,JsFormulaParserParser.FOLLOW_ARRAY_FORMULAR_END_in_prog382);if(this.state.failed)return e;this.state.backtracking===0&&(w=this.adaptor.create(f),this.adaptor.addChild(n,w)),c=this.match(this.input,X,JsFormulaParserParser.FOLLOW_EOF_in_prog384);if(this.state.failed)return e;this.state.backtracking===0&&(E=this.adaptor.create(c),this.adaptor.addChild(n,E))}e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(n),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(B){if(!(B instanceof org.antlr.runtime.RecognitionException))throw B;this.reportError(B),this.recover(this.input,B),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),B)}finally{this.state.backtracking>0&&this.memoize(this.input,1,t)}return e},expr_return:function(){JsFormulaParserParser.expr_return=function(){},org.antlr.lang.extend(JsFormulaParserParser.expr_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),expr:function(){var e=new JsFormulaParserParser.expr_return;e.start=this.input.LT(1);var t=this.input.index(),n=null,r=null,i=null,s=null,o=null,a=null,f=null,c=null,h=null,p=null,d=null;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,2))return e;n=this.adaptor.nil(),this.pushFollow(JsFormulaParserParser.FOLLOW_atom_in_expr407),a=this.atom(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,a.getTree());var v=2,m=this.input.LA(1);if(m==it){var g=this.input.LA(2);this.synpred5_JsFormulaParser()&&(v=1)}switch(v){case 1:r=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_expr417);if(this.state.failed)return e;this.state.backtracking===0&&(c=this.adaptor.create(r),this.adaptor.addChild(n,c));if(this.state.backtracking===0&&this.bLocaleSensitive){var b=new websheet.parse.referenceToken(r?r.getText():null,r.getStartIndex());this.tokenList.push(b),this.intersectionStack.push(this.tokenList.length-1)}}e:do{var w=2,E=this.input.LA(1);E==y&&(w=1);switch(w){case 1:s=this.match(this.input,y,JsFormulaParserParser.FOLLOW_MODE_in_expr429);if(this.state.failed)return e;this.state.backtracking===0&&(p=this.adaptor.create(s),this.adaptor.addChild(n,p));if(this.state.backtracking===0&&this.bLocaleSensitive){var b=new websheet.parse.referenceToken(s?s.getText():null,s.getStartIndex());this.tokenList.push(b)}break;default:break e}}while(!0);t:do{var S=2;S=this.dfa9.predict(this.input);switch(S){case 1:var x=2;x=this.dfa8.predict(this.input);switch(x){case 1:i=this.input.LT(1);if(!(this.input.LA(1)>=A&&this.input.LA(1)<=C||this.input.LA(1)>=N&&this.input.LA(1)<=_||this.input.LA(1)>=l&&this.input.LA(1)<=u||this.input.LA(1)==k||this.input.LA(1)==Y||this.input.LA(1)==T)){if(this.state.backtracking>0)return this.state.failed=!0,e;var L=new org.antlr.runtime.MismatchedSetException(null,this.input);throw L}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(n,this.adaptor.create(i)),this.state.errorRecovery=!1,this.state.failed=!1;if(this.state.backtracking===0&&this.bLocaleSensitive){var b=new websheet.parse.referenceToken(i?i.getText():null,i.getStartIndex());this.tokenList.push(b);if(this.bMS)if((i?i.getText():null)=="~")this.errTokenList.push(b);else if(this.inFunc===0)if((i?i.getText():null)==this.sepChar){var O=this.tokenList[this.tokenList.length-2];O&&(O._type=="range"||O._type=="cell"||O._type=="namerange"||O._type=="reffunct"&&websheet.functions.Util.getErrPropByName(O.getChangedText())&websheet.Constant.CellErrProp.RETURN_REF)&&b.setChangedText("~")}else if((i?i.getText():null)==","){if(!this.bAutoCorrect)throw"separator error!";b.setType(websheet.Constant.FormulaTokenType.ARG_SEP),b.setChangedText(this.sepChar),this.errTokenList.push(b)}}var M=2,D=this.input.LA(1);D==it&&(M=1);switch(M){case 1:o=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_expr512);if(this.state.failed)return e;this.state.backtracking===0&&(d=this.adaptor.create(o),this.adaptor.addChild(n,d))}}this.pushFollow(JsFormulaParserParser.FOLLOW_expr_in_expr525),f=this.expr(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,f.getTree());if(this.state.backtracking===0){if(!(i||r||this.inConstArray))throw"Error Syntax";e.value=f!==null?f.value:null;if(r&&!i&&!this.inConstArray){var P=this.tokenList.length,H=this.intersectionStack[this.intersectionStack.length-1];if(P>1&&this.bLocaleSensitive&&H){var B=this.tokenList[H];if(B&&B.getText().replace(/[ ]+/ig," ")==" "){var j=!1,O=this.tokenList[H-1];O&&(O._type=="range"||O._type=="cell"||O._type=="namerange"||O._type=="reffunct"&&websheet.functions.Util.getErrPropByName(O.getChangedText())&websheet.Constant.CellErrProp.RETURN_REF)&&(j=!0);var F=!1,I=this.tokenList[H+1];if(I&&I._text=="leftbrace"||I._text=="leftfuncbrace")I=this.tokenList[H+2];I&&(I._type=="range"||I._type=="cell"||I._type=="namerange"||I._type=="reffunct"&&websheet.functions.Util.getErrPropByName(I.getChangedText())&websheet.Constant.CellErrProp.RETURN_REF)&&(F=!0),j&&F?(B.setType(websheet.parse.tokenType.OPERATOR_TOKEN),B.setChangedText("!")):this.errTokenList.push(B)}}}}break;default:break t}}while(!0);this.state.backtracking===0&&r&&this.intersectionStack.pop(),e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(n),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(q){if(!(q instanceof org.antlr.runtime.RecognitionException))throw q;this.reportError(q),this.recover(this.input,q),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),q)}finally{this.state.backtracking>0&&this.memoize(this.input,2,t)}return e},atom_return:function(){JsFormulaParserParser.atom_return=function(){},org.antlr.lang.extend(JsFormulaParserParser.atom_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),atom:function(){var e=new JsFormulaParserParser.atom_return;e.start=this.input.LT(1);var n=this.input.index(),r=null,s=null,u=null,a=null,f=null,l=null,h=null,p=null,v=null,m=null,g=null,y=null,b=null,E=null,S=null,x=null,N=null,C=null,k=null,L=null,M=null,_=null,D=null,P=null,j=null,F=null,q=null,R=null,W=null,X=null,$=null,J=null,K=null,Q=null,G=null,Y=null,Z=null,tt=null,nt=null,rt=null,st=null,ot=null,ut=null,at=null,ft=null,lt=null,ct=null,ht=null,pt=null,dt=null,vt=null,mt=null,gt=null,yt=null,bt=null,wt=null,Et=null,St=null,xt=null,Tt=null,Nt=null,Ct=null;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,3))return e;var kt=9;kt=this.dfa37.predict(this.input);switch(kt){case 1:r=this.adaptor.nil(),D=this.match(this.input,I,JsFormulaParserParser.FOLLOW_MINUS_in_atom559);if(this.state.failed)return e;this.state.backtracking===0&&(wt=this.adaptor.create(D),this.adaptor.addChild(r,wt));var Lt=2,At=this.input.LA(1);At==it&&(Lt=1);switch(Lt){case 1:P=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom561);if(this.state.failed)return e;this.state.backtracking===0&&(Et=this.adaptor.create(P),this.adaptor.addChild(r,Et))}this.pushFollow(JsFormulaParserParser.FOLLOW_atom_in_atom567),X=this.atom(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,X.getTree()),this.state.backtracking===0;break;case 2:r=this.adaptor.nil(),j=this.match(this.input,d,JsFormulaParserParser.FOLLOW_PLUS_in_atom574);if(this.state.failed)return e;this.state.backtracking===0&&(St=this.adaptor.create(j),this.adaptor.addChild(r,St));var Ot=2,Mt=this.input.LA(1);Mt==it&&(Ot=1);switch(Ot){case 1:F=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom576);if(this.state.failed)return e;this.state.backtracking===0&&(xt=this.adaptor.create(F),this.adaptor.addChild(r,xt))}this.pushFollow(JsFormulaParserParser.FOLLOW_atom_in_atom582),X=this.atom(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,X.getTree()),this.state.backtracking===0;break;case 3:r=this.adaptor.nil();var _t=2,Dt=this.input.LA(1);if(Dt==B){var Pt=this.input.LA(2);Pt==V&&(_t=1)}else Dt==O&&(_t=1);switch(_t){case 1:s=this.input.LT(1);if(!(this.input.LA(1)>=O&&this.input.LA(1)<=B)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(s)),this.state.errorRecovery=!1,this.state.failed=!1,u=this.match(this.input,V,JsFormulaParserParser.FOLLOW_INTERSECT_ODS_in_atom610);if(this.state.failed)return e;this.state.backtracking===0&&(Y=this.adaptor.create(u),this.adaptor.addChild(r,Y));var Bt=2,jt=this.input.LA(1);jt==it&&(Bt=1);switch(Bt){case 1:a=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom615);if(this.state.failed)return e;this.state.backtracking===0&&(Z=this.adaptor.create(a),this.adaptor.addChild(r,Z))}}f=this.match(this.input,B,JsFormulaParserParser.FOLLOW_LOCALE_NUMBER_in_atom623);if(this.state.failed)return e;this.state.backtracking===0&&(tt=this.adaptor.create(f),this.adaptor.addChild(r,tt)),l=this.match(this.input,A,JsFormulaParserParser.FOLLOW_COLON_in_atom627);if(this.state.failed)return e;this.state.backtracking===0&&(nt=this.adaptor.create(l),this.adaptor.addChild(r,nt)),h=this.input.LT(1);if(!(this.input.LA(1)>=B&&this.input.LA(1)<=i)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(h)),this.state.errorRecovery=!1,this.state.failed=!1;if(this.state.backtracking===0&&!this.bNotParseRef){var Ft="",It="";if(s?s.getText():null){Ft+=s?s.getText():null,It+=s?s.getText():null,Ft+=u?u.getText():null,It+=u?u.getText():null;if(a?a.getText():null)It+=a?a.getText():null}Ft+=f.getText().trim(),It+=f.getText(),Ft+=l?l.getText():null,It+=l?l.getText():null,Ft+=(h?h.getText():null).trim(),It+=h?h.getText():null;var J=websheet.event.FormulaHelper.generateToken(Ft,this.bMS,this.bAutoCorrect,this.errTokenList);J&&((s?s.getText():null)?J.setIndex(s.getStartIndex()):J.setIndex(f.getStartIndex()),J.getType()==websheet.Constant.FormulaTokenType.SHEET_SEP?this.errTokenList.push(J):this.tokenList.push(J))}break;case 4:r=this.adaptor.nil(),f=this.input.LT(1);if(!(this.input.LA(1)>=O&&this.input.LA(1)<=B)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(f)),this.state.errorRecovery=!1,this.state.failed=!1;var qt=2,Rt=this.input.LA(1);Rt==V&&(qt=1);switch(qt){case 1:u=this.match(this.input,V,JsFormulaParserParser.FOLLOW_INTERSECT_ODS_in_atom685);if(this.state.failed)return e;this.state.backtracking===0&&(Y=this.adaptor.create(u),this.adaptor.addChild(r,Y));var Ut=2,zt=this.input.LA(1);zt==it&&(Ut=1);switch(Ut){case 1:a=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom690);if(this.state.failed)return e;this.state.backtracking===0&&(Z=this.adaptor.create(a),this.adaptor.addChild(r,Z))}p=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=et)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(p)),this.state.errorRecovery=!1,this.state.failed=!1;var Wt=2,Xt=this.input.LA(1);if(Xt==it){var Vt=this.input.LA(2);this.synpred42_JsFormulaParser()&&(Wt=1)}switch(Wt){case 1:v=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom705);if(this.state.failed)return e;this.state.backtracking===0&&(ot=this.adaptor.create(v),this.adaptor.addChild(r,ot))}}var $t=2;$t=this.dfa20.predict(this.input);switch($t){case 1:l=this.match(this.input,A,JsFormulaParserParser.FOLLOW_COLON_in_atom714);if(this.state.failed)return e;this.state.backtracking===0&&(nt=this.adaptor.create(l),this.adaptor.addChild(r,nt));var Jt=2,Kt=this.input.LA(1);if(Kt==it||Kt>=O&&Kt<=B)Jt=1;switch(Jt){case 1:var Qt=2,Gt=this.input.LA(1);Gt==it&&(Qt=1);switch(Qt){case 1:m=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom720);if(this.state.failed)return e;this.state.backtracking===0&&(ut=this.adaptor.create(m),this.adaptor.addChild(r,ut))}g=this.input.LT(1);if(!(this.input.LA(1)>=O&&this.input.LA(1)<=B)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(g)),this.state.errorRecovery=!1,this.state.failed=!1,y=this.match(this.input,V,JsFormulaParserParser.FOLLOW_INTERSECT_ODS_in_atom734);if(this.state.failed)return e;this.state.backtracking===0&&(ft=this.adaptor.create(y),this.adaptor.addChild(r,ft));var Yt=2,Zt=this.input.LA(1);Zt==it&&(Yt=1);switch(Yt){case 1:b=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom740);if(this.state.failed)return e;this.state.backtracking===0&&(lt=this.adaptor.create(b),this.adaptor.addChild(r,lt))}}h=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=et)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(h)),this.state.errorRecovery=!1,this.state.failed=!1}if(this.state.backtracking===0)if(!this.bNotParseRef&&(u?u.getText():null)){var Ft=f.getText(),It=Ft;if(u?u.getText():null){Ft+=u?u.getText():null,It+=u?u.getText():null;if(a?a.getText():null)It+=a?a.getText():null;Ft+=p?p.getText():null,It+=p?p.getText():null;if(v?v.getText():null)It+=v?v.getText():null}if(l?l.getText():null){Ft+=l?l.getText():null,It+=l?l.getText():null;if(m?m.getText():null)It+=m?m.getText():null;if(y?y.getText():null){Ft+=(g?g.getText():null).trim(),It+=g?g.getText():null,Ft+=y?y.getText():null,It+=y?y.getText():null;if(b?b.getText():null)It+=b?b.getText():null}Ft+=(h?h.getText():null).trim(),It+=h?h.getText():null}var J=websheet.event.FormulaHelper.generateToken(Ft,this.bMS,this.bAutoCorrect,this.errTokenList);J&&(J.getType()==websheet.Constant.FormulaTokenType.SHEET_SEP?(J.setIndex(u.getStartIndex()),this.errTokenList.push(J)):(J.setIndex(f.getStartIndex()),J.setTextOnly(It),this.tokenList.push(J)))}else if(this.bLocaleSensitive){var Ft=f.getText(),J=new websheet.parse.referenceToken(Ft,f.getStartIndex(),"number"),en=websheet.i18n.numberRecognizer.parse(J.getText(),!0);if(en.isNumber){if(en.formatType==websheet.Constant.FormatType["NUMBER"]||en.formatType==websheet.Constant.FormatType["PERCENT"]||en.formatType==websheet.Constant.FormatType["SCIENTIFIC"]){fValue=en.fValue;if(this.bMS){if(!this.group){var tn=dojo.i18n.getLocalization("dojo.cldr","number",this.locale);this.group=tn.group}if(Ft.indexOf(this.group)>-1)this.errTokenList.push(J);else{if(en.formatType==websheet.Constant.FormatType["NUMBER"]||en.formatType==websheet.Constant.FormatType["SCIENTIFIC"])J.setChangedText(fValue);else{var nn=en.percentageNum,rn=websheet.Math.mul(fValue,websheet.Math.pow(100,nn));for(var sn=0;sn<nn;sn++)rn+="%";J.setChangedText(rn)}this.tokenList.push(J)}}else en.formatType==websheet.Constant.FormatType["NUMBER"]||en.formatType==websheet.Constant.FormatType["SCIENTIFIC"]?J.setChangedText(fValue):J.setChangedText(websheet.Math.mul(fValue,100)+"%"),this.tokenList.push(J)}}else websheet.Helper.isNumeric(Ft)||websheet.Helper.isPercent(Ft)?this.inConstArray?this.tokenList.push(J):this.errTokenList.push(J):this.inConstArray&&this.tokenList.push(J)}break;case 5:r=this.adaptor.nil(),f=this.match(this.input,c,JsFormulaParserParser.FOLLOW_DOUBLEQUOT_STRING_in_atom764);if(this.state.failed)return e;this.state.backtracking===0&&(tt=this.adaptor.create(f),this.adaptor.addChild(r,tt)),this.state.backtracking===0;break;case 6:r=this.adaptor.nil(),E=this.match(this.input,z,JsFormulaParserParser.FOLLOW_P_OPEN_in_atom778);if(this.state.failed)return e;this.state.backtracking===0&&(ct=this.adaptor.create(E),this.adaptor.addChild(r,ct));if(this.state.backtracking===0&&this.bLocaleSensitive){var J=new websheet.parse.referenceToken("leftbrace",E.getStartIndex());this.tokenList.push(J)}var on=2,un=this.input.LA(1);un==it&&(on=1);switch(on){case 1:q=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom794);if(this.state.failed)return e;this.state.backtracking===0&&(Tt=this.adaptor.create(q),this.adaptor.addChild(r,Tt))}this.pushFollow(JsFormulaParserParser.FOLLOW_expr_in_atom803),K=this.expr(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,K.getTree());var an=2,fn=this.input.LA(1);fn==it&&(an=1);switch(an){case 1:R=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom810);if(this.state.failed)return e;this.state.backtracking===0&&(Nt=this.adaptor.create(R),this.adaptor.addChild(r,Nt))}S=this.match(this.input,w,JsFormulaParserParser.FOLLOW_P_CLOSE_in_atom817);if(this.state.failed)return e;this.state.backtracking===0&&(ht=this.adaptor.create(S),this.adaptor.addChild(r,ht));if(this.state.backtracking===0&&this.bLocaleSensitive){var ln=this.tokenList.length;if(ln>0){var cn=ln-1,hn=this.tokenList[cn];hn.getText().replace(/[ ]+/ig," ")==" "&&this.tokenList.pop()}if(ln>1){var pn=ln-2,dn=this.tokenList[pn],L;while(dn){L=pn>=0?dn.getText():null;if(L=="leftbrace"){this.tokenList.splice(pn,1);break}L=dn.getText().replace(/[ ]+/ig," ");if(L!=","||dn._changedText==";"){pn--,dn=this.tokenList[pn],L=pn>0?dn.getText():null;continue}dn.setType(websheet.parse.tokenType.OPERATOR_TOKEN),dn.setChangedText("~"),pn--,dn=this.tokenList[pn],L=pn>0?dn.getText():null}}}break;case 7:r=this.adaptor.nil(),this.pushFollow(JsFormulaParserParser.FOLLOW_folded_in_atom827),Q=this.folded(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,Q.getTree()),this.state.backtracking===0;break;case 8:r=this.adaptor.nil(),x=this.match(this.input,U,JsFormulaParserParser.FOLLOW_ARRAY_FORMULAR_START_in_atom839);if(this.state.failed)return e;this.state.backtracking===0&&(pt=this.adaptor.create(x),this.adaptor.addChild(r,pt));var vn=2,mn=this.input.LA(1);if(mn==it){var gn=this.input.LA(2);this.synpred56_JsFormulaParser()&&(vn=1)}switch(vn){case 1:N=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom844);if(this.state.failed)return e;this.state.backtracking===0&&(dt=this.adaptor.create(N),this.adaptor.addChild(r,dt))}if(this.state.backtracking===0){this.inConstArray++;var yn={};yn.firColLen=0,yn.colLen=0,yn.rowLen=0,yn.sepCount=0,yn.text="{",yn.changedText="{";if(N?N.getText():null)yn.text+=N?N.getText():null;var bn=this.tokenList.length}var wn=2,En=this.input.LA(1);if(En==d||En==I||En==z||En==U||En>=O&&En<=H)wn=1;switch(wn){case 1:this.pushFollow(JsFormulaParserParser.FOLLOW_atom_in_atom859),$=this.atom(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,$.getTree());if(this.state.backtracking===0)var Sn=this.input.getTokenSource(),xn=websheet.event.FormulaHelper.getArraySepByLocale(),Tn=websheet.event.FormulaHelper.isConstArray($,Sn,yn,xn);e:do{var Nn=2,Cn=this.input.LA(1);if(Cn==it){var kn=this.input.LA(2);if(kn==T||kn==56)Nn=1}else if(Cn==d||Cn==I||Cn==z||Cn==U||Cn>=T&&Cn<=H||Cn==56)Nn=1;switch(Nn){case 1:var Ln=2,An=this.input.LA(1);if(An>=it&&An<=T||An==56)Ln=1;switch(Ln){case 1:var On=2,Mn=this.input.LA(1);Mn==it&&(On=1);switch(On){case 1:a=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom873);if(this.state.failed)return e;this.state.backtracking===0&&(Z=this.adaptor.create(a),this.adaptor.addChild(r,Z))}C=this.input.LT(1);if(this.input.LA(1)!=T&&this.input.LA(1)!=56){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(C)),this.state.errorRecovery=!1,this.state.failed=!1;var _n=2,Dn=this.input.LA(1);Dn==it&&(_n=1);switch(_n){case 1:v=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom888);if(this.state.failed)return e;this.state.backtracking===0&&(ot=this.adaptor.create(v),this.adaptor.addChild(r,ot))}if(this.state.backtracking===0&&Tn){if(a?a.getText():null)yn.text+=a?a.getText():null,a=null;var Pn=C.getText();yn.text+=Pn;if(Pn==".")yn.rowLen==0?yn.firColLen++:yn.colLen++,yn.changedText+=";",(yn.sepCount=-1)?yn.sepCount=1:Tn=!1;else if(Pn==";"){(yn.sepCount=-1)?yn.sepCount=0:yn.sepCount&&(Tn=!1);if(yn.rowLen&&yn.colLen!=yn.firColLen)throw websheet.Constant.ERRORCODE[512];yn.colLen=0,yn.rowLen++,yn.changedText+="|"}else Tn=!1;if(v?v.getText():null)yn.text+=v?v.getText():null,v=null}}this.pushFollow(JsFormulaParserParser.FOLLOW_atom_in_atom905),J=this.atom(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,J.getTree()),this.state.backtracking===0&&Tn&&(Tn=websheet.event.FormulaHelper.isConstArray(J,Sn,yn,xn));break;default:break e}}while(!0)}var Hn=2,Bn=this.input.LA(1);Bn==it&&(Hn=1);switch(Hn){case 1:m=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom922);if(this.state.failed)return e;this.state.backtracking===0&&(ut=this.adaptor.create(m),this.adaptor.addChild(r,ut))}W=this.match(this.input,o,JsFormulaParserParser.FOLLOW_ARRAY_FORMULAR_END_in_atom926);if(this.state.failed)return e;this.state.backtracking===0&&(Ct=this.adaptor.create(W),this.adaptor.addChild(r,Ct));if(this.state.backtracking===0){var jn=this.tokenList.length;for(var sn=bn;sn<jn;sn++)this.tokenList.pop();if(m?m.getText():null)yn.text+=m?m.getText():null;this.inConstArray--;if(yn.rowLen&&yn.firColLen!=yn.colLen||yn.sepCount!=0&&yn.sepCount!=-1)Tn=!1;var Fn=x.getStartIndex();if(Tn){var J=new websheet.parse.referenceToken(yn.text,Fn);J.setChangedText(yn.changedText),J.setType(websheet.Constant.FormulaTokenType.ARG_SEP),this.tokenList.push(J)}else{var In=new websheet.parse.referenceToken("error constant",Fn);this.errTokenList.push(In)}}break;case 9:r=this.adaptor.nil(),k=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=et||this.input.LA(1)==t)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(k)),this.state.errorRecovery=!1,this.state.failed=!1;var qn=2,Rn=this.input.LA(1);Rn==V&&(qn=1);switch(qn){case 1:L=this.match(this.input,V,JsFormulaParserParser.FOLLOW_INTERSECT_ODS_in_atom980);if(this.state.failed)return e;this.state.backtracking===0&&(gt=this.adaptor.create(L),this.adaptor.addChild(r,gt));var Un=2,zn=this.input.LA(1);zn==it&&(Un=1);switch(Un){case 1:a=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom985);if(this.state.failed)return e;this.state.backtracking===0&&(Z=this.adaptor.create(a),this.adaptor.addChild(r,Z))}p=this.input.LT(1);if(!(this.input.LA(1)>=B&&this.input.LA(1)<=et)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(p)),this.state.errorRecovery=!1,this.state.failed=!1;var Wn=2,Xn=this.input.LA(1);if(Xn==it){var Vn=this.input.LA(2);this.synpred70_JsFormulaParser()&&(Wn=1)}switch(Wn){case 1:v=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom1002);if(this.state.failed)return e;this.state.backtracking===0&&(ot=this.adaptor.create(v),this.adaptor.addChild(r,ot))}}var $n=2;$n=this.dfa36.predict(this.input);switch($n){case 1:u=this.match(this.input,A,JsFormulaParserParser.FOLLOW_COLON_in_atom1012);if(this.state.failed)return e;this.state.backtracking===0&&(Y=this.adaptor.create(u),this.adaptor.addChild(r,Y));var Jn=2,Kn=this.input.LA(1);if(Kn==it||Kn==t)Jn=1;else if(Kn==i){var Qn=this.input.LA(2);Qn==V&&(Jn=1)}switch(Jn){case 1:var Gn=2,Yn=this.input.LA(1);Yn==it&&(Gn=1);switch(Gn){case 1:m=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom1018);if(this.state.failed)return e;this.state.backtracking===0&&(ut=this.adaptor.create(m),this.adaptor.addChild(r,ut))}M=this.input.LT(1);if(this.input.LA(1)!=i&&this.input.LA(1)!=t){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(M)),this.state.errorRecovery=!1,this.state.failed=!1,_=this.match(this.input,V,JsFormulaParserParser.FOLLOW_INTERSECT_ODS_in_atom1032);if(this.state.failed)return e;this.state.backtracking===0&&(bt=this.adaptor.create(_),this.adaptor.addChild(r,bt));var Zn=2,er=this.input.LA(1);er==it&&(Zn=1);switch(Zn){case 1:b=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom1037);if(this.state.failed)return e;this.state.backtracking===0&&(lt=this.adaptor.create(b),this.adaptor.addChild(r,lt))}}h=this.input.LT(1);if(!(this.input.LA(1)>=B&&this.input.LA(1)<=et)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(h)),this.state.errorRecovery=!1,this.state.failed=!1}if(this.state.backtracking===0)if(this.bMS&&!this.bNotParseRef){var Ft=k?k.getText():null,It=Ft;if(p?p.getText():null){Ft+="!",It+="!";if(a?a.getText():null)It+=a?a.getText():null;Ft+=p?p.getText():null,It+=p?p.getText():null;if(v?v.getText():null)It+=v?v.getText():null}if(u?u.getText():null){Ft+=u?u.getText():null,It+=u?u.getText():null;if(_?_.getText():null){if(m?m.getText():null)It+=m?m.getText():null;Ft+=M?M.getText():null,It+=M?M.getText():null,Ft+=_?_.getText():null,It+=_?_.getText():null;if(b?b.getText():null)It+=b?b.getText():null}Ft+=h?h.getText():null,It+=h?h.getText():null}var J=websheet.event.FormulaHelper.generateToken(Ft,this.bMS,this.bAutoCorrect,this.errTokenList);if(J)if(J.getType()==websheet.Constant.FormulaTokenType.SHEET_SEP){var cn=Ft.split(":")[0].lastIndexOf(J.getText());J.setIndex(k.getStartIndex()+cn),this.errTokenList.push(J)}else{var tr=k.getStartIndex();J.setTextOnly(It),J.setIndex(tr),this.tokenList.push(J)}}else{var Ft=k?k.getText():null,It=Ft,J,cn;this.bNotParseRef||(J=websheet.event.FormulaHelper.generateToken(k?k.getText():null,this.bMS,this.bAutoCorrect,this.errTokenList),J&&(J.setIndex(k.getStartIndex()),this.tokenList.push(J)));if(L?L.getText():null)this.bLocaleSensitive&&(J=new websheet.parse.referenceToken(L?L.getText():null,L.getStartIndex()),this.tokenList.push(J)),this.bNotParseRef||(J=websheet.event.FormulaHelper.generateToken(p?p.getText():null,this.bMS,this.bAutoCorrect,this.errTokenList),J&&(J.setIndex(p.getStartIndex()),this.tokenList.push(J)));if(u?u.getText():null){this.bNotParseRef||this.tokenList.pop(),(L?L.getText():null)?(Ft=p?p.getText():null,It=p?p.getText():null,cn=p.getStartIndex()):(Ft=k?k.getText():null,It=k?k.getText():null,cn=k.getStartIndex());if(v?v.getText():null)It+=v?v.getText():null;Ft+=u?u.getText():null,It+=u?u.getText():null;if(_?_.getText():null){if(m?m.getText():null)It+=m?m.getText():null;Ft+=M?M.getText():null,It+=M?M.getText():null,this.bNotParseRef||(J=websheet.event.FormulaHelper.generateToken(Ft,this.bMS,this.bAutoCorrect,this.errTokenList),J&&(J.setIndex(cn),J.setTextOnly(It),this.tokenList.push(J))),this.bLocaleSensitive&&(J=new websheet.parse.referenceToken(_?_.getText():null,_.getStartIndex()),this.tokenList.push(J))}else{if(b?b.getText():null)It+=b?b.getText():null;Ft+=h?h.getText():null,It+=h?h.getText():null,this.bNotParseRef||(J=websheet.event.FormulaHelper.generateToken(Ft,this.bMS,this.bAutoCorrect,this.errTokenList),J&&(J.setIndex(cn),J.setTextOnly(It),this.tokenList.push(J)))}}}}e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(r),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(nr){if(!(nr instanceof org.antlr.runtime.RecognitionException))throw nr;this.reportError(nr),this.recover(this.input,nr),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),nr)}finally{this.state.backtracking>0&&this.memoize(this.input,3,n)}return e},atom_list_return:function(){JsFormulaParserParser.atom_list_return=function(){},org.antlr.lang.extend(JsFormulaParserParser.atom_list_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),atom_list:function(){var e=new JsFormulaParserParser.atom_list_return;e.start=this.input.LT(1);var t=this.input.index(),n=null,r=null,i=null,s=null,o=null,u=null,a=null,f=null,l=null;try{
if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,4))return e;n=this.adaptor.nil(),this.pushFollow(JsFormulaParserParser.FOLLOW_atom_type_in_atom_list1073),o=this.atom_type(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,o.getTree()),this.state.backtracking===0;e:do{var c=2,h=this.input.LA(1);if(h==it){var p=this.input.LA(2);p==T&&(c=1)}else h==T&&(c=1);switch(c){case 1:var d=2,v=this.input.LA(1);v==it&&(d=1);switch(d){case 1:i=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom_list1081);if(this.state.failed)return e;this.state.backtracking===0&&(f=this.adaptor.create(i),this.adaptor.addChild(n,f))}r=this.match(this.input,T,JsFormulaParserParser.FOLLOW_ARG_SEP_in_atom_list1086);if(this.state.failed)return e;this.state.backtracking===0&&(a=this.adaptor.create(r),this.adaptor.addChild(n,a));var m=2,g=this.input.LA(1);if(g==it){var y=this.input.LA(2);this.synpred80_JsFormulaParser()&&(m=1)}switch(m){case 1:s=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom_list1088);if(this.state.failed)return e;this.state.backtracking===0&&(l=this.adaptor.create(s),this.adaptor.addChild(n,l))}if(this.state.backtracking===0&&this.bMS&&this.bLocaleSensitive){var b=new websheet.parse.referenceToken(r?r.getText():null,r.getStartIndex());this.tokenList.push(b)}this.pushFollow(JsFormulaParserParser.FOLLOW_atom_type_in_atom_list1095),u=this.atom_type(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,u.getTree()),this.state.backtracking===0;break;default:break e}}while(!0);e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(n),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(w){if(!(w instanceof org.antlr.runtime.RecognitionException))throw w;this.reportError(w),this.recover(this.input,w),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),w)}finally{this.state.backtracking>0&&this.memoize(this.input,4,t)}return e},atom_type_return:function(){JsFormulaParserParser.atom_type_return=function(){},org.antlr.lang.extend(JsFormulaParserParser.atom_type_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),atom_type:function(){var e=new JsFormulaParserParser.atom_type_return;e.start=this.input.LT(1);var t=this.input.index(),n=null,r=null,i=null,s=null,u=null,a=null,f=null,l=null,c=null,h=null,p=null;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,5))return e;var d=3;d=this.dfa43.predict(this.input);switch(d){case 1:n=this.adaptor.nil(),this.pushFollow(JsFormulaParserParser.FOLLOW_expr_in_atom_type1123),a=this.expr(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,a.getTree()),this.state.backtracking===0;break;case 2:n=this.adaptor.nil(),r=this.match(this.input,U,JsFormulaParserParser.FOLLOW_ARRAY_FORMULAR_START_in_atom_type1133);if(this.state.failed)return e;this.state.backtracking===0&&(l=this.adaptor.create(r),this.adaptor.addChild(n,l));var v=2,m=this.input.LA(1);if(m==it){var g=this.input.LA(2);this.synpred83_JsFormulaParser()&&(v=1)}switch(v){case 1:i=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom_type1135);if(this.state.failed)return e;this.state.backtracking===0&&(c=this.adaptor.create(i),this.adaptor.addChild(n,c))}this.pushFollow(JsFormulaParserParser.FOLLOW_atom_list_in_atom_type1141),f=this.atom_list(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,f.getTree());var y=2,b=this.input.LA(1);b==it&&(y=1);switch(y){case 1:s=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_atom_type1143);if(this.state.failed)return e;this.state.backtracking===0&&(h=this.adaptor.create(s),this.adaptor.addChild(n,h))}u=this.match(this.input,o,JsFormulaParserParser.FOLLOW_ARRAY_FORMULAR_END_in_atom_type1146);if(this.state.failed)return e;this.state.backtracking===0&&(p=this.adaptor.create(u),this.adaptor.addChild(n,p)),this.state.backtracking===0;break;case 3:n=this.adaptor.nil(),this.state.backtracking===0}e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(n),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(w){if(!(w instanceof org.antlr.runtime.RecognitionException))throw w;this.reportError(w),this.recover(this.input,w),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),w)}finally{this.state.backtracking>0&&this.memoize(this.input,5,t)}return e},folded_return:function(){JsFormulaParserParser.folded_return=function(){},org.antlr.lang.extend(JsFormulaParserParser.folded_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),folded:function(){var e=new JsFormulaParserParser.folded_return;e.start=this.input.LT(1);var n=this.input.index(),r=null,s=null,o=null,u=null,a=null,f=null,l=null,c=null,h=null,p=null,v=null,m=null,g=null,y=null,b=null,E=null;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,6))return e;var S=2,x=this.input.LA(1);if(x==H){var T=this.input.LA(2);if(T==d||T==I||T==z||T==U||T>=it&&T<=H)S=1;else{if(T!=w){if(this.state.backtracking>0)return this.state.failed=!0,e;var C=new org.antlr.runtime.NoViableAltException("",49,1,this.input);throw C}var N=this.input.LA(3);this.synpred90_JsFormulaParser()?S=1:S=2}}else{if(x!=i&&x!=t){if(this.state.backtracking>0)return this.state.failed=!0,e;var C=new org.antlr.runtime.NoViableAltException("",49,0,this.input);throw C}var k=this.input.LA(2);if(k==z){var L=this.input.LA(3);if(L==w){var N=this.input.LA(4);this.synpred90_JsFormulaParser()?S=1:S=2}else{if(!(L==d||L==I||L==z||L==U||L>=it&&L<=H)){if(this.state.backtracking>0)return this.state.failed=!0,e;var C=new org.antlr.runtime.NoViableAltException("",49,5,this.input);throw C}S=1}}else{if(k!=it){if(this.state.backtracking>0)return this.state.failed=!0,e;var C=new org.antlr.runtime.NoViableAltException("",49,2,this.input);throw C}S=2}}switch(S){case 1:r=this.adaptor.nil();var A=2,O=this.input.LA(1);if(O==H)A=1;else{if(O!=i&&O!=t){if(this.state.backtracking>0)return this.state.failed=!0,e;var C=new org.antlr.runtime.NoViableAltException("",44,0,this.input);throw C}A=2}switch(A){case 1:s=this.match(this.input,H,JsFormulaParserParser.FOLLOW_FUNC_in_folded1182);if(this.state.failed)return e;this.state.backtracking===0&&(p=this.adaptor.create(s),this.adaptor.addChild(r,p));break;case 2:s=this.input.LT(1);if(this.input.LA(1)!=i&&this.input.LA(1)!=t){if(this.state.backtracking>0)return this.state.failed=!0,e;var M=new org.antlr.runtime.MismatchedSetException(null,this.input);throw M}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(s)),this.state.errorRecovery=!1,this.state.failed=!1,o=this.match(this.input,z,JsFormulaParserParser.FOLLOW_P_OPEN_in_folded1200);if(this.state.failed)return e;this.state.backtracking===0&&(v=this.adaptor.create(o),this.adaptor.addChild(r,v))}if(this.state.backtracking===0){this.inFunc++;if(this.bLocaleSensitive){var _=s?s.getText():null,D,P;(o?o.getText():null)?(P=_.toUpperCase(),D=o.getStartIndex()):(P=_.substring(0,_.length-1).toUpperCase(),D=s.getStartIndex()+P.length);var B=new websheet.parse.referenceToken(P,s.getStartIndex(),"reffunct"),j=websheet.functions.FormulaTranslate.transFuncNameLocale2En(P);j||websheet.functions.FormulaTranslate.isSupportedFormula(P)&&(j=websheet.functions.FormulaTranslate.transFuncNameEn2Locale(P),j&&this.errTokenList&&this.errTokenList.push(B)),j&&B.setChangedText(j),this.tokenList.push(B);var B=new websheet.parse.referenceToken("leftfuncbrace",D);this.tokenList.push(B)}}var F=2,q=this.input.LA(1);if(q==it){var R=this.input.LA(2);this.synpred88_JsFormulaParser()&&(F=1)}switch(F){case 1:a=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_folded1215);if(this.state.failed)return e;this.state.backtracking===0&&(g=this.adaptor.create(a),this.adaptor.addChild(r,g))}this.pushFollow(JsFormulaParserParser.FOLLOW_range_in_folded1223),h=this.range(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,h.getTree());var W=2,X=this.input.LA(1);X==it&&(W=1);switch(W){case 1:f=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_folded1231);if(this.state.failed)return e;this.state.backtracking===0&&(y=this.adaptor.create(f),this.adaptor.addChild(r,y))}u=this.match(this.input,w,JsFormulaParserParser.FOLLOW_P_CLOSE_in_folded1242);if(this.state.failed)return e;this.state.backtracking===0&&(m=this.adaptor.create(u),this.adaptor.addChild(r,m));if(this.state.backtracking===0){this.inFunc--;if(this.bLocaleSensitive){var V=this.tokenList.length;if(V>1){var $=V-1,J=this.tokenList[$],K;while(J){K=$>=0?J.getText():null;if(K=="leftfuncbrace"){this.tokenList.splice($,1);break}if(K!=","&&K!=";"||J._changedText=="~"){$--,J=this.tokenList[$],K=$>=0?J.getText():null;continue}if(this.bMS){J.setType(websheet.Constant.FormulaTokenType.ARG_SEP);if(K==this.sepChar)this.bSepToken&&J.setChangedText(websheet.Constant.TokenStr.ODF.ARG_SEP);else{if(!this.bAutoCorrect)throw"separator error!";J.setChangedText(this.sepChar),this.errTokenList.push(J)}}$--,J=this.tokenList[$],K=$>0?J.getText():null}}}}break;case 2:r=this.adaptor.nil();var Q=2,G=this.input.LA(1);if(G==H)Q=1;else{if(G!=i&&G!=t){if(this.state.backtracking>0)return this.state.failed=!0,e;var C=new org.antlr.runtime.NoViableAltException("",48,0,this.input);throw C}Q=2}switch(Q){case 1:s=this.match(this.input,H,JsFormulaParserParser.FOLLOW_FUNC_in_folded1256);if(this.state.failed)return e;this.state.backtracking===0&&(p=this.adaptor.create(s),this.adaptor.addChild(r,p));break;case 2:s=this.input.LT(1);if(this.input.LA(1)!=i&&this.input.LA(1)!=t){if(this.state.backtracking>0)return this.state.failed=!0,e;var M=new org.antlr.runtime.MismatchedSetException(null,this.input);throw M}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(s)),this.state.errorRecovery=!1,this.state.failed=!1;var Y=2,Z=this.input.LA(1);Z==it&&(Y=1);switch(Y){case 1:l=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_folded1270);if(this.state.failed)return e;this.state.backtracking===0&&(b=this.adaptor.create(l),this.adaptor.addChild(r,b))}o=this.match(this.input,z,JsFormulaParserParser.FOLLOW_P_OPEN_in_folded1275);if(this.state.failed)return e;this.state.backtracking===0&&(v=this.adaptor.create(o),this.adaptor.addChild(r,v))}if(this.state.backtracking===0&&this.bLocaleSensitive){var _=s?s.getText():null,P;(o?o.getText():null)?P=_.toUpperCase():P=_.substring(0,_.length-1).toUpperCase();var B=new websheet.parse.referenceToken(P,s.getStartIndex(),"reffunct"),j=websheet.functions.FormulaTranslate.transFuncNameLocale2En(P);j||websheet.functions.FormulaTranslate.isSupportedFormula(P)&&(j=websheet.functions.FormulaTranslate.transFuncNameEn2Locale(P),j&&this.errTokenList&&this.errTokenList.push(B)),j&&B.setChangedText(j),this.tokenList.push(B)}c=this.match(this.input,w,JsFormulaParserParser.FOLLOW_P_CLOSE_in_folded1280);if(this.state.failed)return e;this.state.backtracking===0&&(E=this.adaptor.create(c),this.adaptor.addChild(r,E)),this.state.backtracking===0}e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(r),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(et){if(!(et instanceof org.antlr.runtime.RecognitionException))throw et;this.reportError(et),this.recover(this.input,et),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),et)}finally{this.state.backtracking>0&&this.memoize(this.input,6,n)}return e},range_return:function(){JsFormulaParserParser.range_return=function(){},org.antlr.lang.extend(JsFormulaParserParser.range_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),range:function(){var e=new JsFormulaParserParser.range_return;e.start=this.input.LT(1);var t=this.input.index(),n=null,r=null,i=null;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,7))return e;var s=2;s=this.dfa50.predict(this.input);switch(s){case 1:n=this.adaptor.nil(),this.pushFollow(JsFormulaParserParser.FOLLOW_atom_list_in_range1303),r=this.atom_list(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,r.getTree()),this.state.backtracking===0;break;case 2:n=this.adaptor.nil(),this.pushFollow(JsFormulaParserParser.FOLLOW_folded_in_range1314),i=this.folded(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,i.getTree()),this.state.backtracking===0}e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(n),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(o){if(!(o instanceof org.antlr.runtime.RecognitionException))throw o;this.reportError(o),this.recover(this.input,o),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),o)}finally{this.state.backtracking>0&&this.memoize(this.input,7,t)}return e},synpred5_JsFormulaParser_fragment:function(){sp=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred5_JsFormulaParser417);if(this.state.failed)return},synpred28_JsFormulaParser_fragment:function(){m=this.input.LT(1);if(!(this.input.LA(1)>=A&&this.input.LA(1)<=C||this.input.LA(1)>=N&&this.input.LA(1)<=_||this.input.LA(1)>=l&&this.input.LA(1)<=u||this.input.LA(1)==k||this.input.LA(1)==Y||this.input.LA(1)==T)){if(this.state.backtracking>0){this.state.failed=!0;return}var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw e}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;var t=2,n=this.input.LA(1);n==it&&(t=1);switch(t){case 1:this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred28_JsFormulaParser512);if(this.state.failed)return}},synpred29_JsFormulaParser_fragment:function(){var e=2;e=this.dfa55.predict(this.input);switch(e){case 1:m=this.input.LT(1);if(!(this.input.LA(1)>=A&&this.input.LA(1)<=C||this.input.LA(1)>=N&&this.input.LA(1)<=_||this.input.LA(1)>=l&&this.input.LA(1)<=u||this.input.LA(1)==k||this.input.LA(1)==Y||this.input.LA(1)==T)){if(this.state.backtracking>0){this.state.failed=!0;return}var t=new org.antlr.runtime.MismatchedSetException(null,this.input);throw t}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;var n=2,r=this.input.LA(1);r==it&&(n=1);switch(n){case 1:this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred29_JsFormulaParser512);if(this.state.failed)return}}this.pushFollow(JsFormulaParserParser.FOLLOW_expr_in_synpred29_JsFormulaParser525),b=this.expr(),this.state._fsp--;if(this.state.failed)return},synpred38_JsFormulaParser_fragment:function(){var e=2,t=this.input.LA(1);if(t==B){var n=this.input.LA(2);n==V&&(e=1)}else t==O&&(e=1);switch(e){case 1:sn=this.input.LT(1);if(!(this.input.LA(1)>=O&&this.input.LA(1)<=B)){if(this.state.backtracking>0){this.state.failed=!0;return}var r=new org.antlr.runtime.MismatchedSetException(null,this.input);throw r}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1,m=this.match(this.input,V,JsFormulaParserParser.FOLLOW_INTERSECT_ODS_in_synpred38_JsFormulaParser610);if(this.state.failed)return;var s=2,o=this.input.LA(1);o==it&&(s=1);switch(s){case 1:wp2=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred38_JsFormulaParser615);if(this.state.failed)return}}x=this.match(this.input,B,JsFormulaParserParser.FOLLOW_LOCALE_NUMBER_in_synpred38_JsFormulaParser623);if(this.state.failed)return;em=this.match(this.input,A,JsFormulaParserParser.FOLLOW_COLON_in_synpred38_JsFormulaParser627);if(this.state.failed)return;endName=this.input.LT(1);if(!(this.input.LA(1)>=B&&this.input.LA(1)<=i)){if(this.state.backtracking>0){this.state.failed=!0;return}var r=new org.antlr.runtime.MismatchedSetException(null,this.input);throw r}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1},synpred42_JsFormulaParser_fragment:function(){wp3=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred42_JsFormulaParser705);if(this.state.failed)return},synpred49_JsFormulaParser_fragment:function(){em=this.match(this.input,A,JsFormulaParserParser.FOLLOW_COLON_in_synpred49_JsFormulaParser714);if(this.state.failed)return;var e=2,t=this.input.LA(1);if(t==it||t>=O&&t<=B)e=1;switch(e){case 1:var n=2,r=this.input.LA(1);r==it&&(n=1);switch(n){case 1:wp4=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred49_JsFormulaParser720);if(this.state.failed)return}x2=this.input.LT(1);if(!(this.input.LA(1)>=O&&this.input.LA(1)<=B)){if(this.state.backtracking>0){this.state.failed=!0;return}var s=new org.antlr.runtime.MismatchedSetException(null,this.input);throw s}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1,m2=this.match(this.input,V,JsFormulaParserParser.FOLLOW_INTERSECT_ODS_in_synpred49_JsFormulaParser734);if(this.state.failed)return;var o=2,u=this.input.LA(1);u==it&&(o=1);switch(o){case 1:wp6=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred49_JsFormulaParser740);if(this.state.failed)return}}endName=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=et)){if(this.state.backtracking>0){this.state.failed=!0;return}var s=new org.antlr.runtime.MismatchedSetException(null,this.input);throw s}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1},synpred50_JsFormulaParser_fragment:function(){x=this.input.LT(1);if(!(this.input.LA(1)>=O&&this.input.LA(1)<=B)){if(this.state.backtracking>0){this.state.failed=!0;return}var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw e}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;var t=2,n=this.input.LA(1);n==V&&(t=1);switch(t){case 1:m=this.match(this.input,V,JsFormulaParserParser.FOLLOW_INTERSECT_ODS_in_synpred50_JsFormulaParser685);if(this.state.failed)return;var r=2,s=this.input.LA(1);s==it&&(r=1);switch(r){case 1:wp2=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred50_JsFormulaParser690);if(this.state.failed)return}ename=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=et)){if(this.state.backtracking>0){this.state.failed=!0;return}var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw e}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;var o=2,u=this.input.LA(1);u==it&&(o=1);switch(o){case 1:wp3=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred50_JsFormulaParser705);if(this.state.failed)return}}var a=2,f=this.input.LA(1);f==A&&(a=1);switch(a){case 1:em=this.match(this.input,A,JsFormulaParserParser.FOLLOW_COLON_in_synpred50_JsFormulaParser714);if(this.state.failed)return;var l=2,c=this.input.LA(1);if(c==it||c>=O&&c<=B)l=1;switch(l){case 1:var h=2,p=this.input.LA(1);p==it&&(h=1);switch(h){case 1:wp4=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred50_JsFormulaParser720);if(this.state.failed)return}x2=this.input.LT(1);if(!(this.input.LA(1)>=O&&this.input.LA(1)<=B)){if(this.state.backtracking>0){this.state.failed=!0;return}var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw e}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1,m2=this.match(this.input,V,JsFormulaParserParser.FOLLOW_INTERSECT_ODS_in_synpred50_JsFormulaParser734);if(this.state.failed)return;var d=2,v=this.input.LA(1);v==it&&(d=1);switch(d){case 1:wp6=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred50_JsFormulaParser740);if(this.state.failed)return}}endName=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=et)){if(this.state.backtracking>0){this.state.failed=!0;return}var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw e}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1}},synpred55_JsFormulaParser_fragment:function(){this.pushFollow(JsFormulaParserParser.FOLLOW_folded_in_synpred55_JsFormulaParser827),this.folded(),this.state._fsp--;if(this.state.failed)return},synpred56_JsFormulaParser_fragment:function(){wp1=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred56_JsFormulaParser844);if(this.state.failed)return},synpred70_JsFormulaParser_fragment:function(){wp3=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred70_JsFormulaParser1002);if(this.state.failed)return},synpred78_JsFormulaParser_fragment:function(){m=this.match(this.input,A,JsFormulaParserParser.FOLLOW_COLON_in_synpred78_JsFormulaParser1012);if(this.state.failed)return;var e=2,n=this.input.LA(1);if(n==it||n==t)e=1;else if(n==i){var r=this.input.LA(2);r==V&&(e=1)}switch(e){case 1:var s=2,o=this.input.LA(1);o==it&&(s=1);switch(s){case 1:wp4=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred78_JsFormulaParser1018);if(this.state.failed)return}name2=this.input.LT(1);if(this.input.LA(1)!=i&&this.input.LA(1)!=t){if(this.state.backtracking>0){this.state.failed=!0;return}var u=new org.antlr.runtime.MismatchedSetException(null,this.input);throw u}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1,op2=this.match(this.input,V,JsFormulaParserParser.FOLLOW_INTERSECT_ODS_in_synpred78_JsFormulaParser1032);if(this.state.failed)return;var a=2,f=this.input.LA(1);f==it&&(a=1);switch(a){case 1:wp6=this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred78_JsFormulaParser1037);if(this.state.failed)return}}endName=this.input.LT(1);if(!(this.input.LA(1)>=B&&this.input.LA(1)<=et)){if(this.state.backtracking>0){this.state.failed=!0;return}var u=new org.antlr.runtime.MismatchedSetException(null,this.input);throw u}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1},synpred80_JsFormulaParser_fragment:function(){this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred80_JsFormulaParser1088);if(this.state.failed)return},synpred82_JsFormulaParser_fragment:function(){this.pushFollow(JsFormulaParserParser.FOLLOW_expr_in_synpred82_JsFormulaParser1123),a=this.expr(),this.state._fsp--;if(this.state.failed)return},synpred83_JsFormulaParser_fragment:function(){this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred83_JsFormulaParser1135);if(this.state.failed)return},synpred85_JsFormulaParser_fragment:function(){this.match(this.input,U,JsFormulaParserParser.FOLLOW_ARRAY_FORMULAR_START_in_synpred85_JsFormulaParser1133);if(this.state.failed)return;var e=2,t=this.input.LA(1);if(t==it){var n=this.input.LA(2);this.synpred83_JsFormulaParser()&&(e=1)}switch(e){case 1:this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred85_JsFormulaParser1135);if(this.state.failed)return}this.pushFollow(JsFormulaParserParser.FOLLOW_atom_list_in_synpred85_JsFormulaParser1141),b=this.atom_list(),this.state._fsp--;if(this.state.failed)return;var r=2,i=this.input.LA(1);i==it&&(r=1);switch(r){case 1:this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred85_JsFormulaParser1143);if(this.state.failed)return}this.match(this.input,o,JsFormulaParserParser.FOLLOW_ARRAY_FORMULAR_END_in_synpred85_JsFormulaParser1146);if(this.state.failed)return},synpred88_JsFormulaParser_fragment:function(){this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred88_JsFormulaParser1215);if(this.state.failed)return},synpred90_JsFormulaParser_fragment:function(){var e=2,n=this.input.LA(1);if(n==H)e=1;else{if(n!=i&&n!=t){if(this.state.backtracking>0){this.state.failed=!0;return}var r=new org.antlr.runtime.NoViableAltException("",104,0,this.input);throw r}e=2}switch(e){case 1:f=this.match(this.input,H,JsFormulaParserParser.FOLLOW_FUNC_in_synpred90_JsFormulaParser1182);if(this.state.failed)return;break;case 2:f=this.input.LT(1);if(this.input.LA(1)!=i&&this.input.LA(1)!=t){if(this.state.backtracking>0){this.state.failed=!0;return}var s=new org.antlr.runtime.MismatchedSetException(null,this.input);throw s}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1,b=this.match(this.input,z,JsFormulaParserParser.FOLLOW_P_OPEN_in_synpred90_JsFormulaParser1200);if(this.state.failed)return}var o=2,u=this.input.LA(1);if(u==it){var a=this.input.LA(2);this.synpred88_JsFormulaParser()&&(o=1)}switch(o){case 1:this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred90_JsFormulaParser1215);if(this.state.failed)return}this.pushFollow(JsFormulaParserParser.FOLLOW_range_in_synpred90_JsFormulaParser1223),this.range(),this.state._fsp--;if(this.state.failed)return;var l=2,c=this.input.LA(1);c==it&&(l=1);switch(l){case 1:this.match(this.input,it,JsFormulaParserParser.FOLLOW_INTERSECT_in_synpred90_JsFormulaParser1231);if(this.state.failed)return}rBrace=this.match(this.input,w,JsFormulaParserParser.FOLLOW_P_CLOSE_in_synpred90_JsFormulaParser1242);if(this.state.failed)return},synpred94_JsFormulaParser_fragment:function(){this.pushFollow(JsFormulaParserParser.FOLLOW_atom_list_in_synpred94_JsFormulaParser1303),params=this.atom_list(),this.state._fsp--;if(this.state.failed)return},synpred82_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred82_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred94_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred94_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred50_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred50_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred83_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred83_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred85_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred85_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred42_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred42_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred88_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred88_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred55_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred55_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred56_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred56_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred78_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred78_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred5_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred5_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred49_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred49_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred38_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred38_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred28_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred28_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred29_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred29_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred90_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred90_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred80_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred80_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred70_JsFormulaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred70_JsFormulaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n}},!0),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA9_eotS:"\uffff",DFA9_eofS:"\uffff",DFA9_minS:"\uffff\n\0\uffff\0\uffff\0\uffff",DFA9_maxS:"(\uffff\n\0\uffff\0\uffff\0\uffff",DFA9_acceptS:"\uffff\uffff",DFA9_specialS:"\uffff\0\b	\uffff\n\uffff\uffff}>",DFA9_transitionS:["\uffff\uffff\uffff\n\r		\b","","\uffff","\uffff","\uffff","\uffff","\uffff","\uffff","\uffff","\uffff","\uffff","\uffff","","\uffff","","","\uffff",""]}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA9_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA9_eotS),DFA9_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA9_eofS),DFA9_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA9_minS),DFA9_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA9_maxS),DFA9_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA9_acceptS),DFA9_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA9_specialS),DFA9_transition:function(){var e=[],t,n=JsFormulaParserParser.DFA9_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA9_transitionS[t]));return e}()}),JsFormulaParserParser.DFA9=function(e){this.recognizer=e,this.decisionNumber=9,this.eot=JsFormulaParserParser.DFA9_eot,this.eof=JsFormulaParserParser.DFA9_eof,this.min=JsFormulaParserParser.DFA9_min,this.max=JsFormulaParserParser.DFA9_max,this.accept=JsFormulaParserParser.DFA9_accept,this.special=JsFormulaParserParser.DFA9_special,this.transition=JsFormulaParserParser.DFA9_transition},org.antlr.lang.extend(JsFormulaParserParser.DFA9,org.antlr.runtime.DFA,{getDescription:function(){return"()* loopback of 98:3: ( (m= ( LESS | GREATER | LESSEQUAL | GREATEREQUAL | MODEQUAL | MULTEEQUAL | MINUSEQUAL | PLUSEQUAL | DIVEQUAL | NOTEQUAL | NOTEQUAL2 | EQUAL | AND | MINUS | PLUS | MULT | DIV | COLON | POW | ARG_SEP | CONCATENATION ) ( INTERSECT )? )? b= expr )*"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(s);if(e>=0)return e;break;case 2:var o=t.LA(1),u=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(
u);if(e>=0)return e;break;case 3:var a=t.LA(1),f=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(f);if(e>=0)return e;break;case 4:var l=t.LA(1),c=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(c);if(e>=0)return e;break;case 5:var h=t.LA(1),p=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(p);if(e>=0)return e;break;case 6:var d=t.LA(1),v=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(v);if(e>=0)return e;break;case 7:var m=t.LA(1),g=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(g);if(e>=0)return e;break;case 8:var y=t.LA(1),b=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(b);if(e>=0)return e;break;case 9:var w=t.LA(1),E=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(E);if(e>=0)return e;break;case 10:var S=t.LA(1),x=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(x);if(e>=0)return e;break;case 11:var T=t.LA(1),N=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaParser()?e=17:e=1,t.seek(N);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),9,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA8_eotS:"\f\uffff",DFA8_eofS:"\f\uffff",DFA8_minS:"\0	\uffff",DFA8_maxS:"(\0	\uffff",DFA8_acceptS:"\uffff\uffff",DFA8_specialS:"\uffff\0	\uffff}>",DFA8_transitionS:["\uffff\uffff\uffff\uffff\uffff","\uffff","\uffff","","","","","","","","",""]}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA8_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA8_eotS),DFA8_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA8_eofS),DFA8_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA8_minS),DFA8_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA8_maxS),DFA8_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA8_acceptS),DFA8_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA8_specialS),DFA8_transition:function(){var e=[],t,n=JsFormulaParserParser.DFA8_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA8_transitionS[t]));return e}()}),JsFormulaParserParser.DFA8=function(e){this.recognizer=e,this.decisionNumber=8,this.eot=JsFormulaParserParser.DFA8_eot,this.eof=JsFormulaParserParser.DFA8_eof,this.min=JsFormulaParserParser.DFA8_min,this.max=JsFormulaParserParser.DFA8_max,this.accept=JsFormulaParserParser.DFA8_accept,this.special=JsFormulaParserParser.DFA8_special,this.transition=JsFormulaParserParser.DFA8_transition},org.antlr.lang.extend(JsFormulaParserParser.DFA8,org.antlr.runtime.DFA,{getDescription:function(){return"98:4: (m= ( LESS | GREATER | LESSEQUAL | GREATEREQUAL | MODEQUAL | MULTEEQUAL | MINUSEQUAL | PLUSEQUAL | DIVEQUAL | NOTEQUAL | NOTEQUAL2 | EQUAL | AND | MINUS | PLUS | MULT | DIV | COLON | POW | ARG_SEP | CONCATENATION ) ( INTERSECT )? )?"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred28_JsFormulaParser()?e=3:e=4,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred28_JsFormulaParser()?e=3:e=4,t.seek(s);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),8,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA37_eotS:"\r\uffff",DFA37_eofS:"\r\uffff",DFA37_minS:"\b\uffff\0\uffff\0\uffff",DFA37_maxS:"(\uffff\0\uffff\0\uffff",DFA37_acceptS:"\uffff\uffff\uffff\b	",DFA37_specialS:"\uffff\0\uffff\uffff}>",DFA37_transitionS:["\uffff\uffff\r\uffff	\uffff\b\n\b","","","\uffff","\uffff","","","","\uffff","","","",""]}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA37_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA37_eotS),DFA37_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA37_eofS),DFA37_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA37_minS),DFA37_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA37_maxS),DFA37_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA37_acceptS),DFA37_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA37_specialS),DFA37_transition:function(){var e=[],t,n=JsFormulaParserParser.DFA37_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA37_transitionS[t]));return e}()}),JsFormulaParserParser.DFA37=function(e){this.recognizer=e,this.decisionNumber=37,this.eot=JsFormulaParserParser.DFA37_eot,this.eof=JsFormulaParserParser.DFA37_eof,this.min=JsFormulaParserParser.DFA37_min,this.max=JsFormulaParserParser.DFA37_max,this.accept=JsFormulaParserParser.DFA37_accept,this.special=JsFormulaParserParser.DFA37_special,this.transition=JsFormulaParserParser.DFA37_transition},org.antlr.lang.extend(JsFormulaParserParser.DFA37,org.antlr.runtime.DFA,{getDescription:function(){return"186:1: atom returns [String value] : ( '-' ( INTERSECT )? (b= atom ) | '+' ( INTERSECT )? (b= atom ) | (sn= ( SINGLEQUOT_STRING | LOCALE_NUMBER ) m= INTERSECT_ODS (wp2= INTERSECT )? )? x= LOCALE_NUMBER em= COLON endName= ( NAME | LOCALE_NUMBER ) | x= ( SINGLEQUOT_STRING | LOCALE_NUMBER ) (m= INTERSECT_ODS (wp2= INTERSECT )? ename= ( ERRORNAME | NAME ) (wp3= INTERSECT )? )? (em= COLON ( (wp4= INTERSECT )? x2= ( SINGLEQUOT_STRING | LOCALE_NUMBER ) m2= INTERSECT_ODS (wp6= INTERSECT )? )? endName= ( ERRORNAME | NAME ) )? | x= DOUBLEQUOT_STRING | (brace= P_OPEN ) ( ( INTERSECT )? expr ( INTERSECT )? ebrace= P_CLOSE ) | folded | (a= ARRAY_FORMULAR_START (wp1= INTERSECT )? ) ( (firToken= atom ) ( ( ( (wp2= INTERSECT )? sep= ( '.' | ARG_SEP ) (wp3= INTERSECT )? ) )? (token= atom ) )* )? ( (wp4= INTERSECT )? ARRAY_FORMULAR_END ) | name1= ( ERRORNAME | NAME | NAME1 ) (op= INTERSECT_ODS (wp2= INTERSECT )? ename= ( ERRORNAME | NAME | LOCALE_NUMBER ) (wp3= INTERSECT )? )? (m= COLON ( (wp4= INTERSECT )? name2= ( NAME | NAME1 ) op2= INTERSECT_ODS (wp6= INTERSECT )? )? endName= ( ERRORNAME | NAME | LOCALE_NUMBER ) )? );"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred38_JsFormulaParser()?e=11:this.synpred50_JsFormulaParser()&&(e=12),t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred38_JsFormulaParser()?e=11:this.synpred50_JsFormulaParser()&&(e=12),t.seek(s);if(e>=0)return e;break;case 2:var o=t.LA(1),u=t.index();t.rewind(),e=-1,this.synpred55_JsFormulaParser()?e=7:e=10,t.seek(u);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),37,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA20_eotS:"\f\uffff",DFA20_eofS:"\uffff\uffff",DFA20_minS:"\b\uffff\b\0 \uffff#\0",DFA20_maxS:"8(\uffff(\0%\uffff%\0",DFA20_acceptS:"\uffff\uffff\uffff",DFA20_specialS:"\uffff\0\uffff}>",DFA20_transitionS:["\uffff\uffff\uffff","\uffff\uffff\r\uffff\uffff\uffff","","\uffff\uffff\r\uffff\uffff","\b\uffff","\b\uffff","\uffff","\uffff","\n\uffff","","","\uffff"]}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA20_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA20_eotS),DFA20_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA20_eofS),DFA20_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA20_minS),DFA20_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA20_maxS),DFA20_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA20_acceptS),DFA20_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA20_specialS),DFA20_transition:function(){var e=[],t,n=JsFormulaParserParser.DFA20_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA20_transitionS[t]));return e}()}),JsFormulaParserParser.DFA20=function(e){this.recognizer=e,this.decisionNumber=20,this.eot=JsFormulaParserParser.DFA20_eot,this.eof=JsFormulaParserParser.DFA20_eof,this.min=JsFormulaParserParser.DFA20_min,this.max=JsFormulaParserParser.DFA20_max,this.accept=JsFormulaParserParser.DFA20_accept,this.special=JsFormulaParserParser.DFA20_special,this.transition=JsFormulaParserParser.DFA20_transition},org.antlr.lang.extend(JsFormulaParserParser.DFA20,org.antlr.runtime.DFA,{getDescription:function(){return"245:120: (em= COLON ( (wp4= INTERSECT )? x2= ( SINGLEQUOT_STRING | LOCALE_NUMBER ) m2= INTERSECT_ODS (wp6= INTERSECT )? )? endName= ( ERRORNAME | NAME ) )?"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred49_JsFormulaParser()?e=9:e=2,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred49_JsFormulaParser()?e=9:e=2,t.seek(s);if(e>=0)return e;break;case 2:var o=t.LA(1),u=t.index();t.rewind(),e=-1,this.synpred49_JsFormulaParser()?e=9:e=2,t.seek(u);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),20,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA36_eotS:"\f\uffff",DFA36_eofS:"\uffff\uffff",DFA36_minS:"\b\uffff\b\0\0\uffff #\0",DFA36_maxS:"8(\uffff(\0(\0\uffff%\0",DFA36_acceptS:"\uffff\uffff\uffff",DFA36_specialS:"\uffff\uffff\0\uffff}>",DFA36_transitionS:["\uffff\uffff\uffff","\uffff\uffff\r\uffff\uffff\uffff","","\uffff\uffff\r\uffff\uffff","\uffff","	\uffff","\uffff","\uffff","","\n\uffff","","\uffff"]}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA36_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA36_eotS),DFA36_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA36_eofS),DFA36_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA36_minS),DFA36_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA36_maxS),DFA36_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA36_acceptS),DFA36_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA36_specialS),DFA36_transition:function(){var e=[],t,n=JsFormulaParserParser.DFA36_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA36_transitionS[t]));return e}()}),JsFormulaParserParser.DFA36=function(e){this.recognizer=e,this.decisionNumber=36,this.eot=JsFormulaParserParser.DFA36_eot,this.eof=JsFormulaParserParser.DFA36_eof,this.min=JsFormulaParserParser.DFA36_min,this.max=JsFormulaParserParser.DFA36_max,this.accept=JsFormulaParserParser.DFA36_accept,this.special=JsFormulaParserParser.DFA36_special,this.transition=JsFormulaParserParser.DFA36_transition},org.antlr.lang.extend(JsFormulaParserParser.DFA36,org.antlr.runtime.DFA,{getDescription:function(){return"513:126: (m= COLON ( (wp4= INTERSECT )? name2= ( NAME | NAME1 ) op2= INTERSECT_ODS (wp6= INTERSECT )? )? endName= ( ERRORNAME | NAME | LOCALE_NUMBER ) )?"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred78_JsFormulaParser()?e=8:e=2,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred78_JsFormulaParser()?e=8:e=2,t.seek(s);if(e>=0)return e;break;case 2:var o=t.LA(1),u=t.index();t.rewind(),e=-1,this.synpred78_JsFormulaParser()?e=8:e=2,t.seek(u);if(e>=0)return e;break;case 3:var a=t.LA(1),f=t.index();t.rewind(),e=-1,this.synpred78_JsFormulaParser()?e=8:e=2,t.seek(f);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),36,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA43_eotS:"\uffff",DFA43_eofS:"\uffff",DFA43_minS:"\b\b\uffff\0\uffff",DFA43_maxS:"(\b\uffff\0\uffff",DFA43_acceptS:"\uffff	\uffff\uffff",DFA43_specialS:"	\uffff\0\uffff}>",DFA43_transitionS:["\uffff\uffff\f\uffff	","","","","","","","","","\uffff","","","","","","",""]}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA43_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA43_eotS),DFA43_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA43_eofS),DFA43_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA43_minS),DFA43_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA43_maxS),DFA43_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA43_acceptS),DFA43_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA43_specialS),DFA43_transition:function(){var e=[],t,n=JsFormulaParserParser.DFA43_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA43_transitionS[t]));return e}()}),JsFormulaParserParser.DFA43=function(e){this.recognizer=e,this.decisionNumber=43,this.eot=JsFormulaParserParser.DFA43_eot,this.eof=JsFormulaParserParser.DFA43_eof,this.min=JsFormulaParserParser.DFA43_min,this.max=JsFormulaParserParser.DFA43_max,this.accept=JsFormulaParserParser.DFA43_accept,this.special=JsFormulaParserParser.DFA43_special,this.transition=JsFormulaParserParser.DFA43_transition},org.antlr.lang.extend(JsFormulaParserParser.DFA43,org.antlr.runtime.DFA,{getDescription:function(){return"655:1: atom_type returns [String value] : (a= expr | ARRAY_FORMULAR_START ( INTERSECT )? (b= atom_list ( INTERSECT )? ARRAY_FORMULAR_END ) | );"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred82_JsFormulaParser()?e=1:this.synpred85_JsFormulaParser()&&(e=16),t.seek(r);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),43,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA50_eotS:"\uffff",DFA50_eofS:"\uffff",DFA50_minS:"\b\uffff\0\uffff",DFA50_maxS:"(\uffff\0\uffff",DFA50_acceptS:"\uffff\f\uffff",DFA50_specialS:"\uffff\0\uffff}>",DFA50_transitionS:["\uffff\uffff\f\uffff\uffff\b\b","","","","","","","\uffff","\uffff","","","","","",""]}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA50_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA50_eotS),DFA50_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA50_eofS),DFA50_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA50_minS),DFA50_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA50_maxS),DFA50_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA50_acceptS),DFA50_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA50_specialS),DFA50_transition:function(){var e=[],t,n=JsFormulaParserParser.DFA50_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA50_transitionS[t]));return e}()}),JsFormulaParserParser.DFA50=function(e){this.recognizer=e,this.decisionNumber=50,this.eot=JsFormulaParserParser.DFA50_eot,this.eof=JsFormulaParserParser.DFA50_eof,this.min=JsFormulaParserParser.DFA50_min,this.max=JsFormulaParserParser.DFA50_max,this.accept=JsFormulaParserParser.DFA50_accept,this.special=JsFormulaParserParser.DFA50_special,this.transition=JsFormulaParserParser.DFA50_transition},org.antlr.lang.extend(JsFormulaParserParser.DFA50,org.antlr.runtime.DFA,{getDescription:function(){return"793:1: range returns [String value] : (params= atom_list | funct= folded );"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred94_JsFormulaParser()?e=1:e=14,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred94_JsFormulaParser()?e=1:e=14,t.seek(s);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),50,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA55_eotS:"\f\uffff",DFA55_eofS:"\f\uffff",DFA55_minS:"\0	\uffff",DFA55_maxS:"(\0	\uffff",DFA55_acceptS:"\uffff\uffff",DFA55_specialS:"\uffff\0	\uffff}>",DFA55_transitionS:["\uffff\uffff\uffff\uffff\uffff","\uffff","\uffff","","","","","","","","",""]}),org.antlr.lang.augmentObject(JsFormulaParserParser,{DFA55_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA55_eotS),DFA55_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA55_eofS),DFA55_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA55_minS),DFA55_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaParserParser.DFA55_maxS),DFA55_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA55_acceptS),DFA55_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA55_specialS),DFA55_transition:function(){var e=[],t,n=JsFormulaParserParser.DFA55_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaParserParser.DFA55_transitionS[t]));return e}()}),JsFormulaParserParser.DFA55=function(e){this.recognizer=e,this.decisionNumber=55,this.eot=JsFormulaParserParser.DFA55_eot,this.eof=JsFormulaParserParser.DFA55_eof,this.min=JsFormulaParserParser.DFA55_min,this.max=JsFormulaParserParser.DFA55_max,this.accept=JsFormulaParserParser.DFA55_accept,this.special=JsFormulaParserParser.DFA55_special,this.transition=JsFormulaParserParser.DFA55_transition},org.antlr.lang.extend(JsFormulaParserParser.DFA55,org.antlr.runtime.DFA,{getDescription:function(){return"98:4: (m= ( LESS | GREATER | LESSEQUAL | GREATEREQUAL | MODEQUAL | MULTEEQUAL | MINUSEQUAL | PLUSEQUAL | DIVEQUAL | NOTEQUAL | NOTEQUAL2 | EQUAL | AND | MINUS | PLUS | MULT | DIV | COLON | POW | ARG_SEP | CONCATENATION ) ( INTERSECT )? )?"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred28_JsFormulaParser()?e=3:e=4,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred28_JsFormulaParser()?e=3:e=4,t.seek(s);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),55,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaParserParser,{tokenNames:["<invalid>","<EOR>","<DOWN>","<UP>","COLON","CONCATENATION","INTERSECT_ODS","AND","PLUS","PLUSEQUAL","MINUS","MINUSEQUAL","MULT","MULTEEQUAL","DIV","DIVEQUAL","P_OPEN","P_CLOSE","EQUAL","LESS","LESSEQUAL","GREATER","GREATEREQUAL","NOTEQUAL","NOTEQUAL2","AMPERSAND","OR","POW","MODE","MODEQUAL","ARRAY_FORMULAR_START","ARRAY_FORMULAR_END","INTERSECT","ARG_SEP","SINGLEQUOT_STRING","LOCALE_NUMBER","NAME","ERRORNAME","DOUBLEQUOT_STRING","NAME1","FUNC","NONZERO_NUMBER","DIGIT","INT","SPACE1","NUMSEP","LT","COMMAOrSPACE","KEYCHARACTER","ODF_COLUMN","ODF_COL_RANGE","ODF_PREWORD","ODF_PRELIST","ODF_TABLE","WHITESPACE","SPACE","'.'"],FOLLOW_EQUAL_in_prog347:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_prog349:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_expr_in_prog352:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_EOF_in_prog357:new org.antlr.runtime.BitSet([2,0]),FOLLOW_ARRAY_FORMULAR_START_in_prog363:new org.antlr.runtime.BitSet([262144,0]),FOLLOW_EQUAL_in_prog365:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_expr_in_prog377:new org.antlr.runtime.BitSet([3221292288,509]),FOLLOW_ARRAY_FORMULAR_END_in_prog382:new org.antlr.runtime.BitSet([0,0]),FOLLOW_EOF_in_prog384:new org.antlr.runtime.BitSet([2,0]),FOLLOW_atom_in_expr407:new org.antlr.runtime.BitSet([2046689202,511]),FOLLOW_INTERSECT_in_expr417:new org.antlr.runtime.BitSet([2046689202,511]),FOLLOW_MODE_in_expr429:new org.antlr.runtime.BitSet([2046689202,511]),FOLLOW_set_in_expr443:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_expr512:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_expr_in_expr525:new org.antlr.runtime.BitSet([1778253746,511]),FOLLOW_MINUS_in_atom559:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_atom561:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_atom_in_atom567:new org.antlr.runtime.BitSet([2,0]),FOLLOW_PLUS_in_atom574:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_atom576:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_atom_in_atom582:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_atom602:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_atom610:new org.antlr.runtime.BitSet([0,9]),FOLLOW_INTERSECT_in_atom615:new org.antlr.runtime.BitSet([0,8]),FOLLOW_LOCALE_NUMBER_in_atom623:new org.antlr.runtime.BitSet([16,0]),FOLLOW_COLON_in_atom627:new org.antlr.runtime.BitSet([0,24]),FOLLOW_set_in_atom632:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_atom675:new org.antlr.runtime.BitSet([82,0]),FOLLOW_INTERSECT_ODS_in_atom685:new org.antlr.runtime.BitSet([0,49]),FOLLOW_INTERSECT_in_atom690:new org.antlr.runtime.BitSet([0,48]),FOLLOW_set_in_atom696:new org.antlr.runtime.BitSet([18,1]),FOLLOW_INTERSECT_in_atom705:new org.antlr.runtime.BitSet([18,0]),FOLLOW_COLON_in_atom714:new org.antlr.runtime.BitSet([0,61]),FOLLOW_INTERSECT_in_atom720:new org.antlr.runtime.BitSet([0,12]),FOLLOW_set_in_atom726:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_atom734:new org.antlr.runtime.BitSet([0,49]),FOLLOW_INTERSECT_in_atom740:new org.antlr.runtime.BitSet([0,48]),FOLLOW_set_in_atom748:new org.antlr.runtime.BitSet([2,0]),FOLLOW_DOUBLEQUOT_STRING_in_atom764:new org.antlr.runtime.BitSet([2,0]),FOLLOW_P_OPEN_in_atom778:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_atom794:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_expr_in_atom803:new org.antlr.runtime.BitSet([131072,1]),FOLLOW_INTERSECT_in_atom810:new org.antlr.runtime.BitSet([131072,0]),FOLLOW_P_CLOSE_in_atom817:new org.antlr.runtime.BitSet([2,0]),FOLLOW_folded_in_atom827:new org.antlr.runtime.BitSet([2,0]),FOLLOW_ARRAY_FORMULAR_START_in_atom839:new org.antlr.runtime.BitSet([3221292288,509]),FOLLOW_INTERSECT_in_atom844:new org.antlr.runtime.BitSet([3221292288,509]),FOLLOW_atom_in_atom859:new org.antlr.runtime.BitSet([3221292288,16777727]),FOLLOW_INTERSECT_in_atom873:new org.antlr.runtime.BitSet([0,16777218]),FOLLOW_set_in_atom879:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_atom888:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_atom_in_atom905:new org.antlr.runtime.BitSet([3221292288,16777727]),FOLLOW_INTERSECT_in_atom922:new org.antlr.runtime.BitSet([2147483648,0]),FOLLOW_ARRAY_FORMULAR_END_in_atom926:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_atom969:new org.antlr.runtime.BitSet([82,0]),FOLLOW_INTERSECT_ODS_in_atom980:new org.antlr.runtime.BitSet([0,57]),FOLLOW_INTERSECT_in_atom985:new org.antlr.runtime.BitSet([0,56]),FOLLOW_set_in_atom991:new org.antlr.runtime.BitSet([18,1]),FOLLOW_INTERSECT_in_atom1002:new org.antlr.runtime.BitSet([18,0]),FOLLOW_COLON_in_atom1012:new org.antlr.runtime.BitSet([0,185]),FOLLOW_INTERSECT_in_atom1018:new org.antlr.runtime.BitSet([0,144]),FOLLOW_set_in_atom1024:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_atom1032:new org.antlr.runtime.BitSet([0,57]),FOLLOW_INTERSECT_in_atom1037:new org.antlr.runtime.BitSet([0,56]),FOLLOW_set_in_atom1045:new org.antlr.runtime.BitSet([2,0]),FOLLOW_atom_type_in_atom_list1073:new org.antlr.runtime.BitSet([2,3]),FOLLOW_INTERSECT_in_atom_list1081:new org.antlr.runtime.BitSet([0,2]),FOLLOW_ARG_SEP_in_atom_list1086:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_INTERSECT_in_atom_list1088:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_atom_type_in_atom_list1095:new org.antlr.runtime.BitSet([2,3]),FOLLOW_expr_in_atom_type1123:new org.antlr.runtime.BitSet([2,0]),FOLLOW_ARRAY_FORMULAR_START_in_atom_type1133:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_INTERSECT_in_atom_type1135:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_atom_list_in_atom_type1141:new org.antlr.runtime.BitSet([2147483648,1]),FOLLOW_INTERSECT_in_atom_type1143:new org.antlr.runtime.BitSet([2147483648,0]),FOLLOW_ARRAY_FORMULAR_END_in_atom_type1146:new org.antlr.runtime.BitSet([2,0]),FOLLOW_FUNC_in_folded1182:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_set_in_folded1190:new org.antlr.runtime.BitSet([65536,0]),FOLLOW_P_OPEN_in_folded1200:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_INTERSECT_in_folded1215:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_range_in_folded1223:new org.antlr.runtime.BitSet([131072,1]),FOLLOW_INTERSECT_in_folded1231:new org.antlr.runtime.BitSet([131072,0]),FOLLOW_P_CLOSE_in_folded1242:new org.antlr.runtime.BitSet([2,0]),FOLLOW_FUNC_in_folded1256:new org.antlr.runtime.BitSet([131072,0]),FOLLOW_set_in_folded1264:new org.antlr.runtime.BitSet([65536,1]),FOLLOW_INTERSECT_in_folded1270:new org.antlr.runtime.BitSet([65536,0]),FOLLOW_P_OPEN_in_folded1275:new org.antlr.runtime.BitSet([131072,0]),FOLLOW_P_CLOSE_in_folded1280:new org.antlr.runtime.BitSet([2,0]),FOLLOW_atom_list_in_range1303:new org.antlr.runtime.BitSet([2,0]),FOLLOW_folded_in_range1314:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred5_JsFormulaParser417:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred28_JsFormulaParser443:new org.antlr.runtime.BitSet([2,1]),FOLLOW_INTERSECT_in_synpred28_JsFormulaParser512:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred29_JsFormulaParser443:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_synpred29_JsFormulaParser512:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_expr_in_synpred29_JsFormulaParser525:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred38_JsFormulaParser602:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_synpred38_JsFormulaParser610:new org.antlr.runtime.BitSet([0,9]),FOLLOW_INTERSECT_in_synpred38_JsFormulaParser615:new org.antlr.runtime.BitSet([0,8]),FOLLOW_LOCALE_NUMBER_in_synpred38_JsFormulaParser623:new org.antlr.runtime.BitSet([16,0]),FOLLOW_COLON_in_synpred38_JsFormulaParser627:new org.antlr.runtime.BitSet([0,24]),FOLLOW_set_in_synpred38_JsFormulaParser632:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred42_JsFormulaParser705:new org.antlr.runtime.BitSet([2,0]),FOLLOW_COLON_in_synpred49_JsFormulaParser714:new org.antlr.runtime.BitSet([0,61]),FOLLOW_INTERSECT_in_synpred49_JsFormulaParser720:new org.antlr.runtime.BitSet([0,12]),FOLLOW_set_in_synpred49_JsFormulaParser726:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_synpred49_JsFormulaParser734:new org.antlr.runtime.BitSet([0,49]),FOLLOW_INTERSECT_in_synpred49_JsFormulaParser740:new org.antlr.runtime.BitSet([0,48]),FOLLOW_set_in_synpred49_JsFormulaParser748:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred50_JsFormulaParser675:new org.antlr.runtime.BitSet([82,0]),FOLLOW_INTERSECT_ODS_in_synpred50_JsFormulaParser685:new org.antlr.runtime.BitSet([0,49]),FOLLOW_INTERSECT_in_synpred50_JsFormulaParser690:new org.antlr.runtime.BitSet([0,48]),FOLLOW_set_in_synpred50_JsFormulaParser696:new org.antlr.runtime.BitSet([18,1]),FOLLOW_INTERSECT_in_synpred50_JsFormulaParser705:new org.antlr.runtime.BitSet([18,0]),FOLLOW_COLON_in_synpred50_JsFormulaParser714:new org.antlr.runtime.BitSet([0,61]),FOLLOW_INTERSECT_in_synpred50_JsFormulaParser720:new org.antlr.runtime.BitSet([0,12]),FOLLOW_set_in_synpred50_JsFormulaParser726:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_synpred50_JsFormulaParser734:new org.antlr.runtime.BitSet([0,49]),FOLLOW_INTERSECT_in_synpred50_JsFormulaParser740:new org.antlr.runtime.BitSet([0,48]),FOLLOW_set_in_synpred50_JsFormulaParser748:new org.antlr.runtime.BitSet([2,0]),FOLLOW_folded_in_synpred55_JsFormulaParser827:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred56_JsFormulaParser844:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred70_JsFormulaParser1002:new org.antlr.runtime.BitSet([2,0]),FOLLOW_COLON_in_synpred78_JsFormulaParser1012:new org.antlr.runtime.BitSet([0,185]),FOLLOW_INTERSECT_in_synpred78_JsFormulaParser1018:new org.antlr.runtime.BitSet([0,144]),FOLLOW_set_in_synpred78_JsFormulaParser1024:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_synpred78_JsFormulaParser1032:new org.antlr.runtime.BitSet([0,57]),FOLLOW_INTERSECT_in_synpred78_JsFormulaParser1037:new org.antlr.runtime.BitSet([0,56]),FOLLOW_set_in_synpred78_JsFormulaParser1045:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred80_JsFormulaParser1088:new org.antlr.runtime.BitSet([2,0]),FOLLOW_expr_in_synpred82_JsFormulaParser1123:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred83_JsFormulaParser1135:new org.antlr.runtime.BitSet([2,0]),FOLLOW_ARRAY_FORMULAR_START_in_synpred85_JsFormulaParser1133:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_INTERSECT_in_synpred85_JsFormulaParser1135:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_atom_list_in_synpred85_JsFormulaParser1141:new org.antlr.runtime.BitSet([2147483648,1]),FOLLOW_INTERSECT_in_synpred85_JsFormulaParser1143:new org.antlr.runtime.BitSet([2147483648,0]),FOLLOW_ARRAY_FORMULAR_END_in_synpred85_JsFormulaParser1146:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred88_JsFormulaParser1215:new org.antlr.runtime.BitSet([2,0]),FOLLOW_FUNC_in_synpred90_JsFormulaParser1182:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_set_in_synpred90_JsFormulaParser1190:new org.antlr.runtime.BitSet([65536,0]),FOLLOW_P_OPEN_in_synpred90_JsFormulaParser1200:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_INTERSECT_in_synpred90_JsFormulaParser1215:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_range_in_synpred90_JsFormulaParser1223:new org.antlr.runtime.BitSet([131072,1]),FOLLOW_INTERSECT_in_synpred90_JsFormulaParser1231:new org.antlr.runtime.BitSet([131072,0]),FOLLOW_P_CLOSE_in_synpred90_JsFormulaParser1242:new org.antlr.runtime.BitSet([2,0]),FOLLOW_atom_list_in_synpred94_JsFormulaParser1303:new org.antlr.runtime.BitSet([2,0])})}();var JsFormulaCommaParserLexer=function(e,t){t||(t=new org.antlr.runtime.RecognizerSharedState),function(){this.emitErrorMessage=function(e){throw console&&console.warn(e),"#ERROR!"}}.call(this),this.dfa23=new JsFormulaCommaParserLexer.DFA23(this),this.dfa31=new JsFormulaCommaParserLexer.DFA31(this),JsFormulaCommaParserLexer.superclass.constructor.call(this,e,t)};org.antlr.lang.augmentObject(JsFormulaCommaParserLexer,{ODF_TABLE:53,NAME1:39,LT:46,NAME:36,SPACE1:44,DIGIT:42,ARRAY_FORMULAR_END:31,NOTEQUAL2:24,EQUAL:18,DOUBLEQUOT_STRING:38,NUMSEP:45,LESS:19,PLUS:8,LESSEQUAL:20,MULTEEQUAL:13,MODE:28,P_CLOSE:17,KEYCHARACTER:48,MULT:12,ARG_SEP:33,AND:7,CONCATENATION:5,POW:27,PLUSEQUAL:9,COLON:4,SINGLEQUOT_STRING:34,NOTEQUAL:23,DIVEQUAL:15,
ODF_COLUMN:49,MINUSEQUAL:11,FUNC:40,LOCALE_NUMBER:35,INT:43,ODF_COL_RANGE:50,MINUS:10,AMPERSAND:25,ARRAY_FORMULAR_START:30,P_OPEN:16,GREATER:21,EOF:-1,INTERSECT_ODS:6,ODF_PREWORD:51,OR:26,SPACE:55,COMMAOrSPACE:47,DIV:14,MODEQUAL:29,NONZERO_NUMBER:41,ERRORNAME:37,ODF_PRELIST:52,GREATEREQUAL:22,WHITESPACE:54,INTERSECT:32}),function(){var e=org.antlr.runtime.Token.HIDDEN_CHANNEL,t=org.antlr.runtime.Token.EOF;org.antlr.lang.extend(JsFormulaCommaParserLexer,org.antlr.runtime.Lexer,{ODF_TABLE:53,NAME1:39,LT:46,NAME:36,SPACE1:44,DIGIT:42,ARRAY_FORMULAR_END:31,NOTEQUAL2:24,EQUAL:18,DOUBLEQUOT_STRING:38,NUMSEP:45,LESS:19,PLUS:8,LESSEQUAL:20,MULTEEQUAL:13,MODE:28,P_CLOSE:17,KEYCHARACTER:48,MULT:12,ARG_SEP:33,AND:7,CONCATENATION:5,POW:27,PLUSEQUAL:9,COLON:4,SINGLEQUOT_STRING:34,NOTEQUAL:23,DIVEQUAL:15,ODF_COLUMN:49,MINUSEQUAL:11,FUNC:40,LOCALE_NUMBER:35,INT:43,ODF_COL_RANGE:50,MINUS:10,AMPERSAND:25,ARRAY_FORMULAR_START:30,P_OPEN:16,GREATER:21,EOF:-1,INTERSECT_ODS:6,ODF_PREWORD:51,OR:26,SPACE:55,COMMAOrSPACE:47,DIV:14,MODEQUAL:29,NONZERO_NUMBER:41,ERRORNAME:37,ODF_PRELIST:52,GREATEREQUAL:22,WHITESPACE:54,INTERSECT:32,getGrammarFileName:function(){return"C:\\IBMDoc\\DocsSoruceCode\\com.ibm.docs.web.resources\\WebContent\\js\\parser\\JsFormulaCommaParser.g"}}),org.antlr.lang.augmentObject(JsFormulaCommaParserLexer.prototype,{mCOLON:function(){try{var e=this.COLON,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(":"),this.state.type=e,this.state.channel=t}finally{}},mCONCATENATION:function(){try{var e=this.CONCATENATION,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("~"),this.state.type=e,this.state.channel=t}finally{}},mINTERSECT_ODS:function(){try{var e=this.INTERSECT_ODS,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("!"),this.state.type=e,this.state.channel=t}finally{}},mAND:function(){try{var e=this.AND,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("&"),this.state.type=e,this.state.channel=t}finally{}},mPLUS:function(){try{var e=this.PLUS,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("+"),this.state.type=e,this.state.channel=t}finally{}},mPLUSEQUAL:function(){try{var e=this.PLUSEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("+="),this.state.type=e,this.state.channel=t}finally{}},mMINUS:function(){try{var e=this.MINUS,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("-"),this.state.type=e,this.state.channel=t}finally{}},mMINUSEQUAL:function(){try{var e=this.MINUSEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("-="),this.state.type=e,this.state.channel=t}finally{}},mMULT:function(){try{var e=this.MULT,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("*"),this.state.type=e,this.state.channel=t}finally{}},mMULTEEQUAL:function(){try{var e=this.MULTEEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("*="),this.state.type=e,this.state.channel=t}finally{}},mDIV:function(){try{var e=this.DIV,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("/"),this.state.type=e,this.state.channel=t}finally{}},mDIVEQUAL:function(){try{var e=this.DIVEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("/="),this.state.type=e,this.state.channel=t}finally{}},mP_OPEN:function(){try{var e=this.P_OPEN,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("("),this.state.type=e,this.state.channel=t}finally{}},mP_CLOSE:function(){try{var e=this.P_CLOSE,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(")"),this.state.type=e,this.state.channel=t}finally{}},mEQUAL:function(){try{var e=this.EQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("="),this.state.type=e,this.state.channel=t}finally{}},mLESS:function(){try{var e=this.LESS,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("<"),this.state.type=e,this.state.channel=t}finally{}},mLESSEQUAL:function(){try{var e=this.LESSEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("<="),this.state.type=e,this.state.channel=t}finally{}},mGREATER:function(){try{var e=this.GREATER,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(">"),this.state.type=e,this.state.channel=t}finally{}},mGREATEREQUAL:function(){try{var e=this.GREATEREQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(">="),this.state.type=e,this.state.channel=t}finally{}},mNOTEQUAL:function(){try{var e=this.NOTEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("<>"),this.state.type=e,this.state.channel=t}finally{}},mNOTEQUAL2:function(){try{var e=this.NOTEQUAL2,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("!="),this.state.type=e,this.state.channel=t}finally{}},mAMPERSAND:function(){try{var e=this.AMPERSAND,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("&&"),this.state.type=e,this.state.channel=t}finally{}},mOR:function(){try{var e=this.OR,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("||"),this.state.type=e,this.state.channel=t}finally{}},mPOW:function(){try{var e=this.POW,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("^"),this.state.type=e,this.state.channel=t}finally{}},mMODE:function(){try{var e=this.MODE,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("%"),this.state.type=e,this.state.channel=t}finally{}},mMODEQUAL:function(){try{var e=this.MODEQUAL,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("%="),this.state.type=e,this.state.channel=t}finally{}},mARRAY_FORMULAR_START:function(){try{var e=this.ARRAY_FORMULAR_START,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("{"),this.state.type=e,this.state.channel=t}finally{}},mARRAY_FORMULAR_END:function(){try{var e=this.ARRAY_FORMULAR_END,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("}"),this.state.type=e,this.state.channel=t}finally{}},mNONZERO_NUMBER:function(){try{var e=0;e:do{var t=2,n=this.input.LA(1);n>="1"&&n<="9"&&(t=1);switch(t){case 1:this.matchRange("1","9");break;default:if(e>=1)break e;var r=new org.antlr.runtime.EarlyExitException(1,this.input);throw r}e++}while(!0)}finally{}},mINT:function(){try{var e=0;e:do{var t=2,n=this.input.LA(1);n>="0"&&n<="9"&&(t=1);switch(t){case 1:this.mDIGIT();break;default:if(e>=1)break e;var r=new org.antlr.runtime.EarlyExitException(2,this.input);throw r}e++}while(!0)}finally{}},mSPACE1:function(){try{if(this.input.LA(1)!=" "&&this.input.LA(1)!="\u00a0"&&this.input.LA(1)!="\u3000"){var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(e),e}this.input.consume()}finally{}},mNUMSEP:function(){try{e:do{var e=2,t=this.input.LA(1);t=="."&&(e=1);switch(e){case 1:this.match(".");break;default:break e}}while(!0)}finally{}},mLOCALE_NUMBER:function(){try{var e=this.LOCALE_NUMBER,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);if(i=="."||i>="0"&&i<="9")r=1;switch(r){case 1:this.mNUMSEP(),this.mINT();t:do{var s=2,o=this.input.LA(1);if(o=="'"||o==".")s=1;switch(s){case 1:if(this.input.LA(1)!="'"&&this.input.LA(1)!="."){var u=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(u),u}this.input.consume();break;default:break t}}while(!0);break;default:if(n>=1)break e;var a=new org.antlr.runtime.EarlyExitException(5,this.input);throw a}n++}while(!0);var f=2,l=this.input.LA(1);l=="E"&&(f=1);switch(f){case 1:this.match("E");var c=2,h=this.input.LA(1);if(h=="+"||h=="-")c=1;switch(c){case 1:if(this.input.LA(1)!="+"&&this.input.LA(1)!="-"){var u=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(u),u}this.input.consume()}this.mINT()}this.state.type=e,this.state.channel=t}finally{}},mSINGLEQUOT_STRING:function(){try{var e=this.SINGLEQUOT_STRING,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=2,r=this.input.LA(1);r=="$"&&(n=1);switch(n){case 1:this.match("$")}var i=0;e:do{var s=2,o=this.input.LA(1);o=="'"&&(s=1);switch(s){case 1:this.match("'");t:do{var u=2,a=this.input.LA(1);if(a>="\0"&&a<="\f"||a>=""&&a<="&"||a>="("&&a<="\u2027"||a>="\u202a"&&a<="\uffff")u=1;switch(u){case 1:if(!(this.input.LA(1)>="\0"&&this.input.LA(1)<="\f"||this.input.LA(1)>=""&&this.input.LA(1)<="&"||this.input.LA(1)>="("&&this.input.LA(1)<="\u2027"||this.input.LA(1)>="\u202a"&&this.input.LA(1)<="\uffff")){var f=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(f),f}this.input.consume();break;default:break t}}while(!0);this.match("'");break;default:if(i>=1)break e;var l=new org.antlr.runtime.EarlyExitException(10,this.input);throw l}i++}while(!0);this.state.type=e,this.state.channel=t}finally{}},mDOUBLEQUOT_STRING:function(){try{var e=this.DOUBLEQUOT_STRING,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);i=='"'&&(r=1);switch(r){case 1:this.match('"');t:do{var s=2,o=this.input.LA(1);if(o>="\0"&&o<="\f"||o>=""&&o<="!"||o>="#"&&o<="\u2027"||o>="\u202a"&&o<="\uffff")s=1;switch(s){case 1:if(!(this.input.LA(1)>="\0"&&this.input.LA(1)<="\f"||this.input.LA(1)>=""&&this.input.LA(1)<="!"||this.input.LA(1)>="#"&&this.input.LA(1)<="\u2027"||this.input.LA(1)>="\u202a"&&this.input.LA(1)<="\uffff")){var u=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(u),u}this.input.consume();break;default:break t}}while(!0);this.match('"');break;default:if(n>=1)break e;var a=new org.antlr.runtime.EarlyExitException(12,this.input);throw a}n++}while(!0);this.state.type=e,this.state.channel=t}finally{}},mARG_SEP:function(){try{var e=this.ARG_SEP,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;if(this.input.LA(1)!=","&&this.input.LA(1)!=";"){var n=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(n),n}this.input.consume(),this.state.type=e,this.state.channel=t}finally{}},mFUNC:function(){try{var e=this.FUNC,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);if(i>="0"&&i<="9"||i>="A"&&i<="Z"||i=="_")r=1;switch(r){case 1:if(!(this.input.LA(1)>="0"&&this.input.LA(1)<="9"||this.input.LA(1)>="A"&&this.input.LA(1)<="Z"||this.input.LA(1)=="_")){var s=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(s),s}this.input.consume();break;default:if(n>=1)break e;var o=new org.antlr.runtime.EarlyExitException(13,this.input);throw o}n++}while(!0);this.match("("),this.state.type=e,this.state.channel=t}finally{}},mERRORNAME:function(){try{var e=this.ERRORNAME,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("#");var n=3,r=this.input.LA(1);if(r=="D"||r=="R"||r=="V")n=1;else{if(r!="N"){var i=new org.antlr.runtime.NoViableAltException("",15,0,this.input);throw i}switch(this.input.LA(2)){case"U":n=1;break;case"/":n=2;break;case"A":n=3;break;default:var i=new org.antlr.runtime.NoViableAltException("",15,2,this.input);throw i}}switch(n){case 1:var s=5;switch(this.input.LA(1)){case"V":s=1;break;case"N":var o=this.input.LA(2);if(o!="U"){var i=new org.antlr.runtime.NoViableAltException("",14,2,this.input);throw i}var u=this.input.LA(3);if(u=="M")s=2;else{if(u!="L"){var i=new org.antlr.runtime.NoViableAltException("",14,5,this.input);throw i}s=5}break;case"R":s=3;break;case"D":s=4;break;default:var i=new org.antlr.runtime.NoViableAltException("",14,0,this.input);throw i}switch(s){case 1:this.match("VALUE");break;case 2:this.match("NUM");break;case 3:this.match("REF");break;case 4:this.match("DIV/0");break;case 5:this.match("NULL")}this.match("!");break;case 2:this.match("N/A");break;case 3:this.match("NAME?")}this.state.type=e,this.state.channel=t}finally{}},mNAME:function(){try{var e=this.NAME,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);if(i=="$"||i=="'"||i=="."||i>="0"&&i<="9"||i=="?"||i>="A"&&i<="Z"||i=="\\"||i=="_"||i>="a"&&i<="z")r=1;switch(r){case 1:if(!(this.input.LA(1)=="$"||this.input.LA(1)=="'"||this.input.LA(1)=="."||this.input.LA(1)>="0"&&this.input.LA(1)<="9"||this.input.LA(1)=="?"||this.input.LA(1)>="A"&&this.input.LA(1)<="Z"||this.input.LA(1)=="\\"||this.input.LA(1)=="_"||this.input.LA(1)>="a"&&this.input.LA(1)<="z")){var s=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(s),s}this.input.consume();break;default:if(n>=1)break e;var o=new org.antlr.runtime.EarlyExitException(16,this.input);throw o}n++}while(!0);var u=2,a=this.input.LA(1);a=="#"&&(u=1);switch(u){case 1:this.match("#REF!")}this.state.type=e,this.state.channel=t}finally{}},mNAME1:function(){try{var e=this.NAME1,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);if(i>="\0"&&i<="\b"||i==""||i>=""&&i<=""||i>="0"&&i<="9"||i>="A"&&i<="Z"||i=="_"||i>="a"&&i<="z"||i>=""&&i<="\uffff")r=1;switch(r){case 1:if(!(this.input.LA(1)>="\0"&&this.input.LA(1)<="\b"||this.input.LA(1)==""||this.input.LA(1)>=""&&this.input.LA(1)<=""||this.input.LA(1)>="0"&&this.input.LA(1)<="9"||this.input.LA(1)>="A"&&this.input.LA(1)<="Z"||this.input.LA(1)=="_"||this.input.LA(1)>="a"&&this.input.LA(1)<="z"||this.input.LA(1)>=""&&this.input.LA(1)<="\uffff")){var s=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(s),s}this.input.consume();break;default:if(n>=1)break e;var o=new org.antlr.runtime.EarlyExitException(18,this.input);throw o}n++}while(!0);websheet.parse.parseHelper._cellHasUnicode=!0,this.state.type=e,this.state.channel=t}finally{}},mCOMMAOrSPACE:function(){try{this.match(",");var e=2,t=this.input.LA(1);t==" "&&(e=1);switch(e){case 1:this.match(" ")}}finally{}},mKEYCHARACTER:function(){try{if(this.input.LA(1)!="#"&&this.input.LA(1)!="'"&&this.input.LA(1)!="@"&&this.input.LA(1)!="["&&this.input.LA(1)!="]"){var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(e),e}this.input.consume()}finally{}},mODF_COLUMN:function(){try{this.match("[");var e=0;e:do{var t=3,n=this.input.LA(1);n>="\0"&&n<='"'||n>="$"&&n<="&"||n>="("&&n<="?"||n>="A"&&n<="Z"||n=="\\"||n>="^"&&n<="\uffff"?t=1:n=="'"&&(t=2);switch(t){case 1:if(!(this.input.LA(1)>="\0"&&this.input.LA(1)<='"'||this.input.LA(1)>="$"&&this.input.LA(1)<="&"||this.input.LA(1)>="("&&this.input.LA(1)<="?"||this.input.LA(1)>="A"&&this.input.LA(1)<="Z"||this.input.LA(1)=="\\"||this.input.LA(1)>="^"&&this.input.LA(1)<="\uffff")){var r=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(r),r}this.input.consume();break;case 2:this.match("'"),this.mKEYCHARACTER();break;default:if(e>=1)break e;var i=new org.antlr.runtime.EarlyExitException(20,this.input);throw i}e++}while(!0);this.match("]")}finally{}},mODF_COL_RANGE:function(){try{this.mODF_COLUMN();var e=2,t=this.input.LA(1);t==":"&&(e=1);switch(e){case 1:this.match(":"),this.mODF_COLUMN()}}finally{}},mODF_PREWORD:function(){try{this.match("[");var e=5,t=this.input.LA(1);if(t!="#"){var r=new org.antlr.runtime.NoViableAltException("",22,0,this.input);throw r}switch(this.input.LA(2)){case"T":var n=this.input.LA(3);if(n=="H")e=1;else{if(n!="O"){var r=new org.antlr.runtime.NoViableAltException("",22,2,this.input);throw r}e=4}break;case"A":e=2;break;case"H":e=3;break;case"D":e=5;break;default:var r=new org.antlr.runtime.NoViableAltException("",22,1,this.input);throw r}switch(e){case 1:this.match("#THIS ROW");break;case 2:this.match("#ALL");break;case 3:this.match("#HEADERS");break;case 4:this.match("#TOTALS");break;case 5:this.match("#DATA")}this.match("]")}finally{}},mODF_PRELIST:function(){try{var e=3;e=this.dfa23.predict(this.input);switch(e){case 1:this.match("[#HEADERS]"),this.mCOMMAOrSPACE(),this.match("[#DATA]");break;case 2:this.match("[#DATA]"),this.mCOMMAOrSPACE(),this.match("[#TOTALS]");break;case 3:this.mODF_PREWORD()}}finally{}},mODF_TABLE:function(){try{var e=this.ODF_TABLE,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=3,r=this.input.LA(1);if(r!="["){var o=new org.antlr.runtime.NoViableAltException("",28,0,this.input);throw o}var i=this.input.LA(2);if(i==" "){var s=this.input.LA(3);if(s=="[")n=1;else{if(!(s>="\0"&&s<='"'||s>="$"&&s<="?"||s>="A"&&s<="Z"||s>="\\"&&s<="\uffff")){var o=new org.antlr.runtime.NoViableAltException("",28,2,this.input);throw o}n=3}}else if(i=="[")n=1;else if(i>="\0"&&i<=""||i>="!"&&i<='"'||i>="$"&&i<="?"||i>="A"&&i<="Z"||i=="\\"||i>="^"&&i<="\uffff")n=3;else{if(i!="#"){var o=new org.antlr.runtime.NoViableAltException("",28,1,this.input);throw o}n=2}switch(n){case 1:this.match("[");var u=2,a=this.input.LA(1);a==" "&&(u=1);switch(u){case 1:this.match(" ")}var f=2,l=this.input.LA(1);if(l!="["){var o=new org.antlr.runtime.NoViableAltException("",26,0,this.input);throw o}var c=this.input.LA(2);if(c=="#")f=1;else{if(!(c>="\0"&&c<='"'||c>="$"&&c<="?"||c>="A"&&c<="Z"||c=="\\"||c>="^"&&c<="\uffff")){var o=new org.antlr.runtime.NoViableAltException("",26,1,this.input);throw o}f=2}switch(f){case 1:this.mODF_PRELIST();var h=2,p=this.input.LA(1);p==","&&(h=1);switch(h){case 1:this.mCOMMAOrSPACE(),this.mODF_COL_RANGE()}break;case 2:this.mODF_COL_RANGE()}var d=2,v=this.input.LA(1);v==" "&&(d=1);switch(d){case 1:this.match(" ")}this.match("]");break;case 2:this.mODF_PREWORD();break;case 3:this.mODF_COLUMN()}websheet.parse.parseHelper._cellHasUnicode=!0,this.state.type=e,this.state.channel=t}finally{}},mINTERSECT:function(){try{var e=this.INTERSECT,t=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,n=0;e:do{var r=2,i=this.input.LA(1);if(i==" "||i=="\u00a0"||i=="\u3000")r=1;switch(r){case 1:this.mSPACE1();break;default:if(n>=1)break e;var s=new org.antlr.runtime.EarlyExitException(29,this.input);throw s}n++}while(!0);this.state.type=e,this.state.channel=t}finally{}},mWHITESPACE:function(){try{var t=this.WHITESPACE,n=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,r=0;e:do{var i=2,s=this.input.LA(1);if(s>="	"&&s<="\n"||s>="\f"&&s<="\r"||s==" ")i=1;switch(i){case 1:if(!(this.input.LA(1)>="	"&&this.input.LA(1)<="\n"||this.input.LA(1)>="\f"&&this.input.LA(1)<="\r"||this.input.LA(1)==" ")){var o=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(o),o}this.input.consume();break;default:if(r>=1)break e;var u=new org.antlr.runtime.EarlyExitException(30,this.input);throw u}r++}while(!0);n=e,this.state.type=t,this.state.channel=n}finally{}},mSPACE:function(){try{if(!(this.input.LA(1)>="	"&&this.input.LA(1)<="\n"||this.input.LA(1)>="\f"&&this.input.LA(1)<="\r"||this.input.LA(1)==" ")){var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(e),e}this.input.consume()}finally{}},mLT:function(){try{if(!(this.input.LA(1)=="\r"||this.input.LA(1)>="\u2028"&&this.input.LA(1)<="\u2029")){var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(e),e}this.input.consume()}finally{}},mDIGIT:function(){try{this.matchRange("0","9")}finally{}},mTokens:function(){var e=39;e=this.dfa31.predict(this.input);switch(e){case 1:this.mCOLON();break;case 2:this.mCONCATENATION();break;case 3:this.mINTERSECT_ODS();break;case 4:this.mAND();break;case 5:this.mPLUS();break;case 6:this.mPLUSEQUAL();break;case 7:this.mMINUS();break;case 8:this.mMINUSEQUAL();break;case 9:this.mMULT();break;case 10:this.mMULTEEQUAL();break;case 11:this.mDIV();break;case 12:this.mDIVEQUAL();break;case 13:this.mP_OPEN();break;case 14:this.mP_CLOSE();break;case 15:this.mEQUAL();break;case 16:this.mLESS();break;case 17:this.mLESSEQUAL();break;case 18:this.mGREATER();break;case 19:this.mGREATEREQUAL();break;case 20:this.mNOTEQUAL();break;case 21:this.mNOTEQUAL2();break;case 22:this.mAMPERSAND();break;case 23:this.mOR();break;case 24:this.mPOW();break;case 25:this.mMODE();break;case 26:this.mMODEQUAL();break;case 27:this.mARRAY_FORMULAR_START();break;case 28:this.mARRAY_FORMULAR_END();break;case 29:this.mLOCALE_NUMBER();break;case 30:this.mSINGLEQUOT_STRING();break;case 31:this.mDOUBLEQUOT_STRING();break;case 32:this.mARG_SEP();break;case 33:this.mFUNC();break;case 34:this.mERRORNAME();break;case 35:this.mNAME();break;case 36:this.mNAME1();break;case 37:this.mODF_TABLE();break;case 38:this.mINTERSECT();break;case 39:this.mWHITESPACE()}}},!0),org.antlr.lang.augmentObject(JsFormulaCommaParserLexer,{DFA23_eotS:"\r\uffff\uffff\uffff",DFA23_eofS:"\uffff",DFA23_minS:"[#AEA\uffffATDAE]R,S\uffff],\uffff",DFA23_maxS:"[#TEA\uffffATDAE]R,S\uffff],\uffff",DFA23_acceptS:"\uffff	\uffff\uffff",DFA23_specialS:"\uffff}>",DFA23_transitionS:["","","\uffff\uffff\uffff","","","","\b","	","\n","","\f","\r","","","","","","",""]}),org.antlr.lang.augmentObject(JsFormulaCommaParserLexer,{DFA23_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserLexer.DFA23_eotS),DFA23_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserLexer.DFA23_eofS),DFA23_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserLexer.DFA23_minS),DFA23_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserLexer.DFA23_maxS),DFA23_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserLexer.DFA23_acceptS),DFA23_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserLexer.DFA23_specialS),DFA23_transition:function(){var e=[],t,n=JsFormulaCommaParserLexer.DFA23_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserLexer.DFA23_transitionS[t]));return e}()}),JsFormulaCommaParserLexer.DFA23=function(e){this.recognizer=e,this.decisionNumber=23,this.eot=JsFormulaCommaParserLexer.DFA23_eot,this.eof=JsFormulaCommaParserLexer.DFA23_eof,this.min=JsFormulaCommaParserLexer.DFA23_min,this.max=JsFormulaCommaParserLexer.DFA23_max,this.accept=JsFormulaCommaParserLexer.DFA23_accept,this.special=JsFormulaCommaParserLexer.DFA23_special,this.transition=JsFormulaCommaParserLexer.DFA23_transition},org.antlr.lang.extend(JsFormulaCommaParserLexer.DFA23,org.antlr.runtime.DFA,{getDescription:function(){return"851:10: fragment ODF_PRELIST : ( ( '[#HEADERS]' COMMAOrSPACE '[#DATA]' ) | ( '[#DATA]' COMMAOrSPACE '[#TOTALS]' ) | ODF_PREWORD );"},dummy:null}),org.antlr.lang.augmentObject(JsFormulaCommaParserLexer,{DFA31_eotS:"\uffff#%')+-\uffff02\uffff4\uffff8\uffff\uffff\uffff\uffff?\uffff8\uffff\uffff8\uffff>\uffff8\uffff8\uffff",DFA31_eofS:"G\uffff",DFA31_minS:"\0\uffff=&=\uffff=\uffff=\uffff.\0'\0\uffff\0\uffff\0\uffff \uffff	\uffff#\uffff\0\uffff#\0#\uffff+\0#\0",DFA31_maxS:"\uffff\uffff=&=\uffff>=\uffff=\uffff9\uffff'\uffff\uffff\uffff\uffff\uffff\uffff\u3000\uffff \uffffz\uffff\uffff\uffffz\uffffz\uffff9\uffffz\uffff",DFA31_acceptS:"\uffff\uffff\r\uffff\uffff\uffff \uffff\"\uffff#\uffff%$\uffff'\b\n	\f\uffff!\uffff\uffff&\uffff",DFA31_specialS:"\b\uffff\uffff	\uffff\n\uffff\uffff\uffff\0\uffff\uffff\f}>",DFA31_transitionS:["	!! 	\n\b\n\f\r\uffff\uffff\uffff!\u2f5f\ucfff","","",'"',"$","&","(","*",",","","","","./","1","","","3","","","\uffff\n5","	\uffff\uffff\uffff\uffff:6\uffff9\uffff\n\uffff\uffff7\uffff\uffff\uffff\uffff\uff81","","\r>\uffff>;<>=><>\n<><><><><><\u1fad>\uffff\udfd6>","","","	\uffff\uffff\b\uffff6\uffff\n\uffff\uffff\uffff\uffff\uff81","","	\uffff\uffff\uffff\n\uffff\uffff\uffff\uffff\uff81","","?\uffff\u2f5f\uffff","","","!\uffff!\uffff ","","","","","","","","","","","","","","","","","","","","","\uffff:\uffff9\uffff\n5\uffff\uffff@\uffff\uffff\uffff","","	\uffff\uffff\b\uffff6\uffff8\uffff8\uffff\nA\uffff\uffff\uffff\uffff\uff81","","\uffff:\uffff9\uffff\n5\uffff\uffff@\uffff\uffff\uffff","\uffff:\uffff9\uffff\n5\uffff\uffff@\uffff\uffff\uffff","\r>\uffffD>B\u1fd5>\uffff\udfd6>","\r>\uffff>;<>=><>\n<><><><><><\u1fad>\uffff\udfd6>","\uffff\uffff\uffff\n\uffff\uffff\uffff\uffff\uffff","","","8\uffff8\uffff\nC","	\uffff\uffff\uffff\uffff6\uffff\uffff\nA\uffff\uffff\uffff\uffff\uffff\uffff\uff81","\r>\uffff7>D\u1fe2>\uffff\udfd6>","\uffff\uffff\uffff\nC\uffff\uffff\uffff\uffff\uffff","\r>\uffff8>E\u1fe1>\uffff\udfd6>","\r>\uffff>F\u2006>\uffff\udfd6>","\r>\uffff\u201a>\uffff\udfd6>"]}),org.antlr.lang.augmentObject(JsFormulaCommaParserLexer,{DFA31_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserLexer.DFA31_eotS),DFA31_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserLexer.DFA31_eofS),DFA31_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserLexer.DFA31_minS),DFA31_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserLexer.DFA31_maxS),DFA31_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserLexer.DFA31_acceptS),DFA31_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserLexer.DFA31_specialS),DFA31_transition:function(){var e=[],t,n=JsFormulaCommaParserLexer.DFA31_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserLexer.DFA31_transitionS[t]));return e}()}),JsFormulaCommaParserLexer.DFA31=function(e){this.recognizer=e,this.decisionNumber=31,this.eot=JsFormulaCommaParserLexer.DFA31_eot,this.eof=JsFormulaCommaParserLexer.DFA31_eof,this.min=JsFormulaCommaParserLexer.DFA31_min,this.max=JsFormulaCommaParserLexer.DFA31_max,this.accept=JsFormulaCommaParserLexer.DFA31_accept,this.special=JsFormulaCommaParserLexer.DFA31_special,this.transition=JsFormulaCommaParserLexer.DFA31_transition},org.antlr.lang.extend(JsFormulaCommaParserLexer.DFA31,org.antlr.runtime.DFA,{getDescription:function(){return"1:1: Tokens : ( COLON | CONCATENATION | INTERSECT_ODS | AND | PLUS | PLUSEQUAL | MINUS | MINUSEQUAL | MULT | MULTEEQUAL | DIV | DIVEQUAL | P_OPEN | P_CLOSE | EQUAL | LESS | LESSEQUAL | GREATER | GREATEREQUAL | NOTEQUAL | NOTEQUAL2 | AMPERSAND | OR | POW | MODE | MODEQUAL | ARRAY_FORMULAR_START | ARRAY_FORMULAR_END | LOCALE_NUMBER | SINGLEQUOT_STRING | DOUBLEQUOT_STRING | ARG_SEP | FUNC | ERRORNAME | NAME | NAME1 | ODF_TABLE | INTERSECT | WHITESPACE );"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1);e=-1,n=="#"?e=59:n=="'"?e=61:n=="$"||n=="."||n>="0"&&n<="9"||n=="?"||n>="A"&&n<="Z"||n=="\\"||n=="_"||n>="a"&&n<="z"?e=60:n>="\0"&&n<="\f"||n>=""&&n<='"'||n>="%"&&n<="&"||n>="("&&n<="-"||n=="/"||n>=":"&&n<=">"||n=="@"||n=="["||n>="]"&&n<="^"||n=="`"||n>="{"&&n<="\u2027"||n>="\u202a"&&n<="\uffff"?e=62:e=28;if(e>=0)return e;break;case 1:var r=t.LA(1);e=-1;if(r=="R")e=66;else if(r>="\0"&&r<="\f"||r>=""&&r<="Q"||r>="S"&&r<="\u2027"||r>="\u202a"&&r<="\uffff")e=62;if(e>=0)return e;break;case 2:var i=t.LA(1);e=-1;if(i=="E")e=68;else if(i>="\0"&&i<="\f"||i>=""&&i<="D"||i>="F"&&i<="\u2027"||i>="\u202a"&&i<="\uffff")e=62;if(e>=0)return e;break;case 3:var s=t.LA(1);e=-1;if(s=="F")e=69;else if(s>="\0"&&s<="\f"||s>=""&&s<="E"||s>="G"&&s<="\u2027"||s>="\u202a"&&s<="\uffff")e=62;if(e>=0)return e;break;case 4:var o=t.LA(1);e=-1;if(o=="!")e=70;else if(o>="\0"&&o<="\f"||o>=""&&o<=" "||o>='"'&&o<="\u2027"||o>="\u202a"&&o<="\uffff")e=62;if(e>=0)return e;break;case 5:var u=t.LA(1);e=-1,u=="("?e=54:u=="E"?e=55:u>="#"&&u<="$"||u=="?"||u=="\\"?e=28:u>="a"&&u<="z"?e=27:u=="."?e=57:u>="\0"&&u<="\b"||u==""||u>=""&&u<=""||u>=""&&u<="\uffff"?e=31:u>="0"&&u<="9"?e=20:u=="'"?e=58:u>="A"&&u<="D"||u>="F"&&u<="Z"||u=="_"?e=25:e=56;if(e>=0)return e;break;case 6:var a=t.LA(1);e=-1,a>="0"&&a<="9"?e=65:a=="("?e=54:a>="A"&&a<="Z"||a=="_"?e=25:a>="#"&&a<="$"||a=="'"||a=="."||a=="?"||a=="\\"?e=28:a>="a"&&a<="z"?e=27:a>="\0"&&a<="\b"||a==""||a>=""&&a<=""||a>=""&&a<="\uffff"?e=31:e=56;if(e>=0)return e;break;case 7:var f=t.LA(1);e=-1,f>="0"&&f<="9"||f>="A"&&f<="Z"||f=="_"||f>="a"&&f<="z"?e=27:f>="\0"&&f<="\b"||f==""||f>=""&&f<=""||f>=""&&f<="\uffff"?e=31:e=28;if(e>=0)return e;break;case 8:var l=t.LA(1);e=-1;if(l==":")e=1;else if(l=="~")e=2;else if(l=="!")e=3;else if(l=="&")e=4;else if(l=="+")e=5;else if(l=="-")e=6;else if(l=="*")e=7;else if(l=="/")e=8;else if(l=="(")e=9;else if(l==")")e=10;else if(l=="=")e=11;else if(l=="<")e=12;else if(l==">")e=13;else if(l=="|")e=14;else if(l=="^")e=15;else if(l=="%")e=16;else if(l=="{")e=17;else if(l=="}")e=18;else if(l==".")e=19;else if(l>="0"&&l<="9")e=20;else if(l=="$")e=21;else if(l=="'")e=22;else if(l=='"')e=23;else if(l==","||l==";")e=24;else if(l>="A"&&l<="Z"||l=="_")e=25;else if(l=="#")e=26;else if(l>="a"&&l<="z")e=27;else if(l=="?"||l=="\\")e=28;else if(l=="\u00a0"||l=="\u3000")e=29;else if(l=="[")e=30;else if(l>="\0"&&l<="\b"||l==""||l>=""&&l<=""||l>=""&&l<="\u009f"||l>="\u00a1"&&l<="\u2fff"||l>="\u3001"&&l<="\uffff")e=31;else if(l==" ")e=32;else if(l>="	"&&l<="\n"||l>="\f"&&l<="\r")e=33;if(e>=0)return e;break;case 9:var c=t.LA(1);e=-1,c=="#"?e=59:c=="$"||c=="."||c>="0"&&c<="9"||c=="?"||c>="A"&&c<="Z"||c=="\\"||c=="_"||c>="a"&&c<="z"?e=60:c=="'"?e=61:c>="\0"&&c<="\f"||c>=""&&c<='"'||c>="%"&&c<="&"||c>="("&&c<="-"||c=="/"||c>=":"&&c<=">"||c=="@"||c=="["||c>="]"&&c<="^"||c=="`"||c>="{"&&c<="\u2027"||c>="\u202a"&&c<="\uffff"?e=62:e=28;if(e>=0)return e;break;case 10:var h=t.LA(1);e=-1,h=="("?e=54:h>="0"&&h<="9"||h>="A"&&h<="Z"||h=="_"?e=25:h>="a"&&h<="z"?e=27:h>="\0"&&h<="\b"||h==""||h>=""&&h<=""||h>=""&&h<="\uffff"?e=31:e=28;if(e>=0)return e;break;case 11:var p=t.LA(1);e=-1,p=="+"||p=="-"?e=56:p>="0"&&p<="9"?e=65:p=="("?e=54:p>="A"&&p<="Z"||p=="_"?e=25:p>="a"&&p<="z"?e=27:p>="\0"&&p<="\b"||p==""||p>=""&&p<=""||p>=""&&p<="\uffff"?e=31:e=28;if(e>=0)return e;break;case 12:var d=t.LA(1);e=-1,d>="\0"&&d<="\f"||d>=""&&d<="\u2027"||d>="\u202a"&&d<="\uffff"?e=62:e=28;if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),31,n,t);throw this.error(i),i},dummy:null})}();var JsFormulaCommaParserParser=function(e,t){t||(t=new org.antlr.runtime.RecognizerSharedState),function(){this.tokenList=[],this.intersectionStack=[],this.emitErrorMessage=function(e){throw console&&console.warn(e),"#ERROR!"}}.call(this),JsFormulaCommaParserParser.superclass.constructor.call(this,e,t),this.dfa9=new JsFormulaCommaParserParser.DFA9(this),this.dfa8=new JsFormulaCommaParserParser.DFA8(this),this.dfa36=new JsFormulaCommaParserParser.DFA36(this),this.dfa20=new JsFormulaCommaParserParser.DFA20(this),this.dfa35=new JsFormulaCommaParserParser.DFA35(this),this.dfa47=new JsFormulaCommaParserParser.DFA47(this),this.dfa52=new JsFormulaCommaParserParser.DFA52(this),this.state.ruleMemo={},this.adaptor=new org.antlr.runtime.tree.CommonTreeAdaptor};org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{ODF_TABLE:53,NAME1:39,LT:46,SPACE1:44,NAME:36,DIGIT:42,ARRAY_FORMULAR_END:31,NOTEQUAL2:24,EQUAL:18,DOUBLEQUOT_STRING:38,NUMSEP:45,LESS:19,PLUS:8,LESSEQUAL:20,MULTEEQUAL:13,MODE:28,P_CLOSE:17,KEYCHARACTER:48,MULT:12,ARG_SEP:33,AND:7,CONCATENATION:5,POW:27,PLUSEQUAL:9,COLON:4,SINGLEQUOT_STRING:34,NOTEQUAL:23,DIVEQUAL:15,ODF_COLUMN:49,MINUSEQUAL:11,FUNC:40,LOCALE_NUMBER:35,INT:43,ODF_COL_RANGE:50,MINUS:10,AMPERSAND:25,ARRAY_FORMULAR_START:30,P_OPEN:16,GREATER:21,EOF:-1,INTERSECT_ODS:6,ODF_PREWORD:51,OR:26,SPACE:55,COMMAOrSPACE:47,DIV:14,MODEQUAL:29,ODF_PRELIST:52,ERRORNAME:37,NONZERO_NUMBER:41,GREATEREQUAL:22,WHITESPACE:54,INTERSECT:32}),function(){var e=53,t=39,n=46,r=44,i=36,s=42,o=31,u=24,a=18,l=38,c=45,h=19,p=8,d=20,v=13,g=28,y=17,w=48,E=12,S=33,T=7,N=5,C=27,k=9,L=4,A=34,O=23,M=15,_=49,D=11,P=40,H=35,B=43,j=50,F=10,I=25,q=30,R=16,U=21,z=-1,W=6,X=51,V=26,$=55,J=47,K=14,Q=29,G=52,Y=37,Z=41,et=22,tt=54,nt=32;org.antlr.lang.extend(JsFormulaCommaParserParser,org.antlr.runtime.Parser,{setTreeAdaptor:function(e){this.adaptor=e},getTreeAdaptor:function(){return this.adaptor},getTokenNames:function(){return JsFormulaCommaParserParser.tokenNames},getGrammarFileName:function(){return"C:\\IBMDoc\\DocsSoruceCode\\com.ibm.docs.web.resources\\WebContent\\js\\parser\\JsFormulaCommaParser.g"}}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser.prototype,{prog_return:function(){JsFormulaCommaParserParser.prog_return=function(){},org.antlr.lang.extend(JsFormulaCommaParserParser.prog_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(
){return this.tree}});return}(),prog:function(){var e=new JsFormulaCommaParserParser.prog_return;e.start=this.input.LT(1);var t=this.input.index(),n=null,r=null,i=null,s=null,u=null,f=null,l=null,c=null,h=null,d=null,v=null,m=null,g=null,y=null,b=null,w=null,E=null;this.inConstArray=0;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,1))return e;var S=2,x=this.input.LA(1);if(x==a)S=1;else{if(x!=q){if(this.state.backtracking>0)return this.state.failed=!0,e;var T=new org.antlr.runtime.NoViableAltException("",4,0,this.input);throw T}S=2}switch(S){case 1:n=this.adaptor.nil(),r=this.match(this.input,a,JsFormulaCommaParserParser.FOLLOW_EQUAL_in_prog347);if(this.state.failed)return e;this.state.backtracking===0&&(v=this.adaptor.create(r),this.adaptor.addChild(n,v));var N=2,C=this.input.LA(1);C==nt&&(N=1);switch(N){case 1:i=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_prog349);if(this.state.failed)return e;this.state.backtracking===0&&(m=this.adaptor.create(i),this.adaptor.addChild(n,m))}var k=0;e:do{var L=2,O=this.input.LA(1);if(O==p||O==F||O==R||O==q||O>=A&&O<=P)L=1;switch(L){case 1:this.pushFollow(JsFormulaCommaParserParser.FOLLOW_expr_in_prog352),h=this.expr(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,h.getTree());break;default:if(k>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,e;var M=new org.antlr.runtime.EarlyExitException(2,this.input);throw M}k++}while(!0);this.state.backtracking===0,s=this.match(this.input,z,JsFormulaCommaParserParser.FOLLOW_EOF_in_prog357);if(this.state.failed)return e;this.state.backtracking===0&&(g=this.adaptor.create(s),this.adaptor.addChild(n,g));break;case 2:n=this.adaptor.nil(),u=this.match(this.input,q,JsFormulaCommaParserParser.FOLLOW_ARRAY_FORMULAR_START_in_prog363);if(this.state.failed)return e;this.state.backtracking===0&&(y=this.adaptor.create(u),this.adaptor.addChild(n,y)),f=this.match(this.input,a,JsFormulaCommaParserParser.FOLLOW_EQUAL_in_prog365);if(this.state.failed)return e;this.state.backtracking===0&&(b=this.adaptor.create(f),this.adaptor.addChild(n,b)),this.state.backtracking===0;var _=0;t:do{var D=2,H=this.input.LA(1);if(H==p||H==F||H==R||H==q||H>=A&&H<=P)D=1;switch(D){case 1:this.pushFollow(JsFormulaCommaParserParser.FOLLOW_expr_in_prog377),d=this.expr(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,d.getTree());break;default:if(_>=1)break t;if(this.state.backtracking>0)return this.state.failed=!0,e;var M=new org.antlr.runtime.EarlyExitException(3,this.input);throw M}_++}while(!0);this.state.backtracking===0,l=this.match(this.input,o,JsFormulaCommaParserParser.FOLLOW_ARRAY_FORMULAR_END_in_prog382);if(this.state.failed)return e;this.state.backtracking===0&&(w=this.adaptor.create(l),this.adaptor.addChild(n,w)),c=this.match(this.input,z,JsFormulaCommaParserParser.FOLLOW_EOF_in_prog384);if(this.state.failed)return e;this.state.backtracking===0&&(E=this.adaptor.create(c),this.adaptor.addChild(n,E))}e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(n),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(B){if(!(B instanceof org.antlr.runtime.RecognitionException))throw B;this.reportError(B),this.recover(this.input,B),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),B)}finally{this.state.backtracking>0&&this.memoize(this.input,1,t)}return e},expr_return:function(){JsFormulaCommaParserParser.expr_return=function(){},org.antlr.lang.extend(JsFormulaCommaParserParser.expr_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),expr:function(){var e=new JsFormulaCommaParserParser.expr_return;e.start=this.input.LT(1);var t=this.input.index(),n=null,r=null,i=null,s=null,o=null,f=null,l=null,c=null,h=null,p=null,d=null;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,2))return e;n=this.adaptor.nil(),this.pushFollow(JsFormulaCommaParserParser.FOLLOW_atom_in_expr407),f=this.atom(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,f.getTree());var v=2,m=this.input.LA(1);if(m==nt){var y=this.input.LA(2);this.synpred5_JsFormulaCommaParser()&&(v=1)}switch(v){case 1:r=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_expr423);if(this.state.failed)return e;this.state.backtracking===0&&(c=this.adaptor.create(r),this.adaptor.addChild(n,c));if(this.state.backtracking===0&&this.bLocaleSensitive){var b=new websheet.parse.referenceToken(r?r.getText():null,r.getStartIndex());this.tokenList.push(b),this.intersectionStack.push(this.tokenList.length-1)}}e:do{var w=2,E=this.input.LA(1);E==g&&(w=1);switch(w){case 1:s=this.match(this.input,g,JsFormulaCommaParserParser.FOLLOW_MODE_in_expr435);if(this.state.failed)return e;this.state.backtracking===0&&(p=this.adaptor.create(s),this.adaptor.addChild(n,p));if(this.state.backtracking===0&&this.bLocaleSensitive){var b=new websheet.parse.referenceToken(s?s.getText():null,s.getStartIndex());this.tokenList.push(b)}break;default:break e}}while(!0);t:do{var x=2;x=this.dfa9.predict(this.input);switch(x){case 1:var k=2;k=this.dfa8.predict(this.input);switch(k){case 1:i=this.input.LT(1);if(!(this.input.LA(1)>=L&&this.input.LA(1)<=N||this.input.LA(1)>=T&&this.input.LA(1)<=M||this.input.LA(1)>=a&&this.input.LA(1)<=u||this.input.LA(1)==C||this.input.LA(1)==Q||this.input.LA(1)==S)){if(this.state.backtracking>0)return this.state.failed=!0,e;var A=new org.antlr.runtime.MismatchedSetException(null,this.input);throw A}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(n,this.adaptor.create(i)),this.state.errorRecovery=!1,this.state.failed=!1;if(this.state.backtracking===0&&this.bLocaleSensitive){var b=new websheet.parse.referenceToken(i?i.getText():null,i.getStartIndex());this.tokenList.push(b);if(this.bMS)if((i?i.getText():null)=="~")this.errTokenList.push(b);else if(this.inFunc===0)if((i?i.getText():null)==this.sepChar){var O=this.tokenList[this.tokenList.length-2];O&&(O._type=="range"||O._type=="cell"||O._type=="namerange"||O._type=="reffunct"&&websheet.functions.Util.getErrPropByName(O.getChangedText())&websheet.Constant.CellErrProp.RETURN_REF)&&b.setChangedText("~")}else if((i?i.getText():null)==";"&&this.inConstArray===0){if(!this.bAutoCorrect)throw"separator error!";b.setType(websheet.Constant.FormulaTokenType.ARG_SEP),b.setChangedText(this.sepChar),this.errTokenList.push(b)}}var _=2,D=this.input.LA(1);D==nt&&(_=1);switch(_){case 1:o=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_expr518);if(this.state.failed)return e;this.state.backtracking===0&&(d=this.adaptor.create(o),this.adaptor.addChild(n,d))}}this.pushFollow(JsFormulaCommaParserParser.FOLLOW_expr_in_expr531),l=this.expr(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,l.getTree());if(this.state.backtracking===0){if(!i&&!r)throw"Error Syntax";e.value=l!==null?l.value:null;if(r&&!i){var P=this.tokenList.length,H=this.intersectionStack[this.intersectionStack.length-1];if(P>1&&this.bLocaleSensitive&&H){var B=this.tokenList[H];if(B&&B.getText().replace(/[ ]+/ig," ")==" "){var j=!1,O=this.tokenList[H-1];O&&(O._type=="range"||O._type=="cell"||O._type=="namerange"||O._type=="reffunct"&&websheet.functions.Util.getErrPropByName(O.getChangedText())&websheet.Constant.CellErrProp.RETURN_REF)&&(j=!0);var F=!1,I=this.tokenList[H+1];if(I&&I._text=="leftbrace"||I._text=="leftfuncbrace")I=this.tokenList[H+2];I&&(I._type=="range"||I._type=="cell"||I._type=="namerange"||I._type=="reffunct"&&websheet.functions.Util.getErrPropByName(I.getChangedText())&websheet.Constant.CellErrProp.RETURN_REF)&&(F=!0),j&&F?(B.setType(websheet.parse.tokenType.OPERATOR_TOKEN),B.setChangedText("!")):this.errTokenList.push(B)}}}}break;default:break t}}while(!0);this.state.backtracking===0&&r&&this.intersectionStack.pop(),e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(n),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(q){if(!(q instanceof org.antlr.runtime.RecognitionException))throw q;this.reportError(q),this.recover(this.input,q),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),q)}finally{this.state.backtracking>0&&this.memoize(this.input,2,t)}return e},atom_return:function(){JsFormulaCommaParserParser.atom_return=function(){},org.antlr.lang.extend(JsFormulaCommaParserParser.atom_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),atom:function(){var e=new JsFormulaCommaParserParser.atom_return;e.start=this.input.LT(1);var n=this.input.index(),r=null,s=null,u=null,a=null,f=null,c=null,h=null,d=null,v=null,m=null,g=null,b=null,w=null,E=null,x=null,T=null,N=null,C=null,k=null,O=null,M=null,_=null,D=null,B=null,j=null,I=null,U=null,z=null,X=null,V=null,$=null,J=null,K=null,Q=null,G=null,Z=null,et=null,tt=null,rt=null,it=null,st=null,ot=null,ut=null,at=null,ft=null,lt=null,ct=null,ht=null,pt=null,dt=null,vt=null,mt=null,gt=null,yt=null,bt=null,wt=null,Et=null,St=null,xt=null,Tt=null,Nt=null,Ct=null;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,3))return e;var kt=9;kt=this.dfa36.predict(this.input);switch(kt){case 1:r=this.adaptor.nil(),D=this.match(this.input,F,JsFormulaCommaParserParser.FOLLOW_MINUS_in_atom561);if(this.state.failed)return e;this.state.backtracking===0&&(wt=this.adaptor.create(D),this.adaptor.addChild(r,wt));var Lt=2,At=this.input.LA(1);At==nt&&(Lt=1);switch(Lt){case 1:B=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom563);if(this.state.failed)return e;this.state.backtracking===0&&(Et=this.adaptor.create(B),this.adaptor.addChild(r,Et))}this.pushFollow(JsFormulaCommaParserParser.FOLLOW_atom_in_atom569),V=this.atom(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,V.getTree()),this.state.backtracking===0;break;case 2:r=this.adaptor.nil(),j=this.match(this.input,p,JsFormulaCommaParserParser.FOLLOW_PLUS_in_atom576);if(this.state.failed)return e;this.state.backtracking===0&&(St=this.adaptor.create(j),this.adaptor.addChild(r,St));var Ot=2,Mt=this.input.LA(1);Mt==nt&&(Ot=1);switch(Ot){case 1:I=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom578);if(this.state.failed)return e;this.state.backtracking===0&&(xt=this.adaptor.create(I),this.adaptor.addChild(r,xt))}this.pushFollow(JsFormulaCommaParserParser.FOLLOW_atom_in_atom584),V=this.atom(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,V.getTree()),this.state.backtracking===0;break;case 3:r=this.adaptor.nil();var _t=2,Dt=this.input.LA(1);if(Dt==H){var Pt=this.input.LA(2);Pt==W&&(_t=1)}else Dt==A&&(_t=1);switch(_t){case 1:s=this.input.LT(1);if(!(this.input.LA(1)>=A&&this.input.LA(1)<=H)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(s)),this.state.errorRecovery=!1,this.state.failed=!1,u=this.match(this.input,W,JsFormulaCommaParserParser.FOLLOW_INTERSECT_ODS_in_atom612);if(this.state.failed)return e;this.state.backtracking===0&&(Z=this.adaptor.create(u),this.adaptor.addChild(r,Z));var Bt=2,jt=this.input.LA(1);jt==nt&&(Bt=1);switch(Bt){case 1:a=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom617);if(this.state.failed)return e;this.state.backtracking===0&&(et=this.adaptor.create(a),this.adaptor.addChild(r,et))}}f=this.match(this.input,H,JsFormulaCommaParserParser.FOLLOW_LOCALE_NUMBER_in_atom625);if(this.state.failed)return e;this.state.backtracking===0&&(tt=this.adaptor.create(f),this.adaptor.addChild(r,tt)),c=this.match(this.input,L,JsFormulaCommaParserParser.FOLLOW_COLON_in_atom629);if(this.state.failed)return e;this.state.backtracking===0&&(rt=this.adaptor.create(c),this.adaptor.addChild(r,rt)),h=this.input.LT(1);if(!(this.input.LA(1)>=H&&this.input.LA(1)<=i)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(h)),this.state.errorRecovery=!1,this.state.failed=!1;if(this.state.backtracking===0&&!this.bNotParseRef){var Ft="",It="";if(s?s.getText():null){Ft+=s?s.getText():null,It+=s?s.getText():null,Ft+=u?u.getText():null,It+=u?u.getText():null;if(a?a.getText():null)It+=a?a.getText():null}Ft+=f.getText().trim(),It+=f.getText(),Ft+=c?c.getText():null,It+=c?c.getText():null,Ft+=(h?h.getText():null).trim(),It+=h?h.getText():null;var J=websheet.event.FormulaHelper.generateToken(Ft,this.bMS,this.bAutoCorrect,this.errTokenList);J&&((s?s.getText():null)?J.setIndex(s.getStartIndex()):J.setIndex(f.getStartIndex()),J.getType()==websheet.Constant.FormulaTokenType.SHEET_SEP?this.errTokenList.push(J):(J.setTextOnly(It),this.tokenList.push(J)))}break;case 4:r=this.adaptor.nil(),f=this.input.LT(1);if(!(this.input.LA(1)>=A&&this.input.LA(1)<=H)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(f)),this.state.errorRecovery=!1,this.state.failed=!1;var qt=2,Rt=this.input.LA(1);Rt==W&&(qt=1);switch(qt){case 1:u=this.match(this.input,W,JsFormulaCommaParserParser.FOLLOW_INTERSECT_ODS_in_atom690);if(this.state.failed)return e;this.state.backtracking===0&&(Z=this.adaptor.create(u),this.adaptor.addChild(r,Z));var Ut=2,zt=this.input.LA(1);zt==nt&&(Ut=1);switch(Ut){case 1:a=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom695);if(this.state.failed)return e;this.state.backtracking===0&&(et=this.adaptor.create(a),this.adaptor.addChild(r,et))}d=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=Y)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(d)),this.state.errorRecovery=!1,this.state.failed=!1;var Wt=2,Xt=this.input.LA(1);if(Xt==nt){var Vt=this.input.LA(2);this.synpred42_JsFormulaCommaParser()&&(Wt=1)}switch(Wt){case 1:v=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom710);if(this.state.failed)return e;this.state.backtracking===0&&(ot=this.adaptor.create(v),this.adaptor.addChild(r,ot))}}var $t=2;$t=this.dfa20.predict(this.input);switch($t){case 1:c=this.match(this.input,L,JsFormulaCommaParserParser.FOLLOW_COLON_in_atom720);if(this.state.failed)return e;this.state.backtracking===0&&(rt=this.adaptor.create(c),this.adaptor.addChild(r,rt));var Jt=2,Kt=this.input.LA(1);if(Kt==nt||Kt>=A&&Kt<=H)Jt=1;switch(Jt){case 1:var Qt=2,Gt=this.input.LA(1);Gt==nt&&(Qt=1);switch(Qt){case 1:m=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom726);if(this.state.failed)return e;this.state.backtracking===0&&(ut=this.adaptor.create(m),this.adaptor.addChild(r,ut))}g=this.input.LT(1);if(!(this.input.LA(1)>=A&&this.input.LA(1)<=H)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(g)),this.state.errorRecovery=!1,this.state.failed=!1,b=this.match(this.input,W,JsFormulaCommaParserParser.FOLLOW_INTERSECT_ODS_in_atom740);if(this.state.failed)return e;this.state.backtracking===0&&(ft=this.adaptor.create(b),this.adaptor.addChild(r,ft));var Yt=2,Zt=this.input.LA(1);Zt==nt&&(Yt=1);switch(Yt){case 1:w=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom745);if(this.state.failed)return e;this.state.backtracking===0&&(lt=this.adaptor.create(w),this.adaptor.addChild(r,lt))}}h=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=Y)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(h)),this.state.errorRecovery=!1,this.state.failed=!1}if(this.state.backtracking===0)if(!this.bNotParseRef&&(u?u.getText():null)){var Ft=f.getText(),It=Ft;if(u?u.getText():null){Ft+=u?u.getText():null,It+=u?u.getText():null;if(a?a.getText():null)It+=a?a.getText():null;Ft+=d?d.getText():null,It+=d?d.getText():null;if(v?v.getText():null)It+=v?v.getText():null}if(c?c.getText():null){Ft+=c?c.getText():null,It+=c?c.getText():null;if(m?m.getText():null)It+=m?m.getText():null;if(b?b.getText():null){Ft+=(g?g.getText():null).trim(),It+=g?g.getText():null,Ft+=b?b.getText():null,It+=b?b.getText():null;if(w?w.getText():null)It+=w?w.getText():null}Ft+=(h?h.getText():null).trim(),It+=h?h.getText():null}var J=websheet.event.FormulaHelper.generateToken(Ft,this.bMS,this.bAutoCorrect,this.errTokenList);J&&(J.getType()==websheet.Constant.FormulaTokenType.SHEET_SEP?(J.setIndex(u.getStartIndex()),this.errTokenList.push(J)):(J.setIndex(f.getStartIndex()),J.setTextOnly(It),this.tokenList.push(J)))}else if(this.bLocaleSensitive){var Ft=f.getText(),J=new websheet.parse.referenceToken(Ft,f.getStartIndex(),"number"),en=websheet.i18n.numberRecognizer.parse(J.getText(),!0);if(en.isNumber){if(en.formatType==websheet.Constant.FormatType["NUMBER"]||en.formatType==websheet.Constant.FormatType["PERCENT"]||en.formatType==websheet.Constant.FormatType["SCIENTIFIC"]){fValue=en.fValue;if(this.bMS){if(!this.group){var tn=dojo.i18n.getLocalization("dojo.cldr","number",this.locale);this.group=tn.group}if(Ft.indexOf(this.group)>-1)this.errTokenList.push(J);else{if(en.formatType==websheet.Constant.FormatType["NUMBER"]||en.formatType==websheet.Constant.FormatType["SCIENTIFIC"])J.setChangedText(fValue);else{var nn=en.percentageNum,rn=websheet.Math.mul(fValue,websheet.Math.pow(100,nn));for(var sn=0;sn<nn;sn++)rn+="%";J.setChangedText(rn)}this.tokenList.push(J)}}else en.formatType==websheet.Constant.FormatType["NUMBER"]||en.formatType==websheet.Constant.FormatType["SCIENTIFIC"]?J.setChangedText(fValue):J.setChangedText(websheet.Math.mul(fValue,100)+"%"),this.tokenList.push(J)}}else(websheet.Helper.isNumeric(Ft)||websheet.Helper.isPercent(Ft))&&this.errTokenList.push(J)}break;case 5:r=this.adaptor.nil(),f=this.match(this.input,l,JsFormulaCommaParserParser.FOLLOW_DOUBLEQUOT_STRING_in_atom769);if(this.state.failed)return e;this.state.backtracking===0&&(tt=this.adaptor.create(f),this.adaptor.addChild(r,tt)),this.state.backtracking===0;break;case 6:r=this.adaptor.nil(),E=this.match(this.input,R,JsFormulaCommaParserParser.FOLLOW_P_OPEN_in_atom783);if(this.state.failed)return e;this.state.backtracking===0&&(ct=this.adaptor.create(E),this.adaptor.addChild(r,ct));if(this.state.backtracking===0&&this.bLocaleSensitive){var J=new websheet.parse.referenceToken("leftbrace",E.getStartIndex());this.tokenList.push(J)}var on=2,un=this.input.LA(1);un==nt&&(on=1);switch(on){case 1:U=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom799);if(this.state.failed)return e;this.state.backtracking===0&&(Tt=this.adaptor.create(U),this.adaptor.addChild(r,Tt))}this.pushFollow(JsFormulaCommaParserParser.FOLLOW_expr_in_atom808),K=this.expr(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,K.getTree());var an=2,fn=this.input.LA(1);fn==nt&&(an=1);switch(an){case 1:z=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom815);if(this.state.failed)return e;this.state.backtracking===0&&(Nt=this.adaptor.create(z),this.adaptor.addChild(r,Nt))}x=this.match(this.input,y,JsFormulaCommaParserParser.FOLLOW_P_CLOSE_in_atom822);if(this.state.failed)return e;this.state.backtracking===0&&(ht=this.adaptor.create(x),this.adaptor.addChild(r,ht));if(this.state.backtracking===0&&this.bLocaleSensitive){var ln=this.tokenList.length;if(ln>0){var cn=ln-1,hn=this.tokenList[cn];hn.getText().replace(/[ ]+/ig," ")==" "&&this.tokenList.pop()}if(ln>1){var pn=ln-2,dn=this.tokenList[pn],O;while(dn){O=pn>=0?dn.getText():null;if(O=="leftbrace"){this.tokenList.splice(pn,1);break}O=dn.getText().replace(/[ ]+/ig," ");if(O!=","||dn._changedText==";"){pn--,dn=this.tokenList[pn],O=pn>0?dn.getText():null;continue}dn.setType(websheet.parse.tokenType.OPERATOR_TOKEN),dn.setChangedText("~"),pn--,dn=this.tokenList[pn],O=pn>0?dn.getText():null}}}break;case 7:r=this.adaptor.nil(),this.pushFollow(JsFormulaCommaParserParser.FOLLOW_folded_in_atom832),Q=this.folded(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,Q.getTree()),this.state.backtracking===0;break;case 8:r=this.adaptor.nil(),T=this.match(this.input,q,JsFormulaCommaParserParser.FOLLOW_ARRAY_FORMULAR_START_in_atom858);if(this.state.failed)return e;this.state.backtracking===0&&(pt=this.adaptor.create(T),this.adaptor.addChild(r,pt));var vn=2,mn=this.input.LA(1);if(mn==nt){var gn=this.input.LA(2);this.synpred56_JsFormulaCommaParser()&&(vn=1)}switch(vn){case 1:N=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom863);if(this.state.failed)return e;this.state.backtracking===0&&(dt=this.adaptor.create(N),this.adaptor.addChild(r,dt))}if(this.state.backtracking===0){this.inConstArray++;var yn={};yn.firColLen=0,yn.colLen=0,yn.rowLen=0,yn.text="{",yn.changedText="{";if(N?N.getText():null)yn.text+=N?N.getText():null;var bn=this.tokenList.length}var wn=2,En=this.input.LA(1);if(En==p||En==F||En==R||En==q||En>=A&&En<=P)wn=1;switch(wn){case 1:this.pushFollow(JsFormulaCommaParserParser.FOLLOW_atom_in_atom878),$=this.atom(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,$.getTree());if(this.state.backtracking===0)var Sn=this.input.getTokenSource(),xn=websheet.event.FormulaHelper.getArraySepByLocale(),Tn=websheet.event.FormulaHelper.isConstArray($,Sn,yn,xn);e:do{var Nn=2,Cn=this.input.LA(1);if(Cn==nt){var kn=this.input.LA(2);kn==S&&(Nn=1)}else Cn==S&&(Nn=1);switch(Nn){case 1:var Ln=2,An=this.input.LA(1);An==nt&&(Ln=1);switch(Ln){case 1:a=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom894);if(this.state.failed)return e;this.state.backtracking===0&&(et=this.adaptor.create(a),this.adaptor.addChild(r,et))}C=this.match(this.input,S,JsFormulaCommaParserParser.FOLLOW_ARG_SEP_in_atom900);if(this.state.failed)return e;this.state.backtracking===0&&(vt=this.adaptor.create(C),this.adaptor.addChild(r,vt));var On=2,Mn=this.input.LA(1);Mn==nt&&(On=1);switch(On){case 1:v=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom905);if(this.state.failed)return e;this.state.backtracking===0&&(ot=this.adaptor.create(v),this.adaptor.addChild(r,ot))}if(this.state.backtracking===0&&Tn){if(a?a.getText():null)yn.text+=a?a.getText():null,a=null;var _n=C.getText();yn.text+=_n;if(_n==",")yn.rowLen==0?yn.firColLen++:yn.colLen++,yn.changedText+=";";else{if(yn.rowLen&&yn.colLen!=yn.firColLen)throw websheet.Constant.ERRORCODE[512];yn.colLen=0,yn.rowLen++,yn.changedText+="|"}if(v?v.getText():null)yn.text+=v?v.getText():null,v=null}this.pushFollow(JsFormulaCommaParserParser.FOLLOW_atom_in_atom921),J=this.atom(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(r,J.getTree()),this.state.backtracking===0&&Tn&&(Tn=websheet.event.FormulaHelper.isConstArray(J,Sn,yn,xn));break;default:break e}}while(!0)}var Dn=2,Pn=this.input.LA(1);Pn==nt&&(Dn=1);switch(Dn){case 1:m=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom938);if(this.state.failed)return e;this.state.backtracking===0&&(ut=this.adaptor.create(m),this.adaptor.addChild(r,ut))}X=this.match(this.input,o,JsFormulaCommaParserParser.FOLLOW_ARRAY_FORMULAR_END_in_atom942);if(this.state.failed)return e;this.state.backtracking===0&&(Ct=this.adaptor.create(X),this.adaptor.addChild(r,Ct));if(this.state.backtracking===0){var Hn=this.tokenList.length;for(var sn=bn;sn<Hn;sn++)this.tokenList.pop();if(m?m.getText():null)yn.text+=m?m.getText():null;this.inConstArray--,yn.rowLen&&yn.firColLen!=yn.colLen&&(Tn=!1);var Bn=T.getStartIndex();if(Tn){var J=new websheet.parse.referenceToken(yn.text,Bn);J.setChangedText(yn.changedText),J.setType(websheet.Constant.FormulaTokenType.ARG_SEP),this.tokenList.push(J)}else{var jn=new websheet.parse.referenceToken("error constant",Bn);this.errTokenList.push(jn)}}break;case 9:r=this.adaptor.nil(),k=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=Y||this.input.LA(1)==t)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(k)),this.state.errorRecovery=!1,this.state.failed=!1;var Fn=2,In=this.input.LA(1);In==W&&(Fn=1);switch(Fn){case 1:O=this.match(this.input,W,JsFormulaCommaParserParser.FOLLOW_INTERSECT_ODS_in_atom997);if(this.state.failed)return e;this.state.backtracking===0&&(gt=this.adaptor.create(O),this.adaptor.addChild(r,gt));var qn=2,Rn=this.input.LA(1);Rn==nt&&(qn=1);switch(qn){case 1:a=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom1002);if(this.state.failed)return e;this.state.backtracking===0&&(et=this.adaptor.create(a),this.adaptor.addChild(r,et))}d=this.input.LT(1);if(!(this.input.LA(1)>=H&&this.input.LA(1)<=Y)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(d)),this.state.errorRecovery=!1,this.state.failed=!1;var Un=2,zn=this.input.LA(1);if(zn==nt){var Wn=this.input.LA(2);this.synpred68_JsFormulaCommaParser()&&(Un=1)}switch(Un){case 1:v=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom1019);if(this.state.failed)return e;this.state.backtracking===0&&(ot=this.adaptor.create(v),this.adaptor.addChild(r,ot))}}var Xn=2;Xn=this.dfa35.predict(this.input);switch(Xn){case 1:u=this.match(this.input,L,JsFormulaCommaParserParser.FOLLOW_COLON_in_atom1029);if(this.state.failed)return e;this.state.backtracking===0&&(Z=this.adaptor.create(u),this.adaptor.addChild(r,Z));var Vn=2,$n=this.input.LA(1);if($n==nt||$n==t)Vn=1;else if($n==i){var Jn=this.input.LA(2);Jn==W&&(Vn=1)}switch(Vn){case 1:var Kn=2,Qn=this.input.LA(1);Qn==nt&&(Kn=1);switch(Kn){case 1:m=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom1035);if(this.state.failed)return e;this.state.backtracking===0&&(ut=this.adaptor.create(m),this.adaptor.addChild(r,ut))}M=this.input.LT(1);if(this.input.LA(1)!=i&&this.input.LA(1)!=t){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(M)),this.state.errorRecovery=!1,this.state.failed=!1,_=this.match(this.input,W,JsFormulaCommaParserParser.FOLLOW_INTERSECT_ODS_in_atom1049);if(this.state.failed)return e;this.state.backtracking===0&&(bt=this.adaptor.create(_),this.adaptor.addChild(r,bt));var Gn=2,Yn=this.input.LA(1);Yn==nt&&(Gn=1);switch(Gn){case 1:w=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom1054);if(this.state.failed)return e;this.state.backtracking===0&&(lt=this.adaptor.create(w),this.adaptor.addChild(r,lt))}}h=this.input.LT(1);if(!(this.input.LA(1)>=H&&this.input.LA(1)<=Y)){if(this.state.backtracking>0)return this.state.failed=!0,e;var Ht=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ht}this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(r,this.adaptor.create(h)),this.state.errorRecovery=!1,this.state.failed=!1}if(this.state.backtracking===0)if(this.bMS&&!this.bNotParseRef){var Ft=k?k.getText():null,It=Ft;if(d?d.getText():null){Ft+="!",It+="!";if(a?a.getText():null)It+=a?a.getText():null;Ft+=d?d.getText():null,It+=d?d.getText():null;if(v?v.getText():null)It+=v?v.getText():null}if(u?u.getText():null){Ft+=u?u.getText():null,It+=u?u.getText():null;if(_?_.getText():null){if(m?m.getText():null)It+=m?m.getText():null;Ft+=M?M.getText():null,It+=M?M.getText():null,Ft+=_?_.getText():null,It+=_?_.getText():null;if(w?w.getText():null)It+=w?w.getText():null}Ft+=h?h.getText():null,It+=h?h.getText():null}var J=websheet.event.FormulaHelper.generateToken(Ft,this.bMS,this.bAutoCorrect,this.errTokenList);if(J)if(J.getType()==websheet.Constant.FormulaTokenType.SHEET_SEP){var cn=Ft.split(":")[0].lastIndexOf(J.getText());J.setIndex(k.getStartIndex()+cn),this.errTokenList.push(J)}else{var Zn=k.getStartIndex();J.setTextOnly(It),J.setIndex(Zn),this.tokenList.push(J)}}else{var Ft=k?k.getText():null,It=Ft,J,cn;this.bNotParseRef||(J=websheet.event.FormulaHelper.generateToken(k?k.getText():null,this.bMS,this.bAutoCorrect,this.errTokenList),J&&(J.setIndex(k.getStartIndex()),this.tokenList.push(J)));if(O?O.getText():null)this.bLocaleSensitive&&(J=new websheet.parse.referenceToken(O?O.getText():null,O.getStartIndex()),this.tokenList.push(J)),this.bNotParseRef||(J=websheet.event.FormulaHelper.generateToken(d?d.getText():null,this.bMS,this.bAutoCorrect,this.errTokenList),J&&(J.setIndex(d.getStartIndex()),this.tokenList.push(J)));if(u?u.getText():null){this.bNotParseRef||this.tokenList.pop(),(O?O.getText():null)?(Ft=d?d.getText():null,It=d?d.getText():null,cn=d.getStartIndex()):(Ft=k?k.getText():null,It=k?k.getText():null,cn=k.getStartIndex());if(v?v.getText():null)It+=v?v.getText():null;Ft+=u?u.getText():null,It+=u?u.getText():null;if(_?_.getText():null){if(m?m.getText():null)It+=m?m.getText():null;Ft+=M?M.getText():null,It+=M?M.getText():null,this.bNotParseRef||(J=websheet.event.FormulaHelper.generateToken(Ft,this.bMS,this.bAutoCorrect,this.errTokenList),J&&(J.setIndex(cn),J.setTextOnly(It),this.tokenList.push(J))),this.bLocaleSensitive&&(J=new websheet.parse.referenceToken(_?_.getText():null,_.getStartIndex()),this.tokenList.push(J))}else{if(w?w.getText():null)It+=w?w.getText():null;Ft+=h?h.getText():null,It+=h?h.getText():null,this.bNotParseRef||(J=websheet.event.FormulaHelper.generateToken(Ft,this.bMS,this.bAutoCorrect,this.errTokenList),J&&(J.setIndex(cn),J.setTextOnly(It),this.tokenList.push(J)))}}}}e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(r),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(er){if(!(er instanceof org.antlr.runtime.RecognitionException))throw er;this.reportError(er),this.recover(this.input,er),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),er)}finally{this.state.backtracking>0&&this.memoize(this.input,3,n)}return e},atom_list_return:function(){JsFormulaCommaParserParser.atom_list_return=function(){},org.antlr.lang.extend(JsFormulaCommaParserParser.atom_list_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),atom_list:function(){var e=new JsFormulaCommaParserParser.atom_list_return;e.start=this.input.LT(1);var t=this.input.index(),n=null,r=null,i=null,s=null,o=null,u=null,a=null,f=null,l=null;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,4))return e;n=this.adaptor.nil(),this.pushFollow(JsFormulaCommaParserParser.FOLLOW_atom_type_in_atom_list1091),o=this.atom_type(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,o.getTree()),this.state.backtracking===0;e:do{var c=2,h=this.input.LA(1);if(h==nt){var p=this.input.LA(2);p==S&&(c=1)}else h==S&&(c=1);switch(c){case 1:var d=2,v=this.input.LA(1);v==nt&&(d=1);switch(d){case 1:i=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom_list1099);if(this.state.failed)return e;this.state.backtracking===0&&(f=this.adaptor.create(i),this.adaptor.addChild(n,f))}r=this.match(this.input,S,JsFormulaCommaParserParser.FOLLOW_ARG_SEP_in_atom_list1104);if(this.state.failed)return e;this.state.backtracking===0&&(a=this.adaptor.create(r),this.adaptor.addChild(n,a));var m=2,g=this.input.LA(1);if(g==nt){var y=this.input.LA(2);this.synpred78_JsFormulaCommaParser()&&(m=1)}switch(m){case 1:s=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_atom_list1106);if(this.state.failed)return e;this.state.backtracking===0&&(l=this.adaptor.create(s),this.adaptor.addChild(n,l))}if(this.state
.backtracking===0&&this.bMS&&this.bLocaleSensitive){var b=new websheet.parse.referenceToken(r?r.getText():null,r.getStartIndex());this.tokenList.push(b)}this.pushFollow(JsFormulaCommaParserParser.FOLLOW_atom_type_in_atom_list1113),u=this.atom_type(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,u.getTree()),this.state.backtracking===0;break;default:break e}}while(!0);e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(n),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(w){if(!(w instanceof org.antlr.runtime.RecognitionException))throw w;this.reportError(w),this.recover(this.input,w),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),w)}finally{this.state.backtracking>0&&this.memoize(this.input,4,t)}return e},atom_type_return:function(){JsFormulaCommaParserParser.atom_type_return=function(){},org.antlr.lang.extend(JsFormulaCommaParserParser.atom_type_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),atom_type:function(){var e=new JsFormulaCommaParserParser.atom_type_return;e.start=this.input.LT(1);var t=this.input.index(),n=null,r=null;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,5))return e;var i=2,s=this.input.LA(1);if(s==p||s==F||s==R||s==q||s>=A&&s<=P)i=1;else{if(!(s==z||s==y||s>=nt&&s<=S)){if(this.state.backtracking>0)return this.state.failed=!0,e;var o=new org.antlr.runtime.NoViableAltException("",40,0,this.input);throw o}i=2}switch(i){case 1:n=this.adaptor.nil(),this.pushFollow(JsFormulaCommaParserParser.FOLLOW_expr_in_atom_type1141),r=this.expr(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,r.getTree()),this.state.backtracking===0;break;case 2:n=this.adaptor.nil(),this.state.backtracking===0}e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(n),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(u){if(!(u instanceof org.antlr.runtime.RecognitionException))throw u;this.reportError(u),this.recover(this.input,u),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),u)}finally{this.state.backtracking>0&&this.memoize(this.input,5,t)}return e},folded_return:function(){JsFormulaCommaParserParser.folded_return=function(){},org.antlr.lang.extend(JsFormulaCommaParserParser.folded_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),folded:function(){var e=new JsFormulaCommaParserParser.folded_return;e.start=this.input.LT(1);var t=this.input.index(),n=null,r=null,s=null,o=null,u=null,a=null,f=null,l=null,c=null,h=null,d=null,v=null,m=null,g=null,b=null,w=null;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,6))return e;var E=2,S=this.input.LA(1);if(S==P){var x=this.input.LA(2);if(x==y){var T=this.input.LA(3);this.synpred84_JsFormulaCommaParser()?E=1:E=2}else{if(!(x==p||x==F||x==R||x==q||x>=nt&&x<=P)){if(this.state.backtracking>0)return this.state.failed=!0,e;var N=new org.antlr.runtime.NoViableAltException("",46,1,this.input);throw N}E=1}}else{if(S!=i){if(this.state.backtracking>0)return this.state.failed=!0,e;var N=new org.antlr.runtime.NoViableAltException("",46,0,this.input);throw N}var C=this.input.LA(2);if(C==R){var k=this.input.LA(3);if(k==p||k==F||k==R||k==q||k>=nt&&k<=P)E=1;else{if(k!=y){if(this.state.backtracking>0)return this.state.failed=!0,e;var N=new org.antlr.runtime.NoViableAltException("",46,5,this.input);throw N}var T=this.input.LA(4);this.synpred84_JsFormulaCommaParser()?E=1:E=2}}else{if(C!=nt){if(this.state.backtracking>0)return this.state.failed=!0,e;var N=new org.antlr.runtime.NoViableAltException("",46,2,this.input);throw N}E=2}}switch(E){case 1:n=this.adaptor.nil();var L=2,A=this.input.LA(1);if(A==P)L=1;else{if(A!=i){if(this.state.backtracking>0)return this.state.failed=!0,e;var N=new org.antlr.runtime.NoViableAltException("",41,0,this.input);throw N}L=2}switch(L){case 1:r=this.match(this.input,P,JsFormulaCommaParserParser.FOLLOW_FUNC_in_folded1182);if(this.state.failed)return e;this.state.backtracking===0&&(h=this.adaptor.create(r),this.adaptor.addChild(n,h));break;case 2:r=this.match(this.input,i,JsFormulaCommaParserParser.FOLLOW_NAME_in_folded1190);if(this.state.failed)return e;this.state.backtracking===0&&(h=this.adaptor.create(r),this.adaptor.addChild(n,h)),s=this.match(this.input,R,JsFormulaCommaParserParser.FOLLOW_P_OPEN_in_folded1196);if(this.state.failed)return e;this.state.backtracking===0&&(d=this.adaptor.create(s),this.adaptor.addChild(n,d))}if(this.state.backtracking===0){this.inFunc++;if(this.bLocaleSensitive){var O=r?r.getText():null,M,_;(s?s.getText():null)?(_=O.toUpperCase(),M=s.getStartIndex()):(_=O.substring(0,O.length-1).toUpperCase(),M=r.getStartIndex()+_.length);var D=new websheet.parse.referenceToken(_,r.getStartIndex(),"reffunct"),H=websheet.functions.FormulaTranslate.transFuncNameLocale2En(_);H||websheet.functions.FormulaTranslate.isSupportedFormula(_)&&(H=websheet.functions.FormulaTranslate.transFuncNameEn2Locale(_),H&&this.errTokenList&&this.errTokenList.push(D)),H&&D.setChangedText(H),this.tokenList.push(D);var D=new websheet.parse.referenceToken("leftfuncbrace",M);this.tokenList.push(D)}}var B=2,j=this.input.LA(1);if(j==nt){var I=this.input.LA(2);this.synpred82_JsFormulaCommaParser()&&(B=1)}switch(B){case 1:u=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_folded1212);if(this.state.failed)return e;this.state.backtracking===0&&(m=this.adaptor.create(u),this.adaptor.addChild(n,m))}this.pushFollow(JsFormulaCommaParserParser.FOLLOW_range_in_folded1220),c=this.range(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,c.getTree());var U=2,z=this.input.LA(1);z==nt&&(U=1);switch(U){case 1:a=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_folded1228);if(this.state.failed)return e;this.state.backtracking===0&&(g=this.adaptor.create(a),this.adaptor.addChild(n,g))}o=this.match(this.input,y,JsFormulaCommaParserParser.FOLLOW_P_CLOSE_in_folded1239);if(this.state.failed)return e;this.state.backtracking===0&&(v=this.adaptor.create(o),this.adaptor.addChild(n,v));if(this.state.backtracking===0){this.inFunc--;if(this.bLocaleSensitive){var W=this.tokenList.length;if(W>1){var X=W-1,V=this.tokenList[X],$;while(V){$=X>=0?V.getText():null;if($=="leftfuncbrace"){this.tokenList.splice(X,1);break}if($!=","&&$!=";"||V._changedText=="~"){X--,V=this.tokenList[X],$=X>=0?V.getText():null;continue}if(this.bMS){V.setType(websheet.Constant.FormulaTokenType.ARG_SEP);if($==this.sepChar)this.bSepToken&&V.setChangedText(websheet.Constant.TokenStr.ODF.ARG_SEP);else if(this.inConstArray===0){if(!this.bAutoCorrect)throw"separator error!";V.setChangedText(this.sepChar),this.errTokenList.push(V)}}X--,V=this.tokenList[X],$=X>0?V.getText():null}}}}break;case 2:n=this.adaptor.nil();var J=2,K=this.input.LA(1);if(K==P)J=1;else{if(K!=i){if(this.state.backtracking>0)return this.state.failed=!0,e;var N=new org.antlr.runtime.NoViableAltException("",45,0,this.input);throw N}J=2}switch(J){case 1:r=this.match(this.input,P,JsFormulaCommaParserParser.FOLLOW_FUNC_in_folded1253);if(this.state.failed)return e;this.state.backtracking===0&&(h=this.adaptor.create(r),this.adaptor.addChild(n,h));break;case 2:r=this.match(this.input,i,JsFormulaCommaParserParser.FOLLOW_NAME_in_folded1262);if(this.state.failed)return e;this.state.backtracking===0&&(h=this.adaptor.create(r),this.adaptor.addChild(n,h));var Q=2,G=this.input.LA(1);G==nt&&(Q=1);switch(Q){case 1:f=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_folded1264);if(this.state.failed)return e;this.state.backtracking===0&&(b=this.adaptor.create(f),this.adaptor.addChild(n,b))}s=this.match(this.input,R,JsFormulaCommaParserParser.FOLLOW_P_OPEN_in_folded1269);if(this.state.failed)return e;this.state.backtracking===0&&(d=this.adaptor.create(s),this.adaptor.addChild(n,d))}if(this.state.backtracking===0&&this.bLocaleSensitive){var O=r?r.getText():null,_;(s?s.getText():null)?_=O.toUpperCase():_=O.substring(0,O.length-1).toUpperCase();var D=new websheet.parse.referenceToken(_,r.getStartIndex(),"reffunct"),H=websheet.functions.FormulaTranslate.transFuncNameLocale2En(_);H||websheet.functions.FormulaTranslate.isSupportedFormula(_)&&(H=websheet.functions.FormulaTranslate.transFuncNameEn2Locale(_),H&&this.errTokenList&&this.errTokenList.push(D)),H&&D.setChangedText(H),this.tokenList.push(D)}l=this.match(this.input,y,JsFormulaCommaParserParser.FOLLOW_P_CLOSE_in_folded1274);if(this.state.failed)return e;this.state.backtracking===0&&(w=this.adaptor.create(l),this.adaptor.addChild(n,w)),this.state.backtracking===0}e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(n),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(Y){if(!(Y instanceof org.antlr.runtime.RecognitionException))throw Y;this.reportError(Y),this.recover(this.input,Y),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),Y)}finally{this.state.backtracking>0&&this.memoize(this.input,6,t)}return e},range_return:function(){JsFormulaCommaParserParser.range_return=function(){},org.antlr.lang.extend(JsFormulaCommaParserParser.range_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}});return}(),range:function(){var e=new JsFormulaCommaParserParser.range_return;e.start=this.input.LT(1);var t=this.input.index(),n=null,r=null,i=null;try{if(this.state.backtracking>0&&this.alreadyParsedRule(this.input,7))return e;var s=2;s=this.dfa47.predict(this.input);switch(s){case 1:n=this.adaptor.nil(),this.pushFollow(JsFormulaCommaParserParser.FOLLOW_atom_list_in_range1297),r=this.atom_list(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,r.getTree()),this.state.backtracking===0;break;case 2:n=this.adaptor.nil(),this.pushFollow(JsFormulaCommaParserParser.FOLLOW_folded_in_range1308),i=this.folded(),this.state._fsp--;if(this.state.failed)return e;this.state.backtracking===0&&this.adaptor.addChild(n,i.getTree()),this.state.backtracking===0}e.stop=this.input.LT(-1),this.state.backtracking===0&&(e.tree=this.adaptor.rulePostProcessing(n),this.adaptor.setTokenBoundaries(e.tree,e.start,e.stop))}catch(o){if(!(o instanceof org.antlr.runtime.RecognitionException))throw o;this.reportError(o),this.recover(this.input,o),e.tree=this.adaptor.errorNode(this.input,e.start,this.input.LT(-1),o)}finally{this.state.backtracking>0&&this.memoize(this.input,7,t)}return e},synpred5_JsFormulaCommaParser_fragment:function(){sp=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred5_JsFormulaCommaParser423);if(this.state.failed)return},synpred28_JsFormulaCommaParser_fragment:function(){m=this.input.LT(1);if(!(this.input.LA(1)>=L&&this.input.LA(1)<=N||this.input.LA(1)>=T&&this.input.LA(1)<=M||this.input.LA(1)>=a&&this.input.LA(1)<=u||this.input.LA(1)==C||this.input.LA(1)==Q||this.input.LA(1)==S)){if(this.state.backtracking>0){this.state.failed=!0;return}var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw e}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;var t=2,n=this.input.LA(1);n==nt&&(t=1);switch(t){case 1:this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred28_JsFormulaCommaParser518);if(this.state.failed)return}},synpred29_JsFormulaCommaParser_fragment:function(){var e=2;e=this.dfa52.predict(this.input);switch(e){case 1:m=this.input.LT(1);if(!(this.input.LA(1)>=L&&this.input.LA(1)<=N||this.input.LA(1)>=T&&this.input.LA(1)<=M||this.input.LA(1)>=a&&this.input.LA(1)<=u||this.input.LA(1)==C||this.input.LA(1)==Q||this.input.LA(1)==S)){if(this.state.backtracking>0){this.state.failed=!0;return}var t=new org.antlr.runtime.MismatchedSetException(null,this.input);throw t}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;var n=2,r=this.input.LA(1);r==nt&&(n=1);switch(n){case 1:this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred29_JsFormulaCommaParser518);if(this.state.failed)return}}this.pushFollow(JsFormulaCommaParserParser.FOLLOW_expr_in_synpred29_JsFormulaCommaParser531),b=this.expr(),this.state._fsp--;if(this.state.failed)return},synpred38_JsFormulaCommaParser_fragment:function(){var e=2,t=this.input.LA(1);if(t==H){var n=this.input.LA(2);n==W&&(e=1)}else t==A&&(e=1);switch(e){case 1:sn=this.input.LT(1);if(!(this.input.LA(1)>=A&&this.input.LA(1)<=H)){if(this.state.backtracking>0){this.state.failed=!0;return}var r=new org.antlr.runtime.MismatchedSetException(null,this.input);throw r}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1,m=this.match(this.input,W,JsFormulaCommaParserParser.FOLLOW_INTERSECT_ODS_in_synpred38_JsFormulaCommaParser612);if(this.state.failed)return;var s=2,o=this.input.LA(1);o==nt&&(s=1);switch(s){case 1:wp2=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred38_JsFormulaCommaParser617);if(this.state.failed)return}}x=this.match(this.input,H,JsFormulaCommaParserParser.FOLLOW_LOCALE_NUMBER_in_synpred38_JsFormulaCommaParser625);if(this.state.failed)return;em=this.match(this.input,L,JsFormulaCommaParserParser.FOLLOW_COLON_in_synpred38_JsFormulaCommaParser629);if(this.state.failed)return;endName=this.input.LT(1);if(!(this.input.LA(1)>=H&&this.input.LA(1)<=i)){if(this.state.backtracking>0){this.state.failed=!0;return}var r=new org.antlr.runtime.MismatchedSetException(null,this.input);throw r}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1},synpred42_JsFormulaCommaParser_fragment:function(){wp3=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred42_JsFormulaCommaParser710);if(this.state.failed)return},synpred49_JsFormulaCommaParser_fragment:function(){em=this.match(this.input,L,JsFormulaCommaParserParser.FOLLOW_COLON_in_synpred49_JsFormulaCommaParser720);if(this.state.failed)return;var e=2,t=this.input.LA(1);if(t==nt||t>=A&&t<=H)e=1;switch(e){case 1:var n=2,r=this.input.LA(1);r==nt&&(n=1);switch(n){case 1:wp4=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred49_JsFormulaCommaParser726);if(this.state.failed)return}x2=this.input.LT(1);if(!(this.input.LA(1)>=A&&this.input.LA(1)<=H)){if(this.state.backtracking>0){this.state.failed=!0;return}var s=new org.antlr.runtime.MismatchedSetException(null,this.input);throw s}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1,m2=this.match(this.input,W,JsFormulaCommaParserParser.FOLLOW_INTERSECT_ODS_in_synpred49_JsFormulaCommaParser740);if(this.state.failed)return;var o=2,u=this.input.LA(1);u==nt&&(o=1);switch(o){case 1:wp6=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred49_JsFormulaCommaParser745);if(this.state.failed)return}}endName=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=Y)){if(this.state.backtracking>0){this.state.failed=!0;return}var s=new org.antlr.runtime.MismatchedSetException(null,this.input);throw s}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1},synpred50_JsFormulaCommaParser_fragment:function(){x=this.input.LT(1);if(!(this.input.LA(1)>=A&&this.input.LA(1)<=H)){if(this.state.backtracking>0){this.state.failed=!0;return}var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw e}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;var t=2,n=this.input.LA(1);n==W&&(t=1);switch(t){case 1:m=this.match(this.input,W,JsFormulaCommaParserParser.FOLLOW_INTERSECT_ODS_in_synpred50_JsFormulaCommaParser690);if(this.state.failed)return;var r=2,s=this.input.LA(1);s==nt&&(r=1);switch(r){case 1:wp2=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred50_JsFormulaCommaParser695);if(this.state.failed)return}ename=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=Y)){if(this.state.backtracking>0){this.state.failed=!0;return}var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw e}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;var o=2,u=this.input.LA(1);u==nt&&(o=1);switch(o){case 1:wp3=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred50_JsFormulaCommaParser710);if(this.state.failed)return}}var a=2,f=this.input.LA(1);f==L&&(a=1);switch(a){case 1:em=this.match(this.input,L,JsFormulaCommaParserParser.FOLLOW_COLON_in_synpred50_JsFormulaCommaParser720);if(this.state.failed)return;var l=2,c=this.input.LA(1);if(c==nt||c>=A&&c<=H)l=1;switch(l){case 1:var h=2,p=this.input.LA(1);p==nt&&(h=1);switch(h){case 1:wp4=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred50_JsFormulaCommaParser726);if(this.state.failed)return}x2=this.input.LT(1);if(!(this.input.LA(1)>=A&&this.input.LA(1)<=H)){if(this.state.backtracking>0){this.state.failed=!0;return}var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw e}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1,m2=this.match(this.input,W,JsFormulaCommaParserParser.FOLLOW_INTERSECT_ODS_in_synpred50_JsFormulaCommaParser740);if(this.state.failed)return;var d=2,v=this.input.LA(1);v==nt&&(d=1);switch(d){case 1:wp6=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred50_JsFormulaCommaParser745);if(this.state.failed)return}}endName=this.input.LT(1);if(!(this.input.LA(1)>=i&&this.input.LA(1)<=Y)){if(this.state.backtracking>0){this.state.failed=!0;return}var e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw e}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1}},synpred55_JsFormulaCommaParser_fragment:function(){this.pushFollow(JsFormulaCommaParserParser.FOLLOW_folded_in_synpred55_JsFormulaCommaParser832),this.folded(),this.state._fsp--;if(this.state.failed)return},synpred56_JsFormulaCommaParser_fragment:function(){wp1=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred56_JsFormulaCommaParser863);if(this.state.failed)return},synpred68_JsFormulaCommaParser_fragment:function(){wp3=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred68_JsFormulaCommaParser1019);if(this.state.failed)return},synpred76_JsFormulaCommaParser_fragment:function(){m=this.match(this.input,L,JsFormulaCommaParserParser.FOLLOW_COLON_in_synpred76_JsFormulaCommaParser1029);if(this.state.failed)return;var e=2,n=this.input.LA(1);if(n==nt||n==t)e=1;else if(n==i){var r=this.input.LA(2);r==W&&(e=1)}switch(e){case 1:var s=2,o=this.input.LA(1);o==nt&&(s=1);switch(s){case 1:wp4=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred76_JsFormulaCommaParser1035);if(this.state.failed)return}name2=this.input.LT(1);if(this.input.LA(1)!=i&&this.input.LA(1)!=t){if(this.state.backtracking>0){this.state.failed=!0;return}var u=new org.antlr.runtime.MismatchedSetException(null,this.input);throw u}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1,op2=this.match(this.input,W,JsFormulaCommaParserParser.FOLLOW_INTERSECT_ODS_in_synpred76_JsFormulaCommaParser1049);if(this.state.failed)return;var a=2,f=this.input.LA(1);f==nt&&(a=1);switch(a){case 1:wp6=this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred76_JsFormulaCommaParser1054);if(this.state.failed)return}}endName=this.input.LT(1);if(!(this.input.LA(1)>=H&&this.input.LA(1)<=Y)){if(this.state.backtracking>0){this.state.failed=!0;return}var u=new org.antlr.runtime.MismatchedSetException(null,this.input);throw u}this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1},synpred78_JsFormulaCommaParser_fragment:function(){this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred78_JsFormulaCommaParser1106);if(this.state.failed)return},synpred82_JsFormulaCommaParser_fragment:function(){this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred82_JsFormulaCommaParser1212);if(this.state.failed)return},synpred84_JsFormulaCommaParser_fragment:function(){var e=2,t=this.input.LA(1);if(t==P)e=1;else{if(t!=i){if(this.state.backtracking>0){this.state.failed=!0;return}var n=new org.antlr.runtime.NoViableAltException("",94,0,this.input);throw n}e=2}switch(e){case 1:f=this.match(this.input,P,JsFormulaCommaParserParser.FOLLOW_FUNC_in_synpred84_JsFormulaCommaParser1182);if(this.state.failed)return;break;case 2:f=this.match(this.input,i,JsFormulaCommaParserParser.FOLLOW_NAME_in_synpred84_JsFormulaCommaParser1190);if(this.state.failed)return;b=this.match(this.input,R,JsFormulaCommaParserParser.FOLLOW_P_OPEN_in_synpred84_JsFormulaCommaParser1196);if(this.state.failed)return}var r=2,s=this.input.LA(1);if(s==nt){var o=this.input.LA(2);this.synpred82_JsFormulaCommaParser()&&(r=1)}switch(r){case 1:this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred84_JsFormulaCommaParser1212);if(this.state.failed)return}this.pushFollow(JsFormulaCommaParserParser.FOLLOW_range_in_synpred84_JsFormulaCommaParser1220),this.range(),this.state._fsp--;if(this.state.failed)return;var u=2,a=this.input.LA(1);a==nt&&(u=1);switch(u){case 1:this.match(this.input,nt,JsFormulaCommaParserParser.FOLLOW_INTERSECT_in_synpred84_JsFormulaCommaParser1228);if(this.state.failed)return}rBrace=this.match(this.input,y,JsFormulaCommaParserParser.FOLLOW_P_CLOSE_in_synpred84_JsFormulaCommaParser1239);if(this.state.failed)return},synpred87_JsFormulaCommaParser_fragment:function(){this.pushFollow(JsFormulaCommaParserParser.FOLLOW_atom_list_in_synpred87_JsFormulaCommaParser1297),params=this.atom_list(),this.state._fsp--;if(this.state.failed)return},synpred29_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred29_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred28_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred28_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred49_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred49_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred38_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred38_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred5_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred5_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred68_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred68_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred56_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred56_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred78_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred78_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred55_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred55_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred87_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred87_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred76_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred76_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred42_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred42_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred84_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred84_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred50_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred50_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n},synpred82_JsFormulaCommaParser:function(){this.state.backtracking++;var e=this.input.mark();try{this.synpred82_JsFormulaCommaParser_fragment()}catch(t){alert("impossible: "+t.toString())}var n=!this.state.failed;return this.input.rewind(e),this.state.backtracking--,this.state.failed=!1,n}},!0),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA9_eotS:"\uffff",DFA9_eofS:"\uffff",DFA9_minS:"\uffff\n\0\uffff\0\uffff\0\uffff",DFA9_maxS:"(\uffff\n\0\uffff\0\uffff\0\uffff",DFA9_acceptS:"\uffff\uffff",DFA9_specialS:"\uffff\0\b	\uffff\n\uffff\uffff}>",DFA9_transitionS:["\uffff\uffff\uffff\n\r	\b","","\uffff","\uffff","\uffff","\uffff","\uffff","\uffff","\uffff","\uffff","\uffff","\uffff","","\uffff","","","\uffff",""]}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA9_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA9_eotS),DFA9_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA9_eofS),DFA9_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA9_minS),DFA9_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA9_maxS),DFA9_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA9_acceptS),DFA9_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA9_specialS),DFA9_transition:function(){var e=[],t,n=JsFormulaCommaParserParser.DFA9_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA9_transitionS[t]));return e}()}),JsFormulaCommaParserParser.DFA9=function(e){this.recognizer=e,this.decisionNumber=9,this.eot=JsFormulaCommaParserParser.DFA9_eot,this.eof=JsFormulaCommaParserParser.DFA9_eof,this.min=JsFormulaCommaParserParser.DFA9_min,this.max=JsFormulaCommaParserParser.DFA9_max,this.accept=JsFormulaCommaParserParser.DFA9_accept,this.special=JsFormulaCommaParserParser.DFA9_special,this.transition=JsFormulaCommaParserParser.DFA9_transition},org.antlr.lang.extend(JsFormulaCommaParserParser.DFA9,org.antlr.runtime.DFA,{getDescription:function(){return"()* loopback of 99:3: ( (m= ( LESS | GREATER | LESSEQUAL | GREATEREQUAL | MODEQUAL | MULTEEQUAL | MINUSEQUAL | PLUSEQUAL | DIVEQUAL | NOTEQUAL | NOTEQUAL2 | EQUAL | AND | MINUS | PLUS | MULT | DIV | COLON | POW | ARG_SEP | CONCATENATION ) ( INTERSECT )? )? b= expr )*"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(s);if(e>=0)return e;break;case 2:var o=t.LA(1),u=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(u);if(e>=0)return e;break;case 3:var a=t.LA(1),f=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(f);if(e>=0)return e;break;case 4:var l=t.LA(1),c=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(c);if(e>=0)return e;break;case 5:var h=t.LA(1),p=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(p);if(e>=0)return e;break;case 6:var d=t.LA(1),v=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(v);if(e>=0)return e;break;case 7:var m=t.LA(1),g=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(g);if(e>=0)return e;break;case 8:var y=t.LA(1),b=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(b);if(e>=0)return e;break;case 9:var w=t.LA(1),E=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(E);if(e>=0)return e;break;case 10:var S=t.LA(1),x=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(x);if(e>=0)return e;break;case 11:var T=t.LA(1),N=t.index();t.rewind(),e=-1,this.synpred29_JsFormulaCommaParser()?e=17:e=1,t.seek(N);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),9,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA8_eotS:"\f\uffff",DFA8_eofS:"\f\uffff",DFA8_minS:"\0	\uffff",DFA8_maxS:"(\0	\uffff",DFA8_acceptS:"\uffff\uffff",DFA8_specialS:"\uffff\0	\uffff}>",DFA8_transitionS:["\uffff\uffff\uffff\uffff\uffff","\uffff","\uffff","","","","","","","","",""]}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA8_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA8_eotS),DFA8_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA8_eofS),DFA8_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA8_minS),DFA8_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA8_maxS),DFA8_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA8_acceptS),DFA8_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA8_specialS),DFA8_transition:function(){var e=[],t,n=JsFormulaCommaParserParser.DFA8_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA8_transitionS[t]));return e}()}),JsFormulaCommaParserParser.DFA8=function(e){this.recognizer=e,this.decisionNumber=8,this.eot=JsFormulaCommaParserParser.DFA8_eot,this.eof=JsFormulaCommaParserParser.DFA8_eof,this.min=JsFormulaCommaParserParser.DFA8_min,this.max=JsFormulaCommaParserParser.DFA8_max,this.accept=JsFormulaCommaParserParser.DFA8_accept,this.special=JsFormulaCommaParserParser.DFA8_special,this.transition=JsFormulaCommaParserParser.DFA8_transition},org.antlr.lang.extend(JsFormulaCommaParserParser.DFA8,org.antlr.runtime.DFA,{getDescription:function(){return"99:4: (m= ( LESS | GREATER | LESSEQUAL | GREATEREQUAL | MODEQUAL | MULTEEQUAL | MINUSEQUAL | PLUSEQUAL | DIVEQUAL | NOTEQUAL | NOTEQUAL2 | EQUAL | AND | MINUS | PLUS | MULT | DIV | COLON | POW | ARG_SEP | CONCATENATION ) ( INTERSECT )? )?"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred28_JsFormulaCommaParser()?e=3:e=4,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred28_JsFormulaCommaParser()?e=3:e=4,t.seek(s);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),8,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject
(JsFormulaCommaParserParser,{DFA36_eotS:"\r\uffff",DFA36_eofS:"\r\uffff",DFA36_minS:"\b\uffff\0\uffff\0\uffff",DFA36_maxS:"(\uffff\0\uffff\0\uffff",DFA36_acceptS:"\uffff\uffff\uffff\b	",DFA36_specialS:"\uffff\0\uffff\uffff}>",DFA36_transitionS:["\uffff\uffff\r\uffff	\uffff\b\n\n","","","\uffff","\uffff","","","","\uffff","","","",""]}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA36_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA36_eotS),DFA36_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA36_eofS),DFA36_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA36_minS),DFA36_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA36_maxS),DFA36_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA36_acceptS),DFA36_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA36_specialS),DFA36_transition:function(){var e=[],t,n=JsFormulaCommaParserParser.DFA36_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA36_transitionS[t]));return e}()}),JsFormulaCommaParserParser.DFA36=function(e){this.recognizer=e,this.decisionNumber=36,this.eot=JsFormulaCommaParserParser.DFA36_eot,this.eof=JsFormulaCommaParserParser.DFA36_eof,this.min=JsFormulaCommaParserParser.DFA36_min,this.max=JsFormulaCommaParserParser.DFA36_max,this.accept=JsFormulaCommaParserParser.DFA36_accept,this.special=JsFormulaCommaParserParser.DFA36_special,this.transition=JsFormulaCommaParserParser.DFA36_transition},org.antlr.lang.extend(JsFormulaCommaParserParser.DFA36,org.antlr.runtime.DFA,{getDescription:function(){return"187:1: atom returns [String value] : ( '-' ( INTERSECT )? (b= atom ) | '+' ( INTERSECT )? (b= atom ) | (sn= ( SINGLEQUOT_STRING | LOCALE_NUMBER ) m= INTERSECT_ODS (wp2= INTERSECT )? )? x= LOCALE_NUMBER em= COLON endName= ( NAME | LOCALE_NUMBER ) | x= ( SINGLEQUOT_STRING | LOCALE_NUMBER ) (m= INTERSECT_ODS (wp2= INTERSECT )? ename= ( ERRORNAME | NAME ) (wp3= INTERSECT )? )? (em= COLON ( (wp4= INTERSECT )? x2= ( SINGLEQUOT_STRING | LOCALE_NUMBER ) m2= INTERSECT_ODS (wp6= INTERSECT )? )? endName= ( ERRORNAME | NAME ) )? | x= DOUBLEQUOT_STRING | (brace= P_OPEN ) ( ( INTERSECT )? expr ( INTERSECT )? ebrace= P_CLOSE ) | folded | (a= ARRAY_FORMULAR_START (wp1= INTERSECT )? ) ( (firToken= atom ) ( ( ( (wp2= INTERSECT )? sep= ARG_SEP (wp3= INTERSECT )? ) ) (token= atom ) )* )? ( (wp4= INTERSECT )? ARRAY_FORMULAR_END ) | name1= ( ERRORNAME | NAME | NAME1 ) (op= INTERSECT_ODS (wp2= INTERSECT )? ename= ( ERRORNAME | NAME | LOCALE_NUMBER ) (wp3= INTERSECT )? )? (m= COLON ( (wp4= INTERSECT )? name2= ( NAME | NAME1 ) op2= INTERSECT_ODS (wp6= INTERSECT )? )? endName= ( ERRORNAME | NAME | LOCALE_NUMBER ) )? );"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred38_JsFormulaCommaParser()?e=11:this.synpred50_JsFormulaCommaParser()&&(e=12),t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred38_JsFormulaCommaParser()?e=11:this.synpred50_JsFormulaCommaParser()&&(e=12),t.seek(s);if(e>=0)return e;break;case 2:var o=t.LA(1),u=t.index();t.rewind(),e=-1,this.synpred55_JsFormulaCommaParser()?e=7:e=10,t.seek(u);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),36,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA20_eotS:"\f\uffff",DFA20_eofS:"\uffff\uffff",DFA20_minS:"\b\uffff\b\0 \uffff#\0",DFA20_maxS:"(\uffff(\0%\uffff%\0",DFA20_acceptS:"\uffff\uffff\uffff",DFA20_specialS:"\uffff\uffff\0}>",DFA20_transitionS:["\uffff\uffff","\uffff\uffff\r\uffff\uffff\uffff","","\uffff\uffff\r\uffff\uffff","\b\uffff","\b\uffff","\uffff","\uffff","\n\uffff","","","\uffff"]}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA20_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA20_eotS),DFA20_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA20_eofS),DFA20_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA20_minS),DFA20_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA20_maxS),DFA20_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA20_acceptS),DFA20_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA20_specialS),DFA20_transition:function(){var e=[],t,n=JsFormulaCommaParserParser.DFA20_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA20_transitionS[t]));return e}()}),JsFormulaCommaParserParser.DFA20=function(e){this.recognizer=e,this.decisionNumber=20,this.eot=JsFormulaCommaParserParser.DFA20_eot,this.eof=JsFormulaCommaParserParser.DFA20_eof,this.min=JsFormulaCommaParserParser.DFA20_min,this.max=JsFormulaCommaParserParser.DFA20_max,this.accept=JsFormulaCommaParserParser.DFA20_accept,this.special=JsFormulaCommaParserParser.DFA20_special,this.transition=JsFormulaCommaParserParser.DFA20_transition},org.antlr.lang.extend(JsFormulaCommaParserParser.DFA20,org.antlr.runtime.DFA,{getDescription:function(){return"250:120: (em= COLON ( (wp4= INTERSECT )? x2= ( SINGLEQUOT_STRING | LOCALE_NUMBER ) m2= INTERSECT_ODS (wp6= INTERSECT )? )? endName= ( ERRORNAME | NAME ) )?"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred49_JsFormulaCommaParser()?e=9:e=2,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred49_JsFormulaCommaParser()?e=9:e=2,t.seek(s);if(e>=0)return e;break;case 2:var o=t.LA(1),u=t.index();t.rewind(),e=-1,this.synpred49_JsFormulaCommaParser()?e=9:e=2,t.seek(u);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),20,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA35_eotS:"\r\uffff",DFA35_eofS:"\uffff\uffff\uffff",DFA35_minS:"\b\uffff\b\0\0\uffff #\0",DFA35_maxS:"(\uffff(\0(\0(\uffff%\0",DFA35_acceptS:"\uffff\uffff\uffff",DFA35_specialS:"\uffff\0\uffff\uffff}>",DFA35_transitionS:["\uffff\uffff","\uffff\uffff\r\uffff\uffff\uffff","","\uffff\uffff\r\uffff\uffff\b","\uffff","\n\uffff","\uffff","\uffff","\n\uffff","","\uffff\f","\f","\uffff"]}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA35_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA35_eotS),DFA35_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA35_eofS),DFA35_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA35_minS),DFA35_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA35_maxS),DFA35_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA35_acceptS),DFA35_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA35_specialS),DFA35_transition:function(){var e=[],t,n=JsFormulaCommaParserParser.DFA35_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA35_transitionS[t]));return e}()}),JsFormulaCommaParserParser.DFA35=function(e){this.recognizer=e,this.decisionNumber=35,this.eot=JsFormulaCommaParserParser.DFA35_eot,this.eof=JsFormulaCommaParserParser.DFA35_eof,this.min=JsFormulaCommaParserParser.DFA35_min,this.max=JsFormulaCommaParserParser.DFA35_max,this.accept=JsFormulaCommaParserParser.DFA35_accept,this.special=JsFormulaCommaParserParser.DFA35_special,this.transition=JsFormulaCommaParserParser.DFA35_transition},org.antlr.lang.extend(JsFormulaCommaParserParser.DFA35,org.antlr.runtime.DFA,{getDescription:function(){return"533:126: (m= COLON ( (wp4= INTERSECT )? name2= ( NAME | NAME1 ) op2= INTERSECT_ODS (wp6= INTERSECT )? )? endName= ( ERRORNAME | NAME | LOCALE_NUMBER ) )?"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred76_JsFormulaCommaParser()?e=9:e=2,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred76_JsFormulaCommaParser()?e=9:e=2,t.seek(s);if(e>=0)return e;break;case 2:var o=t.LA(1),u=t.index();t.rewind(),e=-1,this.synpred76_JsFormulaCommaParser()?e=9:e=2,t.seek(u);if(e>=0)return e;break;case 3:var a=t.LA(1),f=t.index();t.rewind(),e=-1,this.synpred76_JsFormulaCommaParser()?e=9:e=2,t.seek(f);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),35,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA47_eotS:"\uffff",DFA47_eofS:"\uffff",DFA47_minS:"\b\uffff\0\uffff",DFA47_maxS:"(\uffff\0\uffff",DFA47_acceptS:"\uffff\f\uffff",DFA47_specialS:"\uffff\0\uffff}>",DFA47_transitionS:["\uffff\uffff\f\uffff\uffff\b","","","","","","","\uffff","\uffff","","","","","",""]}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA47_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA47_eotS),DFA47_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA47_eofS),DFA47_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA47_minS),DFA47_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA47_maxS),DFA47_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA47_acceptS),DFA47_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA47_specialS),DFA47_transition:function(){var e=[],t,n=JsFormulaCommaParserParser.DFA47_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA47_transitionS[t]));return e}()}),JsFormulaCommaParserParser.DFA47=function(e){this.recognizer=e,this.decisionNumber=47,this.eot=JsFormulaCommaParserParser.DFA47_eot,this.eof=JsFormulaCommaParserParser.DFA47_eof,this.min=JsFormulaCommaParserParser.DFA47_min,this.max=JsFormulaCommaParserParser.DFA47_max,this.accept=JsFormulaCommaParserParser.DFA47_accept,this.special=JsFormulaCommaParserParser.DFA47_special,this.transition=JsFormulaCommaParserParser.DFA47_transition},org.antlr.lang.extend(JsFormulaCommaParserParser.DFA47,org.antlr.runtime.DFA,{getDescription:function(){return"812:1: range returns [String value] : (params= atom_list | funct= folded );"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred87_JsFormulaCommaParser()?e=1:e=14,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred87_JsFormulaCommaParser()?e=1:e=14,t.seek(s);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),47,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA52_eotS:"\f\uffff",DFA52_eofS:"\f\uffff",DFA52_minS:"\0	\uffff",DFA52_maxS:"(\0	\uffff",DFA52_acceptS:"\uffff\uffff",DFA52_specialS:"\uffff\0	\uffff}>",DFA52_transitionS:["\uffff\uffff\uffff\uffff\uffff","\uffff","\uffff","","","","","","","","",""]}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{DFA52_eot:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA52_eotS),DFA52_eof:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA52_eofS),DFA52_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA52_minS),DFA52_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(JsFormulaCommaParserParser.DFA52_maxS),DFA52_accept:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA52_acceptS),DFA52_special:org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA52_specialS),DFA52_transition:function(){var e=[],t,n=JsFormulaCommaParserParser.DFA52_transitionS.length;for(t=0;t<n;t++)e.push(org.antlr.runtime.DFA.unpackEncodedString(JsFormulaCommaParserParser.DFA52_transitionS[t]));return e}()}),JsFormulaCommaParserParser.DFA52=function(e){this.recognizer=e,this.decisionNumber=52,this.eot=JsFormulaCommaParserParser.DFA52_eot,this.eof=JsFormulaCommaParserParser.DFA52_eof,this.min=JsFormulaCommaParserParser.DFA52_min,this.max=JsFormulaCommaParserParser.DFA52_max,this.accept=JsFormulaCommaParserParser.DFA52_accept,this.special=JsFormulaCommaParserParser.DFA52_special,this.transition=JsFormulaCommaParserParser.DFA52_transition},org.antlr.lang.extend(JsFormulaCommaParserParser.DFA52,org.antlr.runtime.DFA,{getDescription:function(){return"99:4: (m= ( LESS | GREATER | LESSEQUAL | GREATEREQUAL | MODEQUAL | MULTEEQUAL | MINUSEQUAL | PLUSEQUAL | DIVEQUAL | NOTEQUAL | NOTEQUAL2 | EQUAL | AND | MINUS | PLUS | MULT | DIV | COLON | POW | ARG_SEP | CONCATENATION ) ( INTERSECT )? )?"},specialStateTransition:function(e,t){var n=e,r=function(e,t){switch(e){case 0:var n=t.LA(1),r=t.index();t.rewind(),e=-1,this.synpred28_JsFormulaCommaParser()?e=3:e=4,t.seek(r);if(e>=0)return e;break;case 1:var i=t.LA(1),s=t.index();t.rewind(),e=-1,this.synpred28_JsFormulaCommaParser()?e=3:e=4,t.seek(s);if(e>=0)return e}}.call(this.recognizer,e,t);if(!org.antlr.lang.isUndefined(r))return r;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var i=new org.antlr.runtime.NoViableAltException(this.getDescription(),52,n,t);throw this.error(i),i},dummy:null}),org.antlr.lang.augmentObject(JsFormulaCommaParserParser,{tokenNames:["<invalid>","<EOR>","<DOWN>","<UP>","COLON","CONCATENATION","INTERSECT_ODS","AND","PLUS","PLUSEQUAL","MINUS","MINUSEQUAL","MULT","MULTEEQUAL","DIV","DIVEQUAL","P_OPEN","P_CLOSE","EQUAL","LESS","LESSEQUAL","GREATER","GREATEREQUAL","NOTEQUAL","NOTEQUAL2","AMPERSAND","OR","POW","MODE","MODEQUAL","ARRAY_FORMULAR_START","ARRAY_FORMULAR_END","INTERSECT","ARG_SEP","SINGLEQUOT_STRING","LOCALE_NUMBER","NAME","ERRORNAME","DOUBLEQUOT_STRING","NAME1","FUNC","NONZERO_NUMBER","DIGIT","INT","SPACE1","NUMSEP","LT","COMMAOrSPACE","KEYCHARACTER","ODF_COLUMN","ODF_COL_RANGE","ODF_PREWORD","ODF_PRELIST","ODF_TABLE","WHITESPACE","SPACE"],FOLLOW_EQUAL_in_prog347:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_prog349:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_expr_in_prog352:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_EOF_in_prog357:new org.antlr.runtime.BitSet([2,0]),FOLLOW_ARRAY_FORMULAR_START_in_prog363:new org.antlr.runtime.BitSet([262144,0]),FOLLOW_EQUAL_in_prog365:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_expr_in_prog377:new org.antlr.runtime.BitSet([3221292288,509]),FOLLOW_ARRAY_FORMULAR_END_in_prog382:new org.antlr.runtime.BitSet([0,0]),FOLLOW_EOF_in_prog384:new org.antlr.runtime.BitSet([2,0]),FOLLOW_atom_in_expr407:new org.antlr.runtime.BitSet([2046689202,511]),FOLLOW_INTERSECT_in_expr423:new org.antlr.runtime.BitSet([2046689202,511]),FOLLOW_MODE_in_expr435:new org.antlr.runtime.BitSet([2046689202,511]),FOLLOW_set_in_expr449:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_expr518:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_expr_in_expr531:new org.antlr.runtime.BitSet([1778253746,511]),FOLLOW_MINUS_in_atom561:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_atom563:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_atom_in_atom569:new org.antlr.runtime.BitSet([2,0]),FOLLOW_PLUS_in_atom576:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_atom578:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_atom_in_atom584:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_atom604:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_atom612:new org.antlr.runtime.BitSet([0,9]),FOLLOW_INTERSECT_in_atom617:new org.antlr.runtime.BitSet([0,8]),FOLLOW_LOCALE_NUMBER_in_atom625:new org.antlr.runtime.BitSet([16,0]),FOLLOW_COLON_in_atom629:new org.antlr.runtime.BitSet([0,24]),FOLLOW_set_in_atom634:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_atom680:new org.antlr.runtime.BitSet([82,0]),FOLLOW_INTERSECT_ODS_in_atom690:new org.antlr.runtime.BitSet([0,49]),FOLLOW_INTERSECT_in_atom695:new org.antlr.runtime.BitSet([0,48]),FOLLOW_set_in_atom701:new org.antlr.runtime.BitSet([18,1]),FOLLOW_INTERSECT_in_atom710:new org.antlr.runtime.BitSet([18,0]),FOLLOW_COLON_in_atom720:new org.antlr.runtime.BitSet([0,61]),FOLLOW_INTERSECT_in_atom726:new org.antlr.runtime.BitSet([0,12]),FOLLOW_set_in_atom732:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_atom740:new org.antlr.runtime.BitSet([0,49]),FOLLOW_INTERSECT_in_atom745:new org.antlr.runtime.BitSet([0,48]),FOLLOW_set_in_atom753:new org.antlr.runtime.BitSet([2,0]),FOLLOW_DOUBLEQUOT_STRING_in_atom769:new org.antlr.runtime.BitSet([2,0]),FOLLOW_P_OPEN_in_atom783:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_atom799:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_expr_in_atom808:new org.antlr.runtime.BitSet([131072,1]),FOLLOW_INTERSECT_in_atom815:new org.antlr.runtime.BitSet([131072,0]),FOLLOW_P_CLOSE_in_atom822:new org.antlr.runtime.BitSet([2,0]),FOLLOW_folded_in_atom832:new org.antlr.runtime.BitSet([2,0]),FOLLOW_ARRAY_FORMULAR_START_in_atom858:new org.antlr.runtime.BitSet([3221292288,509]),FOLLOW_INTERSECT_in_atom863:new org.antlr.runtime.BitSet([3221292288,509]),FOLLOW_atom_in_atom878:new org.antlr.runtime.BitSet([2147483648,3]),FOLLOW_INTERSECT_in_atom894:new org.antlr.runtime.BitSet([0,2]),FOLLOW_ARG_SEP_in_atom900:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_atom905:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_atom_in_atom921:new org.antlr.runtime.BitSet([2147483648,3]),FOLLOW_INTERSECT_in_atom938:new org.antlr.runtime.BitSet([2147483648,0]),FOLLOW_ARRAY_FORMULAR_END_in_atom942:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_atom985:new org.antlr.runtime.BitSet([82,0]),FOLLOW_INTERSECT_ODS_in_atom997:new org.antlr.runtime.BitSet([0,57]),FOLLOW_INTERSECT_in_atom1002:new org.antlr.runtime.BitSet([0,56]),FOLLOW_set_in_atom1008:new org.antlr.runtime.BitSet([18,1]),FOLLOW_INTERSECT_in_atom1019:new org.antlr.runtime.BitSet([18,0]),FOLLOW_COLON_in_atom1029:new org.antlr.runtime.BitSet([0,185]),FOLLOW_INTERSECT_in_atom1035:new org.antlr.runtime.BitSet([0,144]),FOLLOW_set_in_atom1041:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_atom1049:new org.antlr.runtime.BitSet([0,57]),FOLLOW_INTERSECT_in_atom1054:new org.antlr.runtime.BitSet([0,56]),FOLLOW_set_in_atom1063:new org.antlr.runtime.BitSet([2,0]),FOLLOW_atom_type_in_atom_list1091:new org.antlr.runtime.BitSet([2,3]),FOLLOW_INTERSECT_in_atom_list1099:new org.antlr.runtime.BitSet([0,2]),FOLLOW_ARG_SEP_in_atom_list1104:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_INTERSECT_in_atom_list1106:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_atom_type_in_atom_list1113:new org.antlr.runtime.BitSet([2,3]),FOLLOW_expr_in_atom_type1141:new org.antlr.runtime.BitSet([2,0]),FOLLOW_FUNC_in_folded1182:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_NAME_in_folded1190:new org.antlr.runtime.BitSet([65536,0]),FOLLOW_P_OPEN_in_folded1196:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_INTERSECT_in_folded1212:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_range_in_folded1220:new org.antlr.runtime.BitSet([131072,1]),FOLLOW_INTERSECT_in_folded1228:new org.antlr.runtime.BitSet([131072,0]),FOLLOW_P_CLOSE_in_folded1239:new org.antlr.runtime.BitSet([2,0]),FOLLOW_FUNC_in_folded1253:new org.antlr.runtime.BitSet([131072,0]),FOLLOW_NAME_in_folded1262:new org.antlr.runtime.BitSet([65536,1]),FOLLOW_INTERSECT_in_folded1264:new org.antlr.runtime.BitSet([65536,0]),FOLLOW_P_OPEN_in_folded1269:new org.antlr.runtime.BitSet([131072,0]),FOLLOW_P_CLOSE_in_folded1274:new org.antlr.runtime.BitSet([2,0]),FOLLOW_atom_list_in_range1297:new org.antlr.runtime.BitSet([2,0]),FOLLOW_folded_in_range1308:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred5_JsFormulaCommaParser423:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred28_JsFormulaCommaParser449:new org.antlr.runtime.BitSet([2,1]),FOLLOW_INTERSECT_in_synpred28_JsFormulaCommaParser518:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred29_JsFormulaCommaParser449:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_INTERSECT_in_synpred29_JsFormulaCommaParser518:new org.antlr.runtime.BitSet([1073808640,509]),FOLLOW_expr_in_synpred29_JsFormulaCommaParser531:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred38_JsFormulaCommaParser604:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_synpred38_JsFormulaCommaParser612:new org.antlr.runtime.BitSet([0,9]),FOLLOW_INTERSECT_in_synpred38_JsFormulaCommaParser617:new org.antlr.runtime.BitSet([0,8]),FOLLOW_LOCALE_NUMBER_in_synpred38_JsFormulaCommaParser625:new org.antlr.runtime.BitSet([16,0]),FOLLOW_COLON_in_synpred38_JsFormulaCommaParser629:new org.antlr.runtime.BitSet([0,24]),FOLLOW_set_in_synpred38_JsFormulaCommaParser634:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred42_JsFormulaCommaParser710:new org.antlr.runtime.BitSet([2,0]),FOLLOW_COLON_in_synpred49_JsFormulaCommaParser720:new org.antlr.runtime.BitSet([0,61]),FOLLOW_INTERSECT_in_synpred49_JsFormulaCommaParser726:new org.antlr.runtime.BitSet([0,12]),FOLLOW_set_in_synpred49_JsFormulaCommaParser732:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_synpred49_JsFormulaCommaParser740:new org.antlr.runtime.BitSet([0,49]),FOLLOW_INTERSECT_in_synpred49_JsFormulaCommaParser745:new org.antlr.runtime.BitSet([0,48]),FOLLOW_set_in_synpred49_JsFormulaCommaParser753:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred50_JsFormulaCommaParser680:new org.antlr.runtime.BitSet([82,0]),FOLLOW_INTERSECT_ODS_in_synpred50_JsFormulaCommaParser690:new org.antlr.runtime.BitSet([0,49]),FOLLOW_INTERSECT_in_synpred50_JsFormulaCommaParser695:new org.antlr.runtime.BitSet([0,48]),FOLLOW_set_in_synpred50_JsFormulaCommaParser701:new org.antlr.runtime.BitSet([18,1]),FOLLOW_INTERSECT_in_synpred50_JsFormulaCommaParser710:new org.antlr.runtime.BitSet([18,0]),FOLLOW_COLON_in_synpred50_JsFormulaCommaParser720:new org.antlr.runtime.BitSet([0,61]),FOLLOW_INTERSECT_in_synpred50_JsFormulaCommaParser726:new org.antlr.runtime.BitSet([0,12]),FOLLOW_set_in_synpred50_JsFormulaCommaParser732:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_synpred50_JsFormulaCommaParser740:new org.antlr.runtime.BitSet([0,49]),FOLLOW_INTERSECT_in_synpred50_JsFormulaCommaParser745:new org.antlr.runtime.BitSet([0,48]),FOLLOW_set_in_synpred50_JsFormulaCommaParser753:new org.antlr.runtime.BitSet([2,0]),FOLLOW_folded_in_synpred55_JsFormulaCommaParser832:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred56_JsFormulaCommaParser863:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred68_JsFormulaCommaParser1019:new org.antlr.runtime.BitSet([2,0]),FOLLOW_COLON_in_synpred76_JsFormulaCommaParser1029:new org.antlr.runtime.BitSet([0,185]),FOLLOW_INTERSECT_in_synpred76_JsFormulaCommaParser1035:new org.antlr.runtime.BitSet([0,144]),FOLLOW_set_in_synpred76_JsFormulaCommaParser1041:new org.antlr.runtime.BitSet([64,0]),FOLLOW_INTERSECT_ODS_in_synpred76_JsFormulaCommaParser1049:new org.antlr.runtime.BitSet([0,57]),FOLLOW_INTERSECT_in_synpred76_JsFormulaCommaParser1054:new org.antlr.runtime.BitSet([0,56]),FOLLOW_set_in_synpred76_JsFormulaCommaParser1063:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred78_JsFormulaCommaParser1106:new org.antlr.runtime.BitSet([2,0]),FOLLOW_INTERSECT_in_synpred82_JsFormulaCommaParser1212:new org.antlr.runtime.BitSet([2,0]),FOLLOW_FUNC_in_synpred84_JsFormulaCommaParser1182:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_NAME_in_synpred84_JsFormulaCommaParser1190:new org.antlr.runtime.BitSet([65536,0]),FOLLOW_P_OPEN_in_synpred84_JsFormulaCommaParser1196:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_INTERSECT_in_synpred84_JsFormulaCommaParser1212:new org.antlr.runtime.BitSet([1073808640,511]),FOLLOW_range_in_synpred84_JsFormulaCommaParser1220:new org.antlr.runtime.BitSet([131072,1]),FOLLOW_INTERSECT_in_synpred84_JsFormulaCommaParser1228:new org.antlr.runtime.BitSet([131072,0]),FOLLOW_P_CLOSE_in_synpred84_JsFormulaCommaParser1239:new org.antlr.runtime.BitSet([2,0]),FOLLOW_atom_list_in_synpred87_JsFormulaCommaParser1297:new org.antlr.runtime.BitSet([2,0])})}();window.JsFormulaParserLexer = JsFormulaParserLexer, window.JsFormulaParserParser = JsFormulaParserParser, window.JsFormulaCommaParserLexer = JsFormulaCommaParserLexer, window.JsFormulaCommaParserParser = JsFormulaCommaParserParser 
