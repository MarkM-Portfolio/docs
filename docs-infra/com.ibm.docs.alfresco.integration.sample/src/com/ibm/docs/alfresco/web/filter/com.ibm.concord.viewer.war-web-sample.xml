<?xml version="1.0" encoding="UTF-8"?>
<!-- ***************************************************************** -->
<!--                                                                   -->
<!-- Licensed Materials - Property of IBM.                             -->
<!--                                                                   -->
<!-- IBM Docs Source Materials                                         -->
<!--                                                                   -->
<!-- (c) Copyright IBM Corporation 2012. All Rights Reserved.          -->
<!--                                                                   -->
<!-- U.S. Government Users Restricted Rights: Use, duplication or      -->
<!-- disclosure restricted by GSA ADP Schedule Contract with IBM Corp. -->
<!--                                                                   -->
<!-- ***************************************************************** -->
<web-app id="WebApp_ID" version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">
	<display-name>ViewerApp</display-name>
	<listener>
		<display-name>Platform Initializer</display-name>
		<listener-class>com.ibm.concord.viewer.platform.PlatformInitializer</listener-class>
	</listener>
	<listener>
		<display-name>HouseKeeping Initializer</display-name>
		<listener-class>com.ibm.concord.viewer.admin.HouseKeepingInitializer</listener-class>
	</listener>
	<welcome-file-list>
		<welcome-file>index.html</welcome-file>
	</welcome-file-list>
	<filter>
		<filter-name>ParametersFilter</filter-name>
		<filter-class>com.ibm.docs.alfresco.web.filter.ParametersFilter</filter-class>
	</filter>	
	<filter>
		<filter-name>SessionUserFilter</filter-name>
		<filter-class>com.ibm.concord.viewer.filters.SessionUserFilter</filter-class>
		<init-param>
			<param-name>com.ibm.ws.webcontainer.async-supported</param-name>
			<param-value>true</param-value>
		</init-param>
	</filter>
	<filter>
		<description>
		</description>
		<display-name>FormAuthenticationFilter</display-name>
		<filter-name>FormAuthenticationFilter</filter-name>
		<filter-class>com.ibm.concord.viewer.filters.FormAuthenticationFilter</filter-class>
	</filter>
	<filter>
		<display-name>CacheControlFilter</display-name>
		<filter-name>CacheControlFilter</filter-name>
		<filter-class>com.ibm.concord.viewer.filters.CacheControlFilter</filter-class>
	</filter>
	<!--
		The order is determined by the order of the filter mappings below 
	 -->
    <filter-mapping>
		<filter-name>ParametersFilter</filter-name>
		<url-pattern>/driverscallback/*</url-pattern>		
	</filter-mapping>    
	<filter-mapping>
		<filter-name>ParametersFilter</filter-name>
		<url-pattern>/login</url-pattern>
	</filter-mapping>	 
	<filter-mapping>
		<filter-name>SessionUserFilter</filter-name>
		<url-pattern>/app/*</url-pattern>
	</filter-mapping>
	<filter-mapping>
		<filter-name>SessionUserFilter</filter-name>
		<url-pattern>/api/*</url-pattern>
	</filter-mapping>
	<filter-mapping>
		<filter-name>SessionUserFilter</filter-name>
		<url-pattern>/upload</url-pattern>
	</filter-mapping>
	<filter-mapping>
		<filter-name>SessionUserFilter</filter-name>
		<url-pattern>/thumbnail</url-pattern>
	</filter-mapping>
	<filter-mapping>
		<filter-name>FormAuthenticationFilter</filter-name>
		<url-pattern>/j_security_check</url-pattern>
	</filter-mapping>
	<filter-mapping>
		<filter-name>CacheControlFilter</filter-name>
		<url-pattern>/*</url-pattern>
	</filter-mapping>
    <filter-mapping>
		<filter-name>SessionUserFilter</filter-name>
		<url-pattern>/driverscallback/*</url-pattern>
	</filter-mapping>
	
	<servlet>
		<servlet-name>ViewDocServlet</servlet-name>
		<servlet-class>com.ibm.concord.viewer.services.servlet.ViewDocServlet</servlet-class>
	</servlet>
	<servlet>
		<servlet-name>NewsEventServlet</servlet-name>
		<servlet-class>com.ibm.concord.viewer.services.servlet.NewsEventServlet</servlet-class>
	</servlet>
	<servlet>
		<servlet-name>viewpage</servlet-name>
		<jsp-file>/jsp/viewpage.jsp</jsp-file>
	</servlet>
	<servlet>
		<servlet-name>ErrorPage</servlet-name>
		<jsp-file>/WEB-INF/pages/error.jsp</jsp-file>
	</servlet>
	<servlet>
		<servlet-name>api</servlet-name>
		<servlet-class>com.ibm.concord.viewer.services.rest.Service</servlet-class>
	</servlet>
	<servlet>
		<description>
		</description>
		<display-name>FormLoginServlet</display-name>
		<servlet-name>FormLoginServlet</servlet-name>
		<servlet-class>
		com.ibm.concord.viewer.servlets.FormLoginServlet</servlet-class>
	</servlet>
	<servlet>
		<servlet-name>VersionCheckServlet</servlet-name>
		<servlet-class>com.ibm.concord.viewer.services.servlet.VersionCheckServlet</servlet-class>
	</servlet>
	<servlet>
		<description>
		</description>
		<display-name>DriverEndpointCallback</display-name>
		<servlet-name>DriverEndpointCallback</servlet-name>
		<servlet-class>com.ibm.concord.viewer.servlets.DriverEndpointCallback</servlet-class>
	</servlet>

	<servlet-mapping>
		<servlet-name>viewpage</servlet-name>
		<url-pattern>/viewpage/*</url-pattern>
	</servlet-mapping>
	<servlet-mapping>
		<servlet-name>ViewDocServlet</servlet-name>
		<url-pattern>/app/*</url-pattern>	
	</servlet-mapping>
	<servlet-mapping>
		<servlet-name>NewsEventServlet</servlet-name>
		<url-pattern>/upload</url-pattern>	
	</servlet-mapping>	
	<servlet-mapping>
		<servlet-name>api</servlet-name>
		<url-pattern>/api/*</url-pattern>
	</servlet-mapping>
	<servlet-mapping>
		<servlet-name>ErrorPage</servlet-name>
		<url-pattern>/error</url-pattern>
	</servlet-mapping>
	<servlet-mapping>
		<servlet-name>FormLoginServlet</servlet-name>
		<url-pattern>/login</url-pattern>
	</servlet-mapping>
	<servlet-mapping>
		<servlet-name>VersionCheckServlet</servlet-name>
		<url-pattern>/version</url-pattern>
	</servlet-mapping>
	<servlet-mapping>
		<servlet-name>DriverEndpointCallback</servlet-name>
		<url-pattern>/driverscallback</url-pattern>
	</servlet-mapping>	
	
	<login-config>
		<auth-method>FORM</auth-method>
		<form-login-config>
			<form-login-page>/login</form-login-page>
			<form-error-page>/login?error=true</form-error-page>
		</form-login-config>
	</login-config>
	<resource-ref id="ResourceRef_jms_ViewerPublish">
		<res-ref-name>jms/ViewerPublish</res-ref-name>
		<res-type>javax.jms.TopicConnectionFactory</res-type>
		<res-auth>Container</res-auth>
		<res-sharing-scope>Shareable</res-sharing-scope>
	</resource-ref>
	<resource-ref id="ResourceRef_jms_ViewerJournalTopic">
		<res-ref-name>jms/ViewerJournalTopic</res-ref-name>
		<res-type>javax.jms.Topic</res-type>
		<res-auth>Container</res-auth>
		<res-sharing-scope>Shareable</res-sharing-scope>
	</resource-ref>	
	<resource-ref id="ResourceRef_com_ibm_concord_viewer_workmanager">
		<description>
		</description>
		<res-ref-name>com/ibm/concord/viewer/workmanager</res-ref-name>
		<res-type>com.ibm.websphere.asynchbeans.WorkManager</res-type>
		<res-auth>Container</res-auth>
		<res-sharing-scope>Shareable</res-sharing-scope>
	</resource-ref>
	<resource-ref id="ResourceRef_com_ibm_concord_viewer_convertingupload_workmanager">
		<description>
		</description>
		<res-ref-name>com/ibm/concord/viewer/upload/convert/workmanager</res-ref-name>
		<res-type>com.ibm.websphere.asynchbeans.WorkManager</res-type>
		<res-auth>Container</res-auth>
		<res-sharing-scope>Shareable</res-sharing-scope>
	</resource-ref>
	<resource-ref id="ResourceRef_com_ibm_concord_viewer_timermanager">
		<description>
		</description>
		<res-ref-name>com/ibm/concord/viewer/timermanager</res-ref-name>
		<res-type>commonj.timers.TimerManager</res-type>
		<res-auth>Container</res-auth>
		<res-sharing-scope>Unshareable</res-sharing-scope>
	</resource-ref>

	<filter-mapping>
		<filter-name>SessionUserFilter</filter-name>
		<url-pattern>/ut/*</url-pattern>
	</filter-mapping>
	<servlet>
		<servlet-name>ut</servlet-name>
		<servlet-class>com.ibm.concord.test.ConcordTestServlet</servlet-class>
	</servlet>
	<servlet>
		<description>
		</description>
		<display-name>ThumbnailsMoveServlet</display-name>
		<servlet-name>ThumbnailsMoveServlet</servlet-name>
		<servlet-class>com.ibm.concord.viewer.services.servlet.ThumbnailsMoveServlet</servlet-class>
	</servlet>
	<servlet-mapping>
		<servlet-name>ut</servlet-name>
		<url-pattern>/ut/*</url-pattern>
	</servlet-mapping>
	<servlet-mapping>
		<servlet-name>ThumbnailsMoveServlet</servlet-name>
		<url-pattern>/thumbnail</url-pattern>
	</servlet-mapping>
	
	<error-page>
	<error-code>404</error-code>
	<location>/WEB-INF/pages/error.jsp</location>
	</error-page>

    <security-constraint>
        <!-- Authorization setting for SSL -->
        <web-resource-collection>
            <web-resource-name>SSL</web-resource-name>
            <url-pattern>/login</url-pattern>
        </web-resource-collection>
        <user-data-constraint>
            <transport-guarantee>CONFIDENTIAL</transport-guarantee>
        </user-data-constraint>
    </security-constraint> 
    	
</web-app>
